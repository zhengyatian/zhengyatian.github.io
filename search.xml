<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>1Q84ä¸­çš„å“²å­¦</title>
    <url>/2020/03/07/1Q84%20%E4%B8%AD%E7%9A%84%E5%93%B2%E5%AD%A6/</url>
    <content><![CDATA[<ul>
<li>äººè¢«èµ‹äºˆå¸Œæœ›ï¼Œä»¥æ­¤ä¸ºç‡ƒæ–™ä¸ºç›®çš„åº¦è¿‡äººç”Ÿã€‚æ²¡æœ‰å¸Œæœ›ï¼Œäººå°±æ´»ä¸ä¸‹å»ã€‚ç„¶è€Œè¿™å’ŒæŠ›ç¡¬å¸ç›¸åŒã€‚æ­£é¢å‘ä¸Šè¿˜æ˜¯åé¢å‘ä¸Šï¼Œåªæœ‰ç­‰ç¡¬å¸è½ä¸‹æ¥æ‰èƒ½çŸ¥é“ã€‚</li>
</ul>
<a id="more"></a>

<ul>
<li><p>ç¯å°ä¹‹ä¸‹æœ€é»‘æš—ã€‚</p>
</li>
<li><p>æœ‰å…‰æ˜çš„åœ°æ–¹å°±å¿…ç„¶æœ‰é˜´å½±ï¼Œæœ‰é˜´å½±çš„åœ°æ–¹å°±å¿…ç„¶æœ‰å…‰æ˜ã€‚ä¸å­˜åœ¨æ²¡æœ‰å…‰æ˜çš„é˜´å½±ï¼Œä¹Ÿä¸å­˜åœ¨æ²¡æœ‰é˜´å½±çš„å…‰æ˜ã€‚</p>
</li>
<li><p>äººå¹¶ä¸æ˜¯å¤§é™ä¸€åˆ°å°±æº˜ç„¶é•¿é€çš„ï¼Œè€Œæ˜¯å…ˆä»å†…éƒ¨ç¼“ç¼“åœ°æ­»å»ï¼Œæœ€ç»ˆè¿æ¥æœ€åç»“ç®—çš„æ—¥å­ã€‚è°éƒ½é€ƒè„±ä¸äº†ã€‚äººå¿…é¡»ä¸ºæ”¶ä¸‹çš„ä¸œè¥¿æ”¯ä»˜ä»£ä»·ã€‚</p>
</li>
</ul>
]]></content>
      <tags>
        <tag>7788</tag>
      </tags>
  </entry>
  <entry>
    <title>DeviceCheck</title>
    <url>/2020/06/05/DeviceCheck/</url>
    <content><![CDATA[<p><img src="/2020/06/05/DeviceCheck/1.png" alt></p>
<p>æœ€è¿‘æ‰æ³¨æ„ iOS 11.0 ä¸­ä¸€ä¸ªæ–°å¢çš„å°æ¡†æ¶ï¼Œäºæ˜¯ç®€å•å­¦ä¹ äº†ä¸€ä¸‹ï¼Œå·²ç»æœ‰å‰è¾ˆå†™çš„å¾ˆè¯¦ç»†äº†ï¼Œæ‰€ä»¥~~<a href="https://www.sunyazhou.com/2017/09/30/20170930DeviceCheck/" target="_blank" rel="noopener">å‚è€ƒè‡ª</a></p>
<a id="more"></a>

<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>iOS11 è‹¹æœæ”¹åŠ¨äº†ä¸€ä¸ªæ¯”è¾ƒå¼•å¼€å‘è€…å…³æ³¨çš„äº®ç‚¹</p>
<p><strong>UDIDä¹‹ç±»çš„å†™åˆ°ç³»ç»Ÿ keychain çš„å”¯ä¸€æ ‡è¯†ä¼šéšç€ app åˆ é™¤è€Œåˆ é™¤</strong></p>
<p>è¿™ä¸ªé—®é¢˜åœ¨å¾®åšä¸Šå·²ç»äº‰è®ºå¥½å‡ å¤©ï¼šiOS11æ–°çš„è®¾å¤‡å”¯ä¸€æ ‡è¯† DCDevice</p>
<h4 id="ä»‹ç»-API"><a href="#ä»‹ç»-API" class="headerlink" title="ä»‹ç» API"></a>ä»‹ç» API</h4><p>æˆ‘ä»¬é¦–å…ˆçœ‹çœ‹<code>DCDevice</code>ç±»éƒ½æœ‰å•¥</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;DeviceCheck/DeviceCheck.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_BEGIN</span></span><br><span class="line"></span><br><span class="line">API_AVAILABLE(ios(<span class="number">11.0</span>), tvos(<span class="number">11.0</span>)) API_UNAVAILABLE(watchos, macos)</span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">DCDevice</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">// The current device. </span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">class</span>, <span class="keyword">readonly</span>) DCDevice *currentDevice;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Check if this API is supported on the current device.</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">getter</span>=isSupported, <span class="keyword">readonly</span>) <span class="built_in">BOOL</span> supported;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Generate a new device token that can be used to get/set the persistent bits for this device.This call generates a new value every time.</span></span><br><span class="line">- (<span class="keyword">void</span>)generateTokenWithCompletionHandler:(<span class="keyword">void</span>(^)(<span class="built_in">NSData</span> * _Nullable token, <span class="built_in">NSError</span> * _Nullable error))completion;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">NS_ASSUME_NONNULL_END</span></span><br></pre></td></tr></table></figure>

<p>æ¥å£ç®€ç›´ä¸èƒ½å†ç®€å•äº† <strong>åˆ›å»ºå®ä¾‹è°ƒæ–¹æ³•</strong></p>
<h4 id="ä½¿ç”¨-API"><a href="#ä½¿ç”¨-API" class="headerlink" title="ä½¿ç”¨ API"></a>ä½¿ç”¨ API</h4><p>ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•ä½¿ç”¨<code>DCDevice</code></p>
<p>å¯¼å…¥å¤´æ–‡ä»¶</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;DeviceCheck/DeviceCheck.h&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>check æ˜¯å¦æ”¯æŒ å¦‚æœæ”¯æŒ çš„è¯ä¼šåœ¨å›è°ƒä»¥åè¿”å› <code>token</code>(NSData)</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    <span class="comment">// Do any additional setup after loading the view.</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ([DCDevice.currentDevice isSupported]) &#123;</span><br><span class="line">        [DCDevice.currentDevice generateTokenWithCompletionHandler:^(<span class="built_in">NSData</span> * _Nullable token, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">            <span class="keyword">if</span> (error) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, error.description);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// upload token to APP server</span></span><br><span class="line">                <span class="built_in">NSString</span> *deviceToken = [token base64EncodedStringWithOptions:<span class="built_in">NSDataBase64EncodingEndLineWithLineFeed</span>];</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"%lu %@"</span>, token.length, deviceToken);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>token æ˜¯ä¸ª 2188å­—èŠ‚(2k å¤šç‚¹)çš„äºŒè¿›åˆ¶æµ,å¾ˆå°</p>
<h4 id="åˆ é™¤-é‡è£…App-å¦‚ä½•å¤„ç†"><a href="#åˆ é™¤-é‡è£…App-å¦‚ä½•å¤„ç†" class="headerlink" title="åˆ é™¤/é‡è£…App å¦‚ä½•å¤„ç†"></a>åˆ é™¤/é‡è£…App å¦‚ä½•å¤„ç†</h4><blockquote>
<p>DeviceCheck å…è®¸ä½ é€šè¿‡ä½ çš„æœåŠ¡å™¨ä¸ Apple æœåŠ¡å™¨é€šè®¯ï¼Œå¹¶ä¸ºå•ä¸ªè®¾å¤‡è®¾ç½®2kå·¦å³ çš„æ•°æ®ã€‚ åœ¨è®¾å¤‡ä¸Šç”¨ DeviceCheck API ç”Ÿæˆä¸€ä¸ª 2å­—èŠ‚çš„ token (00, 01,10,11)ï¼Œç„¶åå°†è¿™ä¸ª token å‘ç»™è‡ªå·±çš„æœåŠ¡å™¨ï¼Œå†ç”±è‡ªå·±çš„æœåŠ¡å™¨ä¸ Apple çš„ API è¿›è¡Œé€šè®¯ï¼Œæ¥æ›´æ–°æˆ–è€…æŸ¥è¯¢è¯¥è®¾å¤‡çš„å€¼ã€‚è¿™ä¸¤å­—èŠ‚ çš„æ•°æ®ç”¨æ¥è¿½è¸ªç”¨æˆ·ã€‚æ¯”å¦‚ã€‚å€ŸåŠ©ä¸¤ä¸ªè‡ªå·±çš„æ•°æ®ï¼Œä½ å¯ä»¥å¾—çŸ¥ç”¨æˆ·ç©¶ç«Ÿä½¿ç”¨äº†è¯¥ App å¤šä¹…ã€‚ è¯¥ API å¯ä»¥æˆä¸ºï¼šåæ¬ºè¯ˆé¢†åŸŸï¼š è¯•ç”¨7å¤© Uberã€æ»´æ»´å¸æœºè¢«å°å·åï¼Œé˜²æ­¢é‡æ–°æ³¨å†Œè´¦å·æ¥å• è¯¥ç”¨æˆ·æ˜¯å¦å·²ç»é¢†å–è¿‡é¦–æ¬¡æ³¨å†Œçº¢åŒ… APPé˜²å¤šå¼€ å› ä¸ºä¼ è¾“çš„æ˜¯ flag çº§åˆ«çš„æ•°æ®ï¼Œå¹¶ä¸ä¼šå®šä½åˆ°è¯¥è®¾å¤‡çš„ä½¿ç”¨è€…ï¼Œæ‰€ä»¥ç›¸å¯¹å®‰å…¨ã€‚</p>
</blockquote>
<blockquote>
<p>ä½†æ˜¯å¯¹äºè´­ä¹°äº†äºŒæ‰‹æ‰‹æœºçš„ä½¿ç”¨åœºæ™¯ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸€äº›è¾¹ç•Œæƒ…å†µï¼Œè¿™ä¸ªåœ¨ä¸šåŠ¡ä¸­ä¹Ÿéœ€è¦è€ƒè™‘è¿›å»ã€‚</p>
</blockquote>
<p>å¼•è‡ª<a href="https://github.com/ChenYilong/iOS11AdaptationTips/issues/22" target="_blank" rel="noopener">iOS11å¼€å‘æ–°ç‰¹æ€§ä¹‹å®ç”¨å°tips</a></p>
<p>é¦–å…ˆè¦æ˜ç™½æˆ‘ä»¬ çš„ token éœ€è¦å‘ç»™è°</p>
<ol>
<li>token éœ€è¦å‘é€ç»™æˆ‘ä»¬è‡ªå·±å…¬å¸çš„<code>server</code>åšè®°å½•</li>
<li>æˆ‘ä»¬å…¬å¸è‡ªå·±çš„<code>server</code>å»<code>Apple</code>çš„<code>server</code>æŸ¥è¯¢<code>token</code>æ˜¯å¦æœ‰æ•ˆ,ä»è€Œæ¥æ›´æ–°æˆ–è€…æŸ¥è¯¢è¯¥è®¾å¤‡å€¼.</li>
<li>è¿™<code>2k å·¦å³çš„ token</code>ä¸ä¼šå› ä¸ºè®¾å¤‡åˆ é™¤ app è€Œåˆ é™¤ ä¼šä¸€ç›´å­˜åœ¨è‹¹æœçš„ server(å…¶å®æˆ‘è§‰å¾—å°±æ˜¯è‹¹æœè‡ªå·±å»è·å–çš„è®¾å¤‡å”¯ä¸€æ ‡è¯†).</li>
</ol>
<p>é‚£ä¹ˆ æ€ä¹ˆæŸ¥è¯¢å’Œæ›´æ–°å‘¢</p>
<h5 id="æŸ¥è¯¢æ¥å£"><a href="#æŸ¥è¯¢æ¥å£" class="headerlink" title="æŸ¥è¯¢æ¥å£"></a>æŸ¥è¯¢æ¥å£</h5><p><strong><a href="https://api.development.devicecheck.apple.com/v1/query_two_bits" target="_blank" rel="noopener">https://api.development.devicecheck.apple.com/v1/query_two_bits</a></strong></p>
<p>å¯ä»¥ç”¨ç»ˆç«¯è‡ªå·±æ¨¡æ‹Ÿä¸€ä¸‹ å°±å½“ä½œä½ è‡ªå·±æ˜¯è‡ªå·±çš„æœåŠ¡å™¨è®¿é—®Apple çš„æœåŠ¡å™¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -i --verbose -H <span class="string">"Authorization: Bearer &lt;GeneratedJWT&gt;"</span> \</span><br><span class="line">-X POST --data-binary @ValidQueryRequest.json \ </span><br><span class="line">https://api.development.devicecheck.apple.com/v1/query_two_bits</span><br></pre></td></tr></table></figure>

<p>json çš„å®šä¹‰å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th align="center">å­—æ®µ key</th>
<th align="center">ç±»å‹</th>
<th align="center">è¯´æ˜</th>
<th align="center">å¿…é¡»</th>
</tr>
</thead>
<tbody><tr>
<td align="center">device_token</td>
<td align="center">String</td>
<td align="center">è®¾å¤‡å”¯ä¸€æ ‡è¯† token</td>
<td align="center">æ˜¯</td>
</tr>
<tr>
<td align="center">transaction_id</td>
<td align="center">String</td>
<td align="center">æœåŠ¡å™¨äº§ç”Ÿçš„ä¸€ä¸ªID</td>
<td align="center">æ˜¯</td>
</tr>
<tr>
<td align="center">timestamp</td>
<td align="center">Long</td>
<td align="center">æœåŠ¡å™¨ç”Ÿæˆçš„UTCæ—¶é—´æˆ³</td>
<td align="center">æ˜¯</td>
</tr>
</tbody></table>
<p>å®ƒä¼š è¿”å› å¦‚ä¸‹æ ¼å¼</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"device_token"</span> : <span class="string">"wlkCDA2Hy/CfrMqVAShs1BAR/0sAiuRIUm5jQg0a..."</span>,</span><br><span class="line">   <span class="attr">"transaction_id"</span> : <span class="string">"5b737ca6-a4c7-488e-b928-8452960c4be9"</span>,</span><br><span class="line">   <span class="attr">"timestamp"</span> : <span class="number">1487716472000</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="æ›´æ–°æ¥å£"><a href="#æ›´æ–°æ¥å£" class="headerlink" title="æ›´æ–°æ¥å£"></a>æ›´æ–°æ¥å£</h5><p><strong><a href="https://api.development.devicecheck.apple.com/v1/update_two_bits" target="_blank" rel="noopener">https://api.development.devicecheck.apple.com/v1/update_two_bits</a></strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -i --verbose -H <span class="string">"Authorization: Bearer &lt;GeneratedJWT&gt;"</span> \</span><br><span class="line">-X POST --data-binary @ValidUpdateRequest.json \</span><br><span class="line">https://api.development.devicecheck.apple.com/v1/update_two_bits</span><br></pre></td></tr></table></figure>

<p>json çš„å®šä¹‰å¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th align="center">å­—æ®µ key</th>
<th align="center">ç±»å‹</th>
<th align="center">è¯´æ˜</th>
<th align="center">å¿…é¡»</th>
</tr>
</thead>
<tbody><tr>
<td align="center">device_token</td>
<td align="center">String</td>
<td align="center">è®¾å¤‡å”¯ä¸€æ ‡è¯† token</td>
<td align="center">æ˜¯</td>
</tr>
<tr>
<td align="center">transaction_id</td>
<td align="center">String</td>
<td align="center">æœåŠ¡å™¨äº§ç”Ÿçš„ä¸€ä¸ªID</td>
<td align="center">æ˜¯</td>
</tr>
<tr>
<td align="center">timestamp</td>
<td align="center">Long</td>
<td align="center">æœåŠ¡å™¨ç”Ÿæˆçš„UTCæ—¶é—´æˆ³</td>
<td align="center">æ˜¯</td>
</tr>
<tr>
<td align="center">bit0</td>
<td align="center">Boolean</td>
<td align="center">æ–°çš„å¸ƒå°”å€¼1</td>
<td align="center">å¦</td>
</tr>
<tr>
<td align="center">bit1</td>
<td align="center">Boolean</td>
<td align="center">æ–°çš„å¸ƒå°”å€¼2</td>
<td align="center">å¦</td>
</tr>
</tbody></table>
<p>json çš„ç¤ºä¾‹:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">"device_token"</span> : <span class="string">"wlkCDA2Hy/CfrMqVAShs1BAR/0sAiuRIUm5jQg0a..."</span>,</span><br><span class="line">   <span class="attr">"transaction_id"</span> : <span class="string">"5b737ca6-a4c7-488e-b928-8452960c4be9"</span>,</span><br><span class="line">   <span class="attr">"timestamp"</span> : <span class="number">1487716472000</span>,</span><br><span class="line">   <span class="attr">"bit0"</span> : <span class="literal">true</span>,</span><br><span class="line">   <span class="attr">"bit1"</span> : <span class="literal">false</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æœ€ç»ˆçš„æ–¹æ¡ˆ"><a href="#æœ€ç»ˆçš„æ–¹æ¡ˆ" class="headerlink" title="æœ€ç»ˆçš„æ–¹æ¡ˆ"></a>æœ€ç»ˆçš„æ–¹æ¡ˆ</h3><ol>
<li>iOS11ä»¥å‰ç‰ˆæœ¬æš‚ä¸”æ‰ç”¨ UUID ç­‰ keychian æ–¹å¼</li>
<li>iOS11å°½é‡æ‰ç”¨æ–°çš„ api æ¥é€‚é…è§£å†³</li>
</ol>
<p>å¯¹äº server æ¥è®²å¯ä»¥ æŠŠ token ææˆæ–°çš„é™„å±å­—æ®µ æ¯”å¦‚ä¸€ä¸ªè´¦å·ä¸‹ç™»å½•å¤šå°‘ä¸ªè®¾å¤‡</p>
<p>é‚£ä¹ˆ ä¸€ä¸ª UID ä¸‹é¢ å°±è¦é™„å± iOS ç‰ˆæœ¬+ token</p>
]]></content>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo + GitHub Pages 404</title>
    <url>/2017/10/02/GitHub%20Pages%20404/</url>
    <content><![CDATA[<p>å¦‚ä½•é…ç½®GitHub Pagesç½‘ä¸Šèµ„æ–™å¾ˆå¤šï¼Œè¿™é‡Œå°±ä¸å¤šè¯´äº†ï¼Œæˆ‘ä»¬è¡¥å……ä¸€ä¸ªé—®é¢˜çš„è§£å†³æ–¹å¼ã€‚å¾ˆå¤šäººéƒ½å‡ºä¼šå‡ºç°ï¼ŒHexoé¡¹ç›®ä¼ åˆ° GitHub çš„ä»“åº“åï¼Œè®¿é—® <code>username.github.io</code> åŸŸåï¼Œç»“æœæ˜¯404</p>
<p>æˆ‘æœé›†åˆ°çš„è§£å†³åŠæ³•å¤§æ¦‚æœ‰ä¸‰ä¸ªï¼Œå¸Œæœ›èƒ½å¸®åˆ°ä½ ï¼š</p>
<p>â€‹        <a id="more"></a></p>
<h4 id="1ã€Git-ä»“åº“çš„ä»“åº“åå’Œ-GitHub-Pages-çš„åŸŸåï¼ŒæŒ‰ç…§GitHubçš„è¦æ±‚ï¼Œé…ç½®æˆï¼š"><a href="#1ã€Git-ä»“åº“çš„ä»“åº“åå’Œ-GitHub-Pages-çš„åŸŸåï¼ŒæŒ‰ç…§GitHubçš„è¦æ±‚ï¼Œé…ç½®æˆï¼š" class="headerlink" title="1ã€Git ä»“åº“çš„ä»“åº“åå’Œ GitHub Pages çš„åŸŸåï¼ŒæŒ‰ç…§GitHubçš„è¦æ±‚ï¼Œé…ç½®æˆï¼š"></a>1ã€Git ä»“åº“çš„ä»“åº“åå’Œ GitHub Pages çš„åŸŸåï¼ŒæŒ‰ç…§GitHubçš„è¦æ±‚ï¼Œé…ç½®æˆï¼š</h4><p>&lt;githubè´¦å·å&gt;.github.io</p>
<p>åƒæˆ‘å°±æ˜¯ atang1011.github.io</p>
<h4 id="2ã€æ£€æŸ¥-Hexo-ç«™ç‚¹çš„é…ç½®æ–‡ä»¶-condig-yml-ä¸­å…³äº-Git-çš„è®¾ç½®æ˜¯å¦æœ‰é—®é¢˜"><a href="#2ã€æ£€æŸ¥-Hexo-ç«™ç‚¹çš„é…ç½®æ–‡ä»¶-condig-yml-ä¸­å…³äº-Git-çš„è®¾ç½®æ˜¯å¦æœ‰é—®é¢˜" class="headerlink" title="2ã€æ£€æŸ¥ Hexo ç«™ç‚¹çš„é…ç½®æ–‡ä»¶ _condig.yml ä¸­å…³äº Git çš„è®¾ç½®æ˜¯å¦æœ‰é—®é¢˜"></a>2ã€æ£€æŸ¥ Hexo ç«™ç‚¹çš„é…ç½®æ–‡ä»¶ _condig.yml ä¸­å…³äº Git çš„è®¾ç½®æ˜¯å¦æœ‰é—®é¢˜</h4><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:ATang1011/atang1011.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸‹ repo å’Œ branch æ˜¯å¦å†™é”™äº†ï¼Œå¦‚æœä½ æ˜¯ä»ç½‘ä¸Šå¤åˆ¶çš„è¿™ä¸€ç«¯é…ç½®ï¼Œé¡ºä¾¿æ£€æŸ¥ä¸€ä¸‹yml æ ¼å¼æ˜¯ä¸æ˜¯é”™äº†ï¼Œå¤šäº†ä¸€ä¸ªç©ºæ ¼ä¹‹ç±»çš„å‘€ï¼Œå“ˆå“ˆå“ˆã€‚</p>
<h4 id="3ã€ç¼ºå°‘-index-html-æ–‡ä»¶ï¼Œæˆ–è€…è¯´â€é¦–é¡µæ²¡äº†â€ï¼Œè¿™ä¸ªæ˜¯æˆ‘å½“æ—¶é‡åˆ°çš„é—®é¢˜"><a href="#3ã€ç¼ºå°‘-index-html-æ–‡ä»¶ï¼Œæˆ–è€…è¯´â€é¦–é¡µæ²¡äº†â€ï¼Œè¿™ä¸ªæ˜¯æˆ‘å½“æ—¶é‡åˆ°çš„é—®é¢˜" class="headerlink" title="3ã€ç¼ºå°‘ index.html æ–‡ä»¶ï¼Œæˆ–è€…è¯´â€é¦–é¡µæ²¡äº†â€ï¼Œè¿™ä¸ªæ˜¯æˆ‘å½“æ—¶é‡åˆ°çš„é—®é¢˜"></a>3ã€ç¼ºå°‘ index.html æ–‡ä»¶ï¼Œæˆ–è€…è¯´â€é¦–é¡µæ²¡äº†â€ï¼Œè¿™ä¸ªæ˜¯æˆ‘å½“æ—¶é‡åˆ°çš„é—®é¢˜</h4><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="comment">#åœ¨ç«™ç‚¹ç›®å½•ä¸‹ï¼ŒGit Bash ä¸­ æ‰§è¡Œ</span></span><br><span class="line">npm install hexo-generator-index --save</span><br></pre></td></tr></table></figure>

<p>ä¹‹åå°±ç”Ÿæˆ index.html æ–‡ä»¶äº†ï¼Œç„¶åé‡æ–°æ‰§è¡Œä¸Šä¼  <code>hexo clean</code> <code>hexo g -d</code> è¯•è¯•ï¼Œåæ­£æˆ‘çš„æ˜¯å¯ä»¥äº†ã€‚æˆ‘æ˜¯åšç§»åŠ¨ç«¯å¼€å‘çš„ï¼Œwebå‰ç«¯ç€å®æœ‰ç‚¹è¿·â€¦â€¦ä¹Ÿéƒ½æ˜¯ä¸œæ‹¼è¥¿å‡‘çš„èµ„æ–™ã€‚</p>
<p>éœ€è¦è”ç³»çš„ï¼Œå» â€œå…³äº(About)â€ ä¸­æ‰¾åˆ°æˆ‘å§ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>Hexo æ–‡å­—ä¸­å¦‚ä½•æ’å…¥å›¾ç‰‡</title>
    <url>/2018/02/22/Hexo%E6%96%87%E5%AD%97%E4%B8%AD%E5%A6%82%E4%BD%95%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87/</url>
    <content><![CDATA[<p>åœ¨Hexo çš„æ–‡ç« ä¸­åŠ å…¥å›¾ç‰‡ï¼Œå¾ˆç®€å•çš„ï¼Œæ¥è¯•è¯•å…ˆï¼š</p>
<a id="more"></a>

<ul>
<li><p><strong>è®¾ç½®ç«™ç‚¹é…ç½®_config.yml</strong>:</p>
<p>å°† <code>post_asset_folder: false</code> æ”¹ä¸º <code>post_asset_folder: true</code></p>
</li>
<li><p><strong>å®‰è£…æ’ä»¶</strong>:</p>
<p> <code>npm install https://github.com/CodeFalling/hexo-asset-image -- save</code></p>
</li>
<li><p><strong>è¿è¡Œ</strong>:</p>
<p> <code>hexo n &quot;XXXXXX&quot;</code></p>
<p>ç”Ÿæˆ XXXXX.md åšæ–‡æ—¶å°±ä¼šåœ¨ <code>/source/_posts</code> ç›®å½•ä¸‹ç”Ÿæˆ XXXXXX çš„æ–‡ä»¶å¤¹ï¼Œå°†ä½ æƒ³åœ¨XXXXXæ–‡ç« ä¸­æ’å…¥çš„ç…§ç‰‡æ”¾ç½®åˆ°è¿™ä¸ªåŒåæ–‡ä»¶å¤¹ä¸­å³å¯ï¼Œå›¾ç‰‡çš„å‘½åéšæ„ã€‚</p>
</li>
<li><p><strong>æ·»åŠ å›¾ç‰‡</strong>:</p>
<p>åœ¨æƒ³æ·»åŠ çš„ä½ç½®å†™å…¥<code>![](å›¾ç‰‡åå­—.å›¾ç‰‡æ ¼å¼)</code>ï¼Œä¾‹å¦‚<code>![](1.png)</code></p>
</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>Mac ä¸‹ IDEA æ— æ³•å¯åŠ¨çš„é—®é¢˜</title>
    <url>/2019/01/24/Mac%E4%B8%8BIDEA%E6%97%A0%E6%B3%95%E5%90%AF%E5%8A%A8%E7%9A%84%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<p>è¦ä½¿ç”¨IDEAï¼Œçªç„¶æç¤ºæ‰“ä¸å¼€ï¼Œä¸è¦æ…Œï¼Œé—®é¢˜ä¸å¤§ï¼ŒæŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤è¯•è¯•å…ˆï¼Ÿ</p>
<blockquote>
<p>æ‰“å¼€finder-&gt;åº”ç”¨ç¨‹åº-&gt;idea.app-&gt;å³é”®-&gt;æ˜¾ç¤ºåŒ…å†…å®¹-&gt;ç„¶åMaxOS-&gt;åŒå‡»shellè„šæœ¬ï¼ˆideaï¼‰</p>
</blockquote>
<a id="more"></a>

<p>è¿™æ ·æ˜¯é€šè¿‡å‘½ä»¤è¡Œçš„æ–¹å¼æ¥å¯åŠ¨IDEAã€‚<br>ä»”ç»†çœ‹é‡Œé¢çš„æç¤ºï¼Œå°¤å…¶Errorå¼€å¤´çš„ä¿¡æ¯ï¼Œåº”è¯¥ä¼šæœ‰å…·ä½“åŸå› ã€‚</p>
<p>æˆ‘çš„IDEA ä½¿ç”¨çš„â€œç ´è§£ç‰ˆâ€â€¦â€¦you knowï¼Ÿ ç„¶å<code>JetbrainsCrack-3.1-release-enc.jar</code> è¢«æˆ‘ä¸å°å¿ƒåˆ äº†ï¼Œæ”¾å›åŸä½å°±å¥½äº†â€¦â€¦</p>
]]></content>
  </entry>
  <entry>
    <title>Inferred (Constraints) å’Œ Autoresizing Mask</title>
    <url>/2021/01/07/Inferred-Constraints-%E5%92%8C-Autoresizing-Mask/</url>
    <content><![CDATA[<p>å¾ˆä¹…æ²¡æœ‰å†™è¿‡UIäº†ï¼Œå‰ä¸€é˜µæ›´æ–°å®Œ Xcode 12.2 å’Œ iOS 14.* åï¼Œè€é¡¹ç›®å’Œæ–°é¡¹ç›®éƒ½éœ€è¦è°ƒæ•´ç‚¹é¡µé¢å¸ƒå±€çš„é—®é¢˜ã€‚åœ¨ Copy æˆ–è€… æ–°å»º View åï¼Œåˆ‡æ¢ä½¿ç”¨çš„è®¾å¤‡æ—¶å¸ƒå±€æ²¡æœ‰è‡ªé€‚åº”ã€‚ä»¥ä¸ºçº¦æŸæ²¡åŠ ä¸Šï¼Œä½†å½“æˆ‘è¦å»åŠ çº¦æŸçš„æ—¶å€™ï¼Œå‘ç°å·²ç»æ— æ³•æ“ä½œäº†ï¼Ÿï¼ï¼ï¼</p>
<h5 id="ä¹Œé¾™"><a href="#ä¹Œé¾™" class="headerlink" title="ä¹Œé¾™"></a>ä¹Œé¾™</h5><p>å¯ç”¨ä¸ä¸å¯ç”¨ï¼š</p>
<p>â€‹        <a id="more"></a></p>
<center>
    <div style="display:inline-block;"><img src="/2021/01/07/Inferred-Constraints-%E5%92%8C-Autoresizing-Mask/2.png" class width="300"></div>
    <div style="display:inline-block;margin-left:10px;"><img src="/2021/01/07/Inferred-Constraints-%E5%92%8C-Autoresizing-Mask/1.png" class width="300"></div>
</center>

<p>å“æ­»æˆ‘äº†ï¼ŒCV å¤§æ³•å±…ç„¶éƒ½ä¸å¥½ä½¿äº†ï¼Ÿï¼ï¼ï¼ï¼ï¼</p>
<p>å¯¹æ¯”äº†ä¸€ä¸‹ä¸¤ä¸ª View çš„è®¾ç½®ä»¥åï¼Œå‘ç°æ˜¯ Layout é€‰é¡¹ä¸åŒçš„åŸå› ï¼Œ<code>Inferred (Constraints)</code> å’Œ <code>Autoresizing Mask</code> ã€‚</p>
<center>
    <div style="display:inline-block;"><img src="/2021/01/07/Inferred-Constraints-%E5%92%8C-Autoresizing-Mask/3.png" class width="300"></div>
    <div style="display:inline-block;margin-left:10px;"><img src="/2021/01/07/Inferred-Constraints-%E5%92%8C-Autoresizing-Mask/4.png" class width="300"></div>
</center>

<p>æ–°é¡µé¢è‡ªåŠ¨ä½¿ç”¨ <code>Autoresizing Mask</code> ï¼Œä¸æ¸…æ¥šæ˜¯ä¸æ˜¯ Xcode 12.* çš„bugï¼Œæˆ‘è®°å¾— <code>Autoresizing Mask</code>  æ—©äº›æ—¶å€™å°±ä¸æ€ä¹ˆç”¨äº†ï¼Œå±…ç„¶åˆå‡ºæ¥äº†ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚</p>
<h5 id="PS-æœ‰å…´è¶£å¯ä»¥çœ‹çœ‹è¿™ä¸¤ä¸ªè®¨è®º"><a href="#PS-æœ‰å…´è¶£å¯ä»¥çœ‹çœ‹è¿™ä¸¤ä¸ªè®¨è®º" class="headerlink" title="PS: æœ‰å…´è¶£å¯ä»¥çœ‹çœ‹è¿™ä¸¤ä¸ªè®¨è®º"></a>PS: æœ‰å…´è¶£å¯ä»¥çœ‹çœ‹è¿™ä¸¤ä¸ªè®¨è®º</h5><p><a href="https://developer.apple.com/forums/thread/669586" target="_blank" rel="noopener">Constraint Layout No Longer Available</a></p>
<p><a href="https://dev.classmethod.jp/articles/new-auto-layout-feature/" target="_blank" rel="noopener">[iOS 10] Auto Layout ã®æ–°æ©Ÿèƒ½ã«ã¤ã„ã¦</a></p>
<h5 id="PPS-Hexo-é‡Œå›¾ç‰‡å¹¶æ’åŸæ¥å¯ä»¥è¿™æ ·å†™â€¦â€¦"><a href="#PPS-Hexo-é‡Œå›¾ç‰‡å¹¶æ’åŸæ¥å¯ä»¥è¿™æ ·å†™â€¦â€¦" class="headerlink" title="PPS:  Hexo é‡Œå›¾ç‰‡å¹¶æ’åŸæ¥å¯ä»¥è¿™æ ·å†™â€¦â€¦"></a>PPS:  Hexo é‡Œå›¾ç‰‡å¹¶æ’åŸæ¥å¯ä»¥è¿™æ ·å†™â€¦â€¦</h5><p><a href="https://blog.ahao.moe/posts/Hexo_multiple_images_side_by_side.html" target="_blank" rel="noopener">å‚è€ƒè‡ª</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"display:inline-block;"</span>&gt;</span>&#123;%img /img/1.png 300%&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"display:inline-block;margin-left:10px;"</span>&gt;</span>&#123;%img /img/2.png 300%&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title>WKWebView å°ç»“å„¿</title>
    <url>/2020/12/01/WKWebView%20%E5%B0%8F%E7%BB%93%E5%84%BF/</url>
    <content><![CDATA[<p>æœ€è¿‘å¤šä¸ªé¡¹ç›®é‡Œå› ä¸ºæ‰‹æœº App ä¸­ UIWebview åŠ è½½ å‰ç«¯é¡µé¢ æ—¶çš„æ€§èƒ½é—®é¢˜ï¼Œè¢«â€å›´æ”»â€äº†ä¸¤å¤©ã€‚æœ¬æ¥è¿˜æƒ³å·ä¸ªæ‡’å„¿ï¼Œä¸å‡çº§ï¼Œæ¯•ç«Ÿ App ä¸éœ€è¦ä¸Šçº¿ AppStoreï¼Œæœ€ç»ˆè¿˜æ˜¯æ²¡é€ƒè¿‡ WKWebView æ¸²æŸ“é€Ÿåº¦çš„è¯±æƒ‘ï¼ŒçœŸé¦™<del>~</del>å•ªå•ªã€‚ã€‚</p>
<p>æ¢ä»–ä¸«çš„ï¼</p>
<p>è¯´æ¥ä¹Ÿæƒ­æ„§ï¼ŒiOS 8.0 å°±å¼€å§‹æ”¯æŒ WebKit äº†ï¼Œä¸€ç›´æ²¡æ²‰ä¸‹å¿ƒæ¥å­¦ä¹ ï¼Œæˆ‘ä»¬ä¸€èµ·å¥½å¥½çœ‹çœ‹é‡Œé¢éƒ½æœ‰ä»€ä¹ˆå§ğŸ¤“</p>
<a id="more"></a>

<h3 id="ä¸€ã€WKWebView-åˆå§‹åŒ–"><a href="#ä¸€ã€WKWebView-åˆå§‹åŒ–" class="headerlink" title="ä¸€ã€WKWebView åˆå§‹åŒ–"></a>ä¸€ã€WKWebView åˆå§‹åŒ–</h3><p>ä¸€ä¸ªç®€å•ç”¨äºå±•ç¤ºçš„ WebView å¯ä»¥æ˜¯è¿™æ ·çš„ï¼š</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">WKWebViewConfiguration</span> *configuration = [[<span class="built_in">WKWebViewConfiguration</span> alloc] init];</span><br><span class="line"><span class="built_in">WKWebView</span> *webView = (&#123;</span><br><span class="line">    webView = [[<span class="built_in">WKWebView</span> alloc] initWithFrame:<span class="keyword">self</span>.view.bounds configuration:configuration];</span><br><span class="line">    webView.scrollView.bounces = <span class="literal">NO</span>;</span><br><span class="line">    webView.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</span><br><span class="line">    webView;</span><br><span class="line">&#125;);</span><br><span class="line">    </span><br><span class="line">[<span class="keyword">self</span>.view addSubview:webView];</span><br><span class="line">[webView loadRequest:[<span class="built_in">NSURLRequest</span> requestWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://baidu.com"</span>]]];</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ä¸€ä¸ªå•çº¯ç”¨äºå±•ç¤ºç½‘é¡µã€æ²¡æœ‰ä»»ä½•é…ç½®é¡¹çš„ WebView å°±ç®—å®Œæˆäº†ã€‚ç›¸è¾ƒäº <code>UIWebView</code> ï¼Œæˆ‘ä»¬çœ‹åˆ°å¤šäº†ä¸€ä¸ª </p>
<p><code>configuration</code>é…ç½®ç±»å‹ï¼Œé‚£æˆ‘ä»¬å°±æ¥ Read the fucking source codeâ€¦â€¦</p>
<h3 id="äºŒã€WKWebViewConfiguration"><a href="#äºŒã€WKWebViewConfiguration" class="headerlink" title="äºŒã€WKWebViewConfiguration"></a>äºŒã€WKWebViewConfiguration</h3><p>å®˜æ–¹æ–‡æ¡£æ˜¯è¿™æ ·æè¿°è¿™ä¸ªç±»å‹çš„ï¼š</p>
<blockquote>
<p>A <code>WKWebViewConfiguration</code> object is a collection of properties with which to initialize a web view.</p>
<p>ä¸€ä¸ªç”¨äºåˆå§‹åŒ– web view å±æ€§çš„é›†åˆã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥ç”¨å®ƒåšä»€ä¹ˆå‘¢ï¼Ÿ</p>
<blockquote>
<ul>
<li>è®¾ç½®ç”¨äºç½‘ç«™çš„åˆå§‹cookie</li>
<li>å¤„ç†è‡ªå®šä¹‰çš„ URL schemes</li>
<li>è®¾ç½®å¦‚ä½•å¤„ç†åª’ä½“å†…å®¹</li>
<li>ç®¡ç†ç½‘é¡µä¸­é€‰ä¸­çš„ä¿¡æ¯</li>
<li>è‡ªå®šä¹‰æ³¨å…¥ç½‘é¡µçš„è„šæœ¬</li>
<li>è‡ªå®šä¹‰å†…å®¹çš„å±•ç¤ºè§„åˆ™</li>
<li>â€¦â€¦</li>
</ul>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ª <code>WKWebViewConfiguration</code> å¯¹è±¡æ¥è®¾ç½®ç½‘é¡µçš„å±æ€§ï¼Œå¹¶ä¸”åœ¨ WebView åˆå§‹åŒ–çš„æ—¶å€™ä¼ é€’ç»™å®ƒã€‚æ³¨æ„çš„æ˜¯åªèƒ½åœ¨åˆå§‹åŒ–çš„æ—¶å€™é…ç½® <code>configuration</code>  ä¸­çš„å±æ€§ï¼Œåé¢æ˜¯æ²¡åŠæ³•åŠ¨æ€å†å»ä¿®æ”¹è¿™äº›é…ç½®çš„ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡è¿™ä¸ªç±»çœ‹çœ‹ WebKit é‡Œé¢æœ‰å“ªäº›ä¸»è¦çš„å†…å®¹ï¼š</p>
<h4 id="WKProcessPool"><a href="#WKProcessPool" class="headerlink" title="WKProcessPool"></a>WKProcessPool</h4><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*! @abstract The process pool from which to obtain the view's web content</span></span><br><span class="line"><span class="comment"> process.</span></span><br><span class="line"><span class="comment"> @discussion When a web view is initialized, a new web content process</span></span><br><span class="line"><span class="comment"> will be created for it from the specified pool, or an existing process in</span></span><br><span class="line"><span class="comment"> that pool will be used.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">WKProcessPool</span> *processPool;</span><br></pre></td></tr></table></figure>

<p>å®˜æ–¹æ–‡æ¡£è§£é‡Šä¸º ä¸€ä¸ªå¯ä»¥åœ¨å•ä¸ªè¿›ç¨‹ä¸­è¿è¡Œå¤šä¸ª web è§†å›¾çš„ä¸å¯è§ token ï¼Ÿä»¤ç‰Œï¼Ÿã€‚è¿›ç¨‹æ± ã€‚</p>
<p>å¯¹äº WKï¼Œå’Œæˆ‘ä»¬çš„ App ä¸å†æ˜¯åŒä¸€ä¸ªè¿›ç¨‹ï¼Œè€Œæ˜¯å¼€è¾Ÿäº†ç‹¬ç«‹çš„è¿›ç¨‹æ¥ç®¡ç†ï¼Œæ”¾åœ¨è¿›ç¨‹æ± ä¸­ã€‚è¿™ä¹Ÿæ˜¯ä¸<code>UIWebView</code> æœ€å¤§ä¸åŒçš„ä¸€ç‚¹ï¼š<code>NSHTTPCookieStorage</code> ä¸­çš„ cookie ï¼Œ<code>UIWebView</code> æ˜¯å¯ä»¥è‡ªåŠ¨æºå¸¦ä½¿ç”¨çš„ï¼Œä½† <code>WKWebView</code> æ— æ³•è·å– Storage ä¸­çš„ cookieã€‚</p>
<p>è¯¶ï¼Œé‚£æ˜¯ä¸æ˜¯æ”¾åœ¨åŒä¸€ä¸ªè¿›ç¨‹æ± ä¸­çš„ web view å°±å¯ä»¥å…±äº« cookie äº†å‘¢ï¼Ÿå¸¦ç€è¿™ä¸ªé—®é¢˜ï¼Œç¨åæˆ‘ä»¬ä¼šæåˆ° cookie æœ‰å…³çš„å¤„ç†ã€‚</p>
<h4 id="WKPreferences"><a href="#WKPreferences" class="headerlink" title="WKPreferences"></a>WKPreferences</h4><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*! @abstract The preference settings to be used by the web view.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">WKPreferences</span> *preferences;</span><br></pre></td></tr></table></figure>

<p>é’ˆå¯¹ web è§†å›¾çš„åå¥½è®¾ç½®ï¼Œå¦‚æœæ˜¯é’ˆå¯¹ web å†…å®¹çš„è®¾ç½®è¿˜æ˜¯ä½¿ç”¨  <code>WKWebViewConfiguration</code> ï¼Œæ„Ÿè§‰è¿™ä¸ªç±»è¿˜åœ¨å®Œå–„ã€æ‰©å……ä¸­ï¼Œå†…å®¹å¾ˆå°‘ã€‚æ¯”è¾ƒå€¼å¾—æ³¨æ„çš„æ˜¯ä¸ JavaScript æœ‰å…³çš„ä¸¤ä¸ªå±æ€§ã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å­—ä½“</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">CGFloat</span> minimumFontSize;</span><br><span class="line"><span class="comment">//æ˜¯å¦å…è®¸åœ¨æ²¡æœ‰ç”¨æˆ·äº¤äº’çš„æƒ…å†µä¸‹ï¼ŒJavaScriptå¯ä»¥æ‰“å¼€windows</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> javaScriptCanOpenWindowsAutomatically;</span><br><span class="line"><span class="comment">//æ˜¯å¦å¯ç”¨javaScriptï¼Œ14.0 ä»¥åå°±åºŸå¼ƒäº†ï¼Œæœ‰å¯¹åº”æ›¿æ¢çš„ API</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> javaScriptEnabled;<span class="comment">//ios(8.0, 14.0)</span></span><br><span class="line"><span class="comment">//æ˜¯å¦æé†’ å¦‚ç½‘ç»œé’“é±¼æˆ–æ¶æ„è½¯ä»¶ ç­‰å¯ç–‘çš„æ¬ºè¯ˆå†…å®¹</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">BOOL</span> fraudulentWebsiteWarningEnabled;<span class="comment">//ios(13.0)</span></span><br></pre></td></tr></table></figure>

<h4 id="WKUserContentController"><a href="#WKUserContentController" class="headerlink" title="WKUserContentController"></a>WKUserContentController</h4><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*! @abstract The user content controller to associate with the web view.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">WKUserContentController</span> *userContentController;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªç±»æä¾›äº†ä¸€ä¸ª JavaScript å‘ web view å‘é€æ¶ˆæ¯çš„é€”å¾„ï¼Œå¯ä»¥å¢åˆ ç”¨æˆ·è„šæœ¬ã€‚</p>
<p>JavaScript ä¸ åŸç”Ÿåšäº¤äº’ï¼Œæ¯”è¾ƒå¤šçš„ä¸€ä¸ªåœºæ™¯æ˜¯éœ€è¦è°ƒç”¨åŸç”Ÿçš„æŸäº›èƒ½åŠ›ã€‚åœ¨ <code>UIWebView</code> ä¸­ç®€å•çš„æ–¹å¼æ˜¯æ‹¦æˆªè¯·æ±‚ï¼Œæ ¹æ®ç‰¹å®šçš„ scheme æˆ–è€… å‚æ•°æ¥åŒºåˆ†ï¼Œé‚£åœ¨ <code>WKWebView</code> ä¸­åˆ™æ˜¯é€šè¿‡ <code>WKUserContentController</code> æ·»åŠ æ¶ˆæ¯å¤„ç†å™¨ã€‚ä¾‹å¦‚æ‰“å¼€ç›¸æœºåŠŸèƒ½ï¼š</p>
<ul>
<li>æ·»åŠ è„šæœ¬å¤„ç†å™¨</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">WKUserContentController</span> *userContentController = [[<span class="built_in">WKUserContentController</span> alloc] init];</span><br><span class="line">[userContentController addScriptMessageHandler:<span class="keyword">self</span> name:<span class="string">@"OpenCamera"</span>];</span><br><span class="line"><span class="built_in">WKWebViewConfiguration</span> *configuration = [[<span class="built_in">WKWebViewConfiguration</span> alloc] init];</span><br><span class="line">configuration.userContentController = userContentController;</span><br></pre></td></tr></table></figure>

<ul>
<li>å®ç° WKScriptMessageHandler ä»£ç†çš„æ–¹æ³•</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> mark - WKScriptMessageHandler</span></span><br><span class="line">- (<span class="keyword">void</span>)userContentController:(<span class="built_in">WKUserContentController</span> *)userContentController didReceiveScriptMessage:(<span class="built_in">WKScriptMessage</span> *)message &#123;</span><br><span class="line">    <span class="keyword">if</span> ([message.name caseInsensitiveCompare:<span class="string">@"OpenCamera"</span>] == <span class="built_in">NSOrderedSame</span>) &#123;</span><br><span class="line">        <span class="comment">//Call your open camera action.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çœ‹åˆ°æ¥æ”¶ JavaScript çš„æ¶ˆæ¯æ˜¯é€šè¿‡ä¸€ä¸ª <code>WKScriptMessage</code> ç±»å‹ï¼Œæˆ‘ä»¬å†æ¥ç®€å•çœ‹ä¸‹è¿™ä¸ªç±»</p>
<h4 id="WKScriptMessage"><a href="#WKScriptMessage" class="headerlink" title="WKScriptMessage"></a>WKScriptMessage</h4><blockquote>
<p>A WKScriptMessage object contains information about a message sent from a webpage.</p>
</blockquote>
<p>ä»–çš„æ³¨é‡Šå°±å¾ˆç®€å•äº†ï¼šä¸€ä¸ªåŒ…å«ç½‘é¡µå‘æ¥çš„æ¶ˆæ¯å†…å®¹çš„å¯¹è±¡ã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ¶ˆæ¯ä½“ã€å‚æ•°ã€‚å…è®¸çš„ç±»å‹ NSNumber, NSString, NSDate, NSArray, NSDictionary, and NSNull.</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="keyword">id</span> body;</span><br><span class="line"><span class="comment">// å‘é€æ¶ˆæ¯çš„ web viewã€‚</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">weak</span>) <span class="built_in">WKWebView</span> *webView;</span><br><span class="line"><span class="comment">// å‰ç«¯ä¸­å‘é€æ¶ˆæ¯çš„ frameã€‚</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">WKFrameInfo</span> *frameInfo;</span><br><span class="line"><span class="comment">// ç”¨äºæ¥æ”¶å‰ç«¯æ¶ˆæ¯çš„å¤„ç†å™¨çš„åå­—ã€‚</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="comment">// The content world from which the message was sent. ï¼Ÿæˆ‘ä¹Ÿè¿˜æ²¡ç”¨è¿‡ä¸æ¸…æ¥šæ˜¯å¹²å˜›çš„ã€‚</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>) <span class="built_in">WKContentWorld</span> *world API_AVAILABLE(macos(<span class="number">11.0</span>), ios(<span class="number">14.0</span>));</span><br></pre></td></tr></table></figure>

<h4 id="WKWebsiteDataStore"><a href="#WKWebsiteDataStore" class="headerlink" title="WKWebsiteDataStore"></a>WKWebsiteDataStore</h4><p>è¿™ä¸ªç±»è²Œä¼¼åŒ…å«äº†ä¸€ä¸ª web view çš„æ‰€æœ‰æ•°æ®ï¼Œæˆ‘çœ‹å®Œè¿™ä¸ªç±»çš„ä»‹ç»ï¼Œç¬¬ä¸€æ„Ÿè§‰æ˜¯ï¼Œå“‡ï¼Œæˆ‘å¯ä»¥çª¥æ¢ä¸€åˆ‡äº†ã€‚ç„¶è€Œï¼Œé™¤äº†cookieï¼Œä¸€æ¯›é’±éƒ½æ‹¿ä¸åˆ°â€¦â€¦ä¸è®²äº†ï¼Œæœ‰å…´è¶£è‡ªå·±è¯•å§~~</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">(</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeDiskCache</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeOfflineWebApplicationCache</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeMemoryCache</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeLocalStorage</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeFetchCache</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeCookies</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeSessionStorage</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeIndexedDBDatabases</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeWebSQLDatabases</span>,</span><br><span class="line">    <span class="built_in">WKWebsiteDataTypeServiceWorkerRegistrations</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="WKHTTPCookieStore"><a href="#WKHTTPCookieStore" class="headerlink" title="WKHTTPCookieStore"></a>WKHTTPCookieStore</h4><blockquote>
<p> A WKHTTPCookieStore object allows managing the HTTP cookies associated with a particular WKWebsiteDataStore.</p>
</blockquote>
<p>ç”¨æ¥ç®¡ç†ä¸ç‰¹å®š <code>WKWebsiteDataStore</code> ç›¸å…³è”çš„ HTTP cookieã€‚API çœ‹ä¸Šå»å¾ˆç®€å•â€¦è·å– cookie æ˜¯å¼‚æ­¥æ“ä½œï¼Œä¸<code>NSHTTPCookieStorage</code> çš„åŒæ­¥æ“ä½œä¸åŒï¼Œå¤„ç†èµ·æ¥å¯èƒ½è¦æ³¨æ„ä¸‹ã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)getAllCookies:(<span class="keyword">void</span> (^)(<span class="built_in">NSArray</span>&lt;<span class="built_in">NSHTTPCookie</span> *&gt; *))completionHandler;</span><br><span class="line">- (<span class="keyword">void</span>)setCookie:(<span class="built_in">NSHTTPCookie</span> *)cookie completionHandler:(<span class="keyword">nullable</span> <span class="keyword">void</span> (^)(<span class="keyword">void</span>))completionHandler;</span><br><span class="line">- (<span class="keyword">void</span>)deleteCookie:(<span class="built_in">NSHTTPCookie</span> *)cookie completionHandler:(<span class="keyword">nullable</span> <span class="keyword">void</span> (^)(<span class="keyword">void</span>))completionHandler;</span><br><span class="line">- (<span class="keyword">void</span>)addObserver:(<span class="keyword">id</span>&lt;<span class="built_in">WKHTTPCookieStoreObserver</span>&gt;)observer;</span><br><span class="line">- (<span class="keyword">void</span>)removeObserver:(<span class="keyword">id</span>&lt;<span class="built_in">WKHTTPCookieStoreObserver</span>&gt;)observer;</span><br></pre></td></tr></table></figure>

<p>å¯¹åº”è§‚å¯Ÿè€…çš„åè®®æ–¹æ³•ï¼š</p>
<p>åœ¨ cookie å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥å¼‚æ­¥é€šçŸ¥ï¼Œä½†ç»æµ‹è¯•æ˜¯æœ‰ä¸€ç‚¹å»¶è¿Ÿçš„ï¼Œæœ‰å…´è¶£å¯ä»¥æµ‹ä¸€æµ‹ï¼Ÿ</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">WKHTTPCookieStoreObserver</span> &lt;<span class="title">NSObject</span>&gt;</span></span><br><span class="line"><span class="keyword">@optional</span></span><br><span class="line">- (<span class="keyword">void</span>)cookiesDidChangeInCookieStore:(<span class="built_in">WKHTTPCookieStore</span> *)cookieStore;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>è¿˜æ²¡å†™å®Œ<del>~</del></p>
]]></content>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title>Warning! PATH is not properly set up, &#39;/Users/***/.rvm/gems/ruby-2.4.0/bin&#39; is not at first place.</title>
    <url>/2018/12/27/Warning!PATH-is/</url>
    <content><![CDATA[<p>å¿½ç„¶æœ‰ä¸€å¤©ã€‚ã€‚ã€‚ä½¿ç”¨ <code>cocoapods</code> å®‰è£…ä¸‰æ–¹åº“ä¸å¥½ä½¿äº†ï¼ŒæŠ¥äº†å¥½é•¿çš„é”™ã€‚ã€‚ã€‚</p>
<a id="more"></a>

<p>å‰<br>æ–¹<br>æœ‰<br>è¶…<br>é•¿<br>å›¾<br>ç‰‡<br>ï¼Œ<br>æ…<br>ç‚¹<br>ã€‚<br><img src="/2018/12/27/Warning!PATH-is/1.png" alt="error"></p>
<blockquote>
<p>æŒ‰ç…§é‡Œé¢çš„æç¤ºå»githubæœç´¢äº†cocoapodsä½¿ç”¨ä¸­çš„é—®é¢˜ï¼Œå¤šæ•°éƒ½æ˜¯è¯´ï¼Œé‡è£…gemã€‚ç¬”è€…ä¸æ˜¯å¾ˆæ‡‚è¿™äº›ï¼Œgemï¼Œrubyï¼Œcocoapodsï¼Œå…¨éƒ½æ›´æ–°äº†ä¸€éã€‚ä¾æ—§æ˜¯è¿™ä¸ªé—®é¢˜ã€‚</p>
</blockquote>
<p>ç¡äº†ä¸€è§‰é†’æ¥åï¼Œç¬”è€…è®¤çœŸçœ‹äº†çœ‹é”™è¯¯æç¤ºï¼Œæ³¨æ„åˆ°è¿™å¥ï¼š</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">### Command</span></span><br><span class="line"></span><br><span class="line">/Users/æˆ‘/.rvm/gems/ruby-<span class="number">2.4</span>.<span class="number">0</span>/bin/pod install</span><br></pre></td></tr></table></figure>

<p>æ—¢ç„¶å‘½ä»¤æ‰§è¡Œæ–‡ä»¶åœ¨è¿™ä¸ªè·¯å¾„ä¸‹ï¼Œå¯èƒ½æ˜¯rvmå‡ºäº†é—®é¢˜ï¼Œæ‰§è¡Œ <code>rvm list</code>æŸ¥çœ‹rubyç‰ˆæœ¬<br><img src="/2018/12/27/Warning!PATH-is/2.png" alt="rvm list"></p>
<p>æ³¨æ„åˆ°é‡Œé¢æœ‰ä¸ª <code>Warningï¼</code> å’Œå‡ ä¸ªå»ºè®®çš„æ“ä½œï¼ˆåšäº†ä¹Ÿæ²¡ç”¨ï¼Œæ˜¯çš„ï¼Œæˆ‘è¯•è¿‡äº†ï¼‰ğŸ˜Œ</p>
<blockquote>
<p>Warning! PATH is not properly set up, â€˜/Users/***/.rvm/gems/ruby-2.4.0/binâ€™ is not at first place.<br>ä»¿ä½›æ˜¯åœ¨è¯´ï¼Œrubyä¸åœ¨æœ€åˆï¼Ÿé¦–å…ˆï¼Ÿç¬¬ä¸€ä¸ªä½ç½®ï¼Ÿ<br>æ€»ä¹‹æŸäº›ä¸œè¥¿è¢«æ”¹äº†ï¼ˆä½†æˆ‘çœŸçš„æ²¡åŠ¨ï¼‰</p>
</blockquote>
<p>æœ¬äººè„¾æ°”æš´èºï¼Œæ‰€ä»¥æƒ³ç€ï¼Œæ—¢ç„¶åŠ¨äº†ï¼Œé‚£å°±æš´åŠ›è¿˜åŸå§ï¼Œæ‰§è¡Œ <code>rvm -h</code> æŸ¥çœ‹rvm çš„ç¥æ“ä½œä»¬<br><img src="/2018/12/27/Warning!PATH-is/3.png" alt="rvm -h"></p>
<p>æ³¨æ„åˆ°äº†å›¾ä¸­çš„è¿™å‡ ä¸ªå‘½ä»¤ï¼š<code>rvm maintenance</code> rvm çš„ç»´æŠ¤ï¼Ÿäºæ˜¯ä¹è¯•äº†ä¸€ä¸‹<br><code>rvm reset</code><br><code>rvm reset</code><br><code>rvm reset</code><br><code>rvm reset</code><br><code>rvm reset</code><br>é‡è¦çš„ äº‹æƒ…è¯´äº”éã€‚<br>commandé‡Œå¹¶æ²¡æœ‰ä»€ä¹ˆè¾“å‡ºï¼Œä»¿ä½›ç§˜å¯†åšäº†ä¸€äº›äº‹æƒ…ï¼Œç„¶åå†è¯•äº†ä¸‹ <code>pod install</code> å°±ğŸ‘Œäº†ã€‚<br>çœ‹åˆ°äº†ä¹…è¿çš„ç»¿è‰²ï¼Œæ”¾å¿ƒäº†ã€‚<br><img src="/2018/12/27/Warning!PATH-is/4.png" alt="ç»¿è‰²èµ°ä¸€æ³¢"></p>
]]></content>
  </entry>
  <entry>
    <title>iOS13 é€‚é…æ³¨æ„ç‚¹</title>
    <url>/2019/11/05/iOS13%20%E9%80%82%E9%85%8D%E6%B3%A8%E6%84%8F%E7%82%B9/</url>
    <content><![CDATA[<h5 id="1ã€KVC-è·å–ç§æœ‰å±æ€§-ç›´æ¥å´©æºƒï¼Œæ¯”æ–¹è¯´è·å–-SearchBar-çš„-TextField"><a href="#1ã€KVC-è·å–ç§æœ‰å±æ€§-ç›´æ¥å´©æºƒï¼Œæ¯”æ–¹è¯´è·å–-SearchBar-çš„-TextField" class="headerlink" title="1ã€KVC è·å–ç§æœ‰å±æ€§ ç›´æ¥å´©æºƒï¼Œæ¯”æ–¹è¯´è·å– SearchBar çš„ TextField"></a>1ã€KVC è·å–ç§æœ‰å±æ€§ ç›´æ¥å´©æºƒï¼Œæ¯”æ–¹è¯´è·å– SearchBar çš„ TextField</h5><p>â€‹    è§£å†³æ–¹æ¡ˆæ˜¯åšç‰ˆæœ¬åˆ¤æ–­ iOS13 çš„ searchbar æ–°å¢äº†ä¸€ä¸ª searchTextField å±æ€§</p>
<h5 id="2ã€Segementã€SearchBarçš„æ ·å¼å˜äº†ï¼Œæ³¨æ„ä¸€ä¸‹"><a href="#2ã€Segementã€SearchBarçš„æ ·å¼å˜äº†ï¼Œæ³¨æ„ä¸€ä¸‹" class="headerlink" title="2ã€Segementã€SearchBarçš„æ ·å¼å˜äº†ï¼Œæ³¨æ„ä¸€ä¸‹"></a>2ã€Segementã€SearchBarçš„æ ·å¼å˜äº†ï¼Œæ³¨æ„ä¸€ä¸‹</h5><p>â€‹    for å¾ªç¯æŸ¥æ‰¾å­è§†å›¾å¤±æ•ˆï¼Œæ”¹ä¸º  searchBar.searchTextField</p>
<p>â€‹        <a id="more"></a></p>
<h5 id="3ã€UIWebView-ç»ˆæåºŸå¼ƒï¼Œéœ€è¦æ›¿æ¢-WKWebViewï¼Œä¸ç„¶-AppStore-å®¡æ ¸æ˜¯ä¸é€šè¿‡çš„ã€‚"><a href="#3ã€UIWebView-ç»ˆæåºŸå¼ƒï¼Œéœ€è¦æ›¿æ¢-WKWebViewï¼Œä¸ç„¶-AppStore-å®¡æ ¸æ˜¯ä¸é€šè¿‡çš„ã€‚" class="headerlink" title="3ã€UIWebView ç»ˆæåºŸå¼ƒï¼Œéœ€è¦æ›¿æ¢ WKWebViewï¼Œä¸ç„¶ AppStore å®¡æ ¸æ˜¯ä¸é€šè¿‡çš„ã€‚"></a>3ã€UIWebView ç»ˆæåºŸå¼ƒï¼Œéœ€è¦æ›¿æ¢ WKWebViewï¼Œä¸ç„¶ AppStore å®¡æ ¸æ˜¯ä¸é€šè¿‡çš„ã€‚</h5><h5 id="4ã€é»‘å¤œæ¨¡å¼"><a href="#4ã€é»‘å¤œæ¨¡å¼" class="headerlink" title="4ã€é»‘å¤œæ¨¡å¼"></a>4ã€é»‘å¤œæ¨¡å¼</h5><h5 id="5ã€TextFieldï¼šLeftViewå¦‚æœæ˜¯å›¾ç‰‡çš„è¯-ä¼šè¦†ç›–æ•´ä¸ª-TextField-è§£å†³åŠæ³•æ˜¯ç”¨ä¸€ä¸ª-view-åŒ…è£¹ä¸€ä¸‹å›¾ç‰‡ä½œä¸ºLeftView"><a href="#5ã€TextFieldï¼šLeftViewå¦‚æœæ˜¯å›¾ç‰‡çš„è¯-ä¼šè¦†ç›–æ•´ä¸ª-TextField-è§£å†³åŠæ³•æ˜¯ç”¨ä¸€ä¸ª-view-åŒ…è£¹ä¸€ä¸‹å›¾ç‰‡ä½œä¸ºLeftView" class="headerlink" title="5ã€TextFieldï¼šLeftViewå¦‚æœæ˜¯å›¾ç‰‡çš„è¯ ä¼šè¦†ç›–æ•´ä¸ª TextField è§£å†³åŠæ³•æ˜¯ç”¨ä¸€ä¸ª view åŒ…è£¹ä¸€ä¸‹å›¾ç‰‡ä½œä¸ºLeftView"></a>5ã€TextFieldï¼šLeftViewå¦‚æœæ˜¯å›¾ç‰‡çš„è¯ ä¼šè¦†ç›–æ•´ä¸ª TextField è§£å†³åŠæ³•æ˜¯ç”¨ä¸€ä¸ª view åŒ…è£¹ä¸€ä¸‹å›¾ç‰‡ä½œä¸ºLeftView</h5><h5 id="6ã€UniversalLink"><a href="#6ã€UniversalLink" class="headerlink" title="6ã€UniversalLink"></a>6ã€UniversalLink</h5><h5 id="https-www-jianshu-com-p-03e6b7828307"><a href="#https-www-jianshu-com-p-03e6b7828307" class="headerlink" title="https://www.jianshu.com/p/03e6b7828307"></a><a href="https://www.jianshu.com/p/03e6b7828307" target="_blank" rel="noopener">https://www.jianshu.com/p/03e6b7828307</a></h5><p>â€‹    å¾®ä¿¡åˆ†äº«å¼ºåˆ¶ä½¿ç”¨ã€‚æ³¨å†Œå¾®ä¿¡å¼€æ”¾å¹³å°çš„æ—¶å€™ iOSçš„é¡¹ç›®å¿…é¡»å¡«è¿™ä¸ªã€‚</p>
<h5 id="7ã€æ¨¡æ€å‡ºçš„é¡µé¢ï¼Œéœ€è¦æŒ‡å®šå¯¹åº”çš„å¼¹å‡ºæ¨¡å¼"><a href="#7ã€æ¨¡æ€å‡ºçš„é¡µé¢ï¼Œéœ€è¦æŒ‡å®šå¯¹åº”çš„å¼¹å‡ºæ¨¡å¼" class="headerlink" title="7ã€æ¨¡æ€å‡ºçš„é¡µé¢ï¼Œéœ€è¦æŒ‡å®šå¯¹åº”çš„å¼¹å‡ºæ¨¡å¼"></a>7ã€æ¨¡æ€å‡ºçš„é¡µé¢ï¼Œéœ€è¦æŒ‡å®šå¯¹åº”çš„å¼¹å‡ºæ¨¡å¼</h5><p>â€‹    ä¾‹å¦‚ï¼šUIModalPresentationOverFullScreen</p>
<p>â€‹    æ£€æŸ¥å›¾ç‰‡é€‰æ‹©å™¨ï¼Ÿ</p>
<h5 id="8ã€Tabbarçš„æ–‡å­—é¢œè‰²"><a href="#8ã€Tabbarçš„æ–‡å­—é¢œè‰²" class="headerlink" title="8ã€Tabbarçš„æ–‡å­—é¢œè‰²"></a>8ã€Tabbarçš„æ–‡å­—é¢œè‰²</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[tabbarItem setTitleTextAttributes:@&#123;NSForegroundColorAttributeName:selectColor&#125; forState:UIControlStateSelected];</span><br></pre></td></tr></table></figure>

<p>â€‹    æ­¤æ–¹æ³•åœ¨ iOS 13 ä¼šæœ‰ bugï¼Œå½“æˆ‘ä»¬ push åˆ°ä¸‹ä¸€é¡µå†æ¬¡è¿”å›æ—¶ tabbar å­—ä½“é¢œè‰²è®¾ç½®ä¼šå¤±æ•ˆã€‚</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="keyword">self</span>.tabBar.tintColor = selectColor;</span><br></pre></td></tr></table></figure>

<h5 id="9ã€é€šè¿‡-NSURLSessionDataTask-ä¸‹è½½æ–‡ä»¶æµ"><a href="#9ã€é€šè¿‡-NSURLSessionDataTask-ä¸‹è½½æ–‡ä»¶æµ" class="headerlink" title="9ã€é€šè¿‡ NSURLSessionDataTask ä¸‹è½½æ–‡ä»¶æµ"></a>9ã€é€šè¿‡ NSURLSessionDataTask ä¸‹è½½æ–‡ä»¶æµ</h5><p>â€‹    éœ€è¦åœ¨å¤´éƒ¨æŒ‡å®šæ¥å—çš„è¿”å›æ ¼å¼ï¼š<code>application/octet-stream</code></p>
<h5 id="10ã€Cocoapods"><a href="#10ã€Cocoapods" class="headerlink" title="10ã€Cocoapods"></a>10ã€Cocoapods</h5><p>â€‹    å‡çº§ CocoaPods åˆ° 1.8.4 ç‰ˆæœ¬</p>
<p>â€‹    ä½†æ˜¯éšå³é—®é¢˜å°±æ¥äº†, æ‰§è¡Œ pod install ä¸‹è½½åº“æ—¶ï¼Œå‡ºç°é”™è¯¯</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">[!] <span class="symbol">CDN:</span> trunk URL couldn<span class="string">'t be downloaded: https://cdn.cocoapods.org/all_pods_versions_a_7_5.txt, error: execution expired</span></span><br></pre></td></tr></table></figure>

<p>åæ¥æŸ¥äº†åŠå¤©èµ„æ–™, æœ€ç»ˆåœ¨ <a href="https://github.com/CocoaPods/CocoaPods/issues/9303" target="_blank" rel="noopener">github CocoaPods issues</a> æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼šåœ¨ Podfile åŠ ä¸Š source <code>https://github.com/CocoaPods/Specs.git</code> ä¸ä½¿ç”¨æ–°ç‰ˆæœ¬çš„ CDN</p>
]]></content>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title>iTerm 2 åˆ†å±åˆ‡æ¢</title>
    <url>/2020/12/14/iTerm%202%20%E5%88%86%E5%B1%8F/</url>
    <content><![CDATA[<ul>
<li><code>âŒ˜ + d</code>:  å‚ç›´åˆ†å±</li>
<li><code>âŒ˜ + shift + d</code>:  æ°´å¹³åˆ†å±</li>
<li><code>âŒ˜ + ]</code>å’Œ<code>âŒ˜ + [</code> ï¼šåœ¨æœ€è¿‘ä½¿ç”¨çš„åˆ†å±ç›´æ¥åˆ‡æ¢</li>
<li><code>âŒ˜ + opt + æ–¹å‘é”®</code>ï¼šåˆ‡æ¢åˆ°æŒ‡å®šä½ç½®çš„åˆ†å±</li>
<li><code>âŒ˜ + æ•°å­—</code>ï¼šåˆ‡æ¢æ ‡ç­¾é¡µ</li>
<li><code>âŒ˜ + æ–¹å‘é”®</code> ï¼šæŒ‰æ–¹å‘åˆ‡æ¢æ ‡ç­¾é¡µ</li>
<li><code>shift + âŒ˜ + s</code>ï¼šä¿å­˜å½“å‰çª—å£å¿«ç…§</li>
<li><code>âŒ˜ + opt + b</code>ï¼šå¿«ç…§å›æ”¾ï¼Œå¾ˆæœ‰æ„æ€çš„åŠŸèƒ½ï¼Œä½ å¯ä»¥å¯¹ä½ çš„æ“ä½œæ ¹æ®æ—¶é—´è½´è¿›è¡Œå›æ”¾ã€‚å¯ä»¥æ‹–åŠ¨ä¸‹æ–¹çš„æ—¶é—´è½´ï¼Œä¹Ÿå¯ä»¥æŒ‰å·¦å³æ–¹å‘é”®ã€‚</li>
</ul>
<p>PS: å¦‚æœå‘ç°å¿«æ·é”®æ²¡èµ·ä½œç”¨ï¼Œå¯ä»¥çœ‹çœ‹æ˜¯ä¸æ˜¯å’Œç³»ç»Ÿæˆ–è€…å…¶ä»–è½¯ä»¶çš„å¿«æ·é”®å†²çªäº†â€¦â€¦</p>
]]></content>
      <tags>
        <tag>Mac</tag>
      </tags>
  </entry>
  <entry>
    <title>mailcore 2 iOS  ä¹‹äºŒ SMTP</title>
    <url>/2018/12/12/mailcore2-iOS%E4%B9%8B%E4%BA%8CSMTP/</url>
    <content><![CDATA[<p>èµ·æºè§ <a href="http://zhengyatian.github.io/2018/02/02/2018-02-02-mailcore-2-iOS-%E4%B9%8B%E4%B8%80-IMAP/" target="_blank" rel="noopener">mailcore2-ios  ä¹‹ä¸€ IMAP</a></p>
<p>ä¸Šä¸€ç¯‡å¤§è‡´è¯´äº†ä¸‹IMAPåè®®ä¸­çš„ç®€å•ä½¿ç”¨ï¼Œçœ‹åˆ°æ–‡ç« æœ‰äººçœ‹ï¼Œä¸ºäº†æˆ‘çš„<code>ä¸‰ä¸ª</code>ğŸ‘¨â€ğŸ’»â€ğŸ‘¨â€ğŸ’»â€ğŸ‘¨â€ğŸ’»â€ç²‰ä¸ï¼Œé‚£æˆ‘ç»§ç»­æ›´æ–°ä¸€ä¸‹ï¼Œ</p>
<p>å¸Œæœ›å¯¹ä½ ä»¬æœ‰å¸®åŠ©ï¼Œä¹Ÿåšä¸ªæ²Ÿé€šäº¤æµã€‚</p>
<ul>
<li><p>IMAP <a href="http://zhengyatian.github.io/2018/02/02/2018-02-02-mailcore-2-iOS-%E4%B9%8B%E4%B8%80-IMAP/" target="_blank" rel="noopener">mailcore2-ios  ä¹‹ä¸€ IMAP</a></p>
</li>
<li><p>SMTP</p>
  <a id="more"></a>

<ul>
<li>ç™»å½•/ç”¨æˆ·éªŒè¯</li>
<li>åˆ›å»ºé‚®ä»¶ä½“</li>
<li>é™„ä»¶æ·»åŠ </li>
<li>å‘é€</li>
<li>å‘é€æˆåŠŸå<code>æ‰‹åŠ¨</code>æ·»åŠ åˆ°<code>â€œå·²å‘é€â€</code>æ–‡ä»¶å¤¹</li>
</ul>
</li>
</ul>
<h5 id="SMTP"><a href="#SMTP" class="headerlink" title="SMTP"></a>SMTP</h5><h6 id="1ã€ç™»å½•-ç”¨æˆ·éªŒè¯"><a href="#1ã€ç™»å½•-ç”¨æˆ·éªŒè¯" class="headerlink" title="1ã€ç™»å½•/ç”¨æˆ·éªŒè¯"></a>1ã€ç™»å½•/ç”¨æˆ·éªŒè¯</h6><p>â€‹    ä¸è®ºå“ªç§åè®®ï¼Œéƒ½éœ€è¦å…ˆéªŒè¯é‚®ç®±åœ°å€/æœåŠ¡å™¨ã€å¯†ç ã€ç«¯å£ç­‰ï¼ŒSMTPä¹Ÿä¸€æ ·ï¼Œä½ ä¹Ÿå¯ä»¥ä¸éªŒè¯ï¼Œå¤§ä¸äº†å°±æ˜¯å‘ä¸å‡ºå»é‚®ä»¶ã€‚ã€‚ã€‚ğŸ¤“ğŸ¤“ğŸ¤“ğŸ¤“ğŸ¤“</p>
<p>åˆ›å»ºsessionï¼Œéƒ½ç±»ä¼¼çš„</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">self</span>.smtpSession.hostname = session.smtpHost;<span class="comment">//smtp.***.com</span></span><br><span class="line"><span class="keyword">self</span>.smtpSession.username = session.username;<span class="comment">//littlecat@xxx.com.cn</span></span><br><span class="line"><span class="keyword">self</span>.smtpSession.password = session.password;<span class="comment">//password</span></span><br><span class="line"><span class="keyword">self</span>.smtpSession.port     = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)session.smtpPort;<span class="comment">//25ã€465ã€587ï¼Ÿ</span></span><br><span class="line"><span class="keyword">self</span>.smtpSession.connectionType = session.smtpIsSSL ? MCOConnectionTypeTLS: MCOConnectionTypeClear;<span class="comment">//å–å†³äºä½ çš„é‚®ä»¶æœåŠ¡å™¨æ˜¯ä¸æ˜¯SSLçš„ï¼›</span></span><br><span class="line"><span class="keyword">self</span>.smtpSession.authType = MCOAuthTypeSASLLogin;<span class="comment">//sessionæ ¡éªŒçš„ç±»å‹ï¼Œè¿™é‡Œé€‰çš„ç™»å½•ï¼Œå…¶ä»–è¿˜æ²¡ææ˜ç™½(æ²¡çœ‹ã€‚ã€‚)ğŸ˜Œ</span></span><br></pre></td></tr></table></figure>

<p>æ ¡éªŒé‚®ç®±ä¿¡æ¯</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">MCOSMTPOperation *smtpOperation = [smtpSession loginOperation];</span><br><span class="line">[smtpOperation start:^(<span class="built_in">NSError</span> * error) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"finished checking SMTP account."</span>);</span><br><span class="line">    <span class="keyword">if</span> (error == <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="comment">//now ,you can send email.</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"error check smtp account: %@"</span>, error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h6 id="2ã€åˆ›å»ºé‚®ä»¶"><a href="#2ã€åˆ›å»ºé‚®ä»¶" class="headerlink" title="2ã€åˆ›å»ºé‚®ä»¶"></a>2ã€åˆ›å»ºé‚®ä»¶</h6><ul>
<li>create message builder;</li>
<li>set sender(from)ã€receiverï¼ˆtoï¼‰ã€cc and bcc;</li>
<li>set body (html body  or  plain text body);</li>
</ul>
<p>æ‡’å¾—æ­£ç»æ‰“å­—äº†ï¼Œbite meï¼ğŸ™„ğŸ™„ğŸ™„ğŸ™„ğŸ™„ğŸ™„ğŸ™„ğŸ™„ğŸ™„ğŸ™„</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)messageBuildFrom:(<span class="built_in">NSString</span> *)displayName <span class="comment">// å‘ä»¶äººæ˜µç§°ï¼Œå¯ä»¥ä¸è®¾ç½®ï¼›</span></span><br><span class="line">                 mailBox:(<span class="built_in">NSString</span> *)mail  <span class="comment">//å‘ä»¶äººé‚®ç®±åœ°å€ï¼›</span></span><br><span class="line">                      to:(<span class="built_in">NSArray</span> *)to  <span class="comment">//æ”¶ä»¶äººï¼ˆé‚®ç®±åœ°å€å­—ç¬¦ä¸²æ ¼å¼ï¼Œä¸‹åŒï¼‰ï¼›</span></span><br><span class="line">                      cc:(<span class="built_in">NSArray</span> *)cc  <span class="comment">//æŠ„é€äººï¼›</span></span><br><span class="line">                     bcc:(<span class="built_in">NSArray</span> *)bcc  <span class="comment">//å¯†é€äººï¼›</span></span><br><span class="line">                 subject:(<span class="built_in">NSString</span> *)subject  <span class="comment">//é‚®ä»¶ä¸»é¢˜ï¼›</span></span><br><span class="line">                textBody:(<span class="built_in">NSString</span> *)body  <span class="comment">//é‚®ä»¶æ­£æ–‡ï¼Œæˆ‘è¿™é‡Œæ˜¯å¸¦æ ‡ç­¾çš„htmlæ–‡æœ¬ï¼›</span></span><br><span class="line">                 attachs:(<span class="built_in">NSDictionary</span> *)attachs  <span class="comment">//é™„ä»¶sï¼ˆæ–‡ä»¶åç§°å’ŒNSDataæ ¼å¼æ•°æ®ï¼‰ï¼›</span></span><br><span class="line">                htmlBody:(MCOAbstractMessage *)msgParser  <span class="comment">//è½¬å‘æ—¶çš„åŸé‚®ä»¶ï¼›</span></span><br><span class="line">         completeHandler:(<span class="keyword">void</span>(^)())complete</span><br><span class="line">                   error:(<span class="keyword">void</span>(^)(<span class="built_in">NSError</span> *error))fail</span><br><span class="line">&#123;</span><br><span class="line">    MCOMessageBuilder *msgBuilder = [[MCOMessageBuilder alloc] init];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//header;</span></span><br><span class="line">    <span class="keyword">if</span> (displayName != <span class="literal">nil</span>) &#123;</span><br><span class="line">        msgBuilder.header.from = [MCOAddress addressWithDisplayName:displayName mailbox:mail];</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        msgBuilder.header.from = [MCOAddress addressWithMailbox:mail];</span><br><span class="line">    &#125;</span><br><span class="line">    msgBuilder.header.to      = [<span class="keyword">self</span> mailStringToMCOAddress:to];<span class="comment">//å­—ç¬¦ä¸²æ ¼å¼çš„é‚®ç®±åœ°å€ï¼Œè¦è½¬æˆaddressç±»ï¼›</span></span><br><span class="line">    msgBuilder.header.cc      = [<span class="keyword">self</span> mailStringToMCOAddress:cc];</span><br><span class="line">    msgBuilder.header.bcc     = [<span class="keyword">self</span> mailStringToMCOAddress:bcc];</span><br><span class="line">    msgBuilder.header.subject = subject;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//body</span></span><br><span class="line">    [msgBuilder setHTMLBody:body];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//------è§ä¸‹</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSArray</span> *)mailStringToMCOAddress:(<span class="built_in">NSArray</span> *)arr</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *temp = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">NSString</span> *str <span class="keyword">in</span> arr) &#123;</span><br><span class="line">        MCOAddress *add = [MCOAddress addressWithMailbox:str];</span><br><span class="line">        [temp addObject:add];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp.copy;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="3ã€é™„ä»¶å¤„ç†"><a href="#3ã€é™„ä»¶å¤„ç†" class="headerlink" title="3ã€é™„ä»¶å¤„ç†"></a>3ã€é™„ä»¶å¤„ç†</h6><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)messageBuildFrom:(<span class="built_in">NSString</span> *)displayName</span><br><span class="line">                 mailBox:(<span class="built_in">NSString</span> *)mail</span><br><span class="line">                      to:(<span class="built_in">NSArray</span> *)to</span><br><span class="line">                      cc:(<span class="built_in">NSArray</span> *)cc</span><br><span class="line">                     bcc:(<span class="built_in">NSArray</span> *)bcc</span><br><span class="line">                 subject:(<span class="built_in">NSString</span> *)subject</span><br><span class="line">                textBody:(<span class="built_in">NSString</span> *)body</span><br><span class="line">                 attachs:(<span class="built_in">NSDictionary</span> *)attachs</span><br><span class="line">                htmlBody:(MCOAbstractMessage *)msgParser</span><br><span class="line">         completeHandler:(<span class="keyword">void</span>(^)())complete</span><br><span class="line">                   error:(<span class="keyword">void</span>(^)(<span class="built_in">NSError</span> *error))fail</span><br><span class="line">&#123;</span><br><span class="line">    MCOMessageBuilder *msgBuilder = [[MCOMessageBuilder alloc] init];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -------è§ä¸Š ã€‚ã€‚ã€‚ ------//</span></span><br><span class="line">    <span class="keyword">if</span> (msgParser != <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="comment">//é™„åŠ èµ„æºï¼Œ</span></span><br><span class="line">        <span class="built_in">NSArray</span> *inAttach = msgParser.htmlInlineAttachments;</span><br><span class="line">        <span class="keyword">for</span> (MCOAttachment *attach <span class="keyword">in</span> inAttach) &#123;</span><br><span class="line">            <span class="built_in">NSString</span> * path = [<span class="built_in">NSTemporaryDirectory</span>() stringByAppendingPathComponent:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@_%@"</span>,msgParser.header.messageID,attach.filename]];</span><br><span class="line">            <span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfFile:path];</span><br><span class="line">            <span class="keyword">if</span> (data) &#123;</span><br><span class="line">                MCOAttachment *temp = [MCOAttachment attachmentWithData:data filename:attach.filename];</span><br><span class="line">                temp.inlineAttachment = <span class="literal">YES</span>;</span><br><span class="line">                [msgBuilder addRelatedAttachment:temp];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//çœ‹æ¥å£æ–‡æ¡£çš„æ„æ€ï¼Œä¸Šé¢æ˜¯æŠŠè½¬å‘çš„é‚®ä»¶ä¸­çš„é™„ä»¶æ·»åŠ ä¸Šï¼Œ</span></span><br><span class="line">    <span class="comment">//å¯æ˜¯å¹¶ä¸èµ·ä½œç”¨ã€‚ã€‚ã€‚é‡‡å–çš„æ–¹æ³•æ˜¯ï¼Œä¸‹é¢å¾ªç¯å†æ·»åŠ ä¸€æ¬¡ã€‚ã€‚ã€‚ã€‚ğŸ¤§ğŸ¤§ğŸ¤§ğŸ¤§ğŸ¤§</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//é™„ä»¶</span></span><br><span class="line">    <span class="keyword">if</span> (attachs) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">NSString</span> *name <span class="keyword">in</span> attachs.allKeys) &#123;</span><br><span class="line">            MCOAttachment *attach = [MCOAttachment attachmentWithData:[attachs objectForKey:name] filename:name];</span><br><span class="line">            [msgBuilder addAttachment:attach];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//send</span></span><br><span class="line">    <span class="comment">//--------è§ä¸‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="4ã€å‘é€é‚®ä»¶"><a href="#4ã€å‘é€é‚®ä»¶" class="headerlink" title="4ã€å‘é€é‚®ä»¶"></a>4ã€å‘é€é‚®ä»¶</h6><p>é‚®ä»¶ä¹Ÿåˆ›å»ºäº†ï¼Œé™„ä»¶æ·»åŠ å®Œï¼Œç»ˆäºè¦å‘é€äº†ï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯<code>å‘é€æ“ä½œæˆåŠŸå®Œæˆåï¼Œå¯¹æ–¹ç¡®å®å¯ä»¥æˆåŠŸæ”¶åˆ°ï¼Œä½†æ˜¯åœ¨å‘é€æ–¹çš„â€œå·²å‘é€â€æ˜¯æ²¡æœ‰çš„ï¼Œéœ€è¦æ‰‹åŠ¨appendä¸€ä»½è¿‡å»</code>ã€‚<br>æ‰§è¡Œappendæ“ä½œï¼Œéœ€è¦ç”¨<code>imapSession</code>çš„ï¼Œä¸è¦æé”™äº†ã€‚ğŸ˜…<br> â€œå·²å‘é€â€æ–‡ä»¶å¤¹çš„filepathï¼Œå¯èƒ½æ˜¯ <code>Sentã€Sent Messages</code>ç­‰ç­‰ï¼Œå…·ä½“çœ‹ä½ è§£æçš„é‚®ç®±æœåŠ¡å™¨ï¼Œä¸ä¸€å®šéƒ½æ˜¯Sent å“¦ã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//send</span></span><br><span class="line"><span class="built_in">NSData</span> *rfc822 = [msgBuilder data];</span><br><span class="line">MCOSMTPSendOperation *send = [smtpSession sendOperationWithData:rfc822];</span><br><span class="line">[send start:^(<span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;</span><br><span class="line">        fail(error);</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//å‘é€æˆåŠŸåï¼Œæ‰‹åŠ¨æ·»åŠ åˆ°â€œå·²å‘é€â€ï¼›</span></span><br><span class="line">        MCOIMAPAppendMessageOperation *op = [imapSession appendMessageOperationWithFolder:[MMIMAPTool getVirtualNameFor:<span class="string">@"Sent"</span>] messageData:rfc822 flags:MCOMessageFlagMDNSent];</span><br><span class="line">        [op start:^(<span class="built_in">NSError</span> *error, uint32_t createdUID) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"create sent message :%@\nerror:%@"</span>, @(createdUID), error);</span><br><span class="line">        &#125;];</span><br><span class="line">        complete();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p>æ³¨ï¼šä¸Šä¸€ç¯‡IMAPä½¿ç”¨ä¸­æåˆ°è¿‡ï¼Œåˆ›å»ºè‰ç¨¿ï¼Œè¿‡ç¨‹å’Œè¿™ä¸ªç±»ä¼¼ï¼Œä¸è¿‡æœ€åæ‰§è¡Œappend æ˜¯ æ”¾åˆ° <code>è‰ç¨¿ç®±</code>ï¼Œä¸æ˜¯<code>å·²å‘é€</code>äº†ã€‚</p>
<h5 id="POP-è¿˜æ²¡å†™"><a href="#POP-è¿˜æ²¡å†™" class="headerlink" title="POP è¿˜æ²¡å†™"></a>POP <a href>è¿˜æ²¡å†™</a></h5>]]></content>
  </entry>
  <entry>
    <title>ä¹Œé¾™ ä¹‹ æˆ‘åäº†</title>
    <url>/2020/06/02/%E4%B9%8C%E9%BE%99-%E6%88%91%E5%90%90%E4%BA%86/</url>
    <content><![CDATA[<p>ä¹‹å‰ç”¨çš„ hexo ä¸»é¢˜ä½œè€…ä¸ç»´æŠ¤äº†ï¼Œæ‰€ä»¥æ¢äº†ä¸ªæ´‹æ°”çš„<del>~</del></p>
<p>ä¹Œé¾™å°±è¿™æ ·å¼€å§‹äº†ï¼š</p>
<a id="more"></a>

<p>æ–‡ç« é‡Œçš„ä»£ç å—ï¼Œæ˜æ˜è®¾ç½®äº†è¯­è¨€objective-cï¼Œå¯æ˜¯é«˜äº®å´æ€ä¹ˆéƒ½ä¸èµ·ä½œç”¨ï¼Œé¼“æ£äº†ä¸€é€šhljsï¼Œå…¶å®hexo é»˜è®¤çš„å°±æ˜¯hljsï¼Œæˆ‘è¿˜è·‘å»ç»™äººä¸»é¢˜ä½œè€…ç•™äº†è¨€ã€‚ã€‚ã€‚</p>
<p>æœç´¢äº†åŠå¤©å¤§å®¶éƒ½æ˜¯æ€ä¹ˆè®¾ç½®é«˜äº®çš„ï¼Œæˆ‘å‘ç°å‘è¡¨æ„è§çš„äººä¸­ï¼Œå¶æœ‰å‡ ä¸ªæ˜¯åŒè¡Œï¼ŒæŠ›å¼€è®¾ç½®è¯­è¨€çš„æ–¹å¼ï¼Œä»–ä»¬ç»™ä»£ç è®¾ç½®çš„è¯­è¨€éƒ½æ˜¯ <strong>objc</strong></p>
<p>äºæ˜¯æˆ‘ä¹Ÿ</p>
<blockquote>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">â€‹```objc</span><br></pre></td></tr></table></figure>
</blockquote>
<p>.</p>
<p>.</p>
<p>.</p>
<p>å°±å¥½äº†ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p><strong>objective-c</strong>æ”¹ä¸º<strong>objc</strong> ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å°±å¥½äº†ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p>æˆ‘åäº†çœŸçš„æ˜¯<del>~</del></p>
<p>PSï¼šä½¿ç”¨çš„mdç¼–è¾‘å™¨æ˜¯Typoraï¼Œæˆ‘çœ‹äººå®¶æœ‰ä¸ªè¯­è¨€çš„é€‰é¡¹æ˜¯ objective-cï¼Œæˆ‘å°±é€‰äº†ã€‚ã€‚ã€‚ã€‚ã€‚ç§€é€—äº†ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p>
<p><img src="/2020/06/02/%E4%B9%8C%E9%BE%99-%E6%88%91%E5%90%90%E4%BA%86/1.png" alt="å›¾ä¸€"></p>
]]></content>
      <tags>
        <tag>çæ‰¯</tag>
      </tags>
  </entry>
  <entry>
    <title>å»æ‰UIWebViewåº•éƒ¨çš„é»‘æ¡</title>
    <url>/2018/12/13/%E5%8E%BB%E6%8E%89UIWebView%E5%BA%95%E9%83%A8%E7%9A%84%E9%BB%91%E6%9D%A1/</url>
    <content><![CDATA[<p>webview åœ¨å¤šæ¬¡åˆ·æ–°å†…å®¹åï¼Œæ­£æ–‡çš„ä¸‹é¢æœ‰ä¸€å—è«åå…¶å¦™çš„é»‘è‰²åŒºåŸŸï¼Œå¦‚å›¾ä¸€ï¼Œæœ¬ä»¥ä¸ºæ˜¯ç”±äºæˆ‘æ”¹äº†â€œUIWebDocumentViewâ€ çš„åŸå› ï¼Œçœ‹åˆ°è¿™ä¸ªå±æ€§æ”¹äº†ä¸€ä¸‹ï¼Œå‘ç°å±…ç„¶å¥½äº†ã€‚ã€‚ã€‚<br><code>opaque é»˜è®¤æ˜¯YES</code><br>æ”¹ä¸º <code>self.webView.opaque = NO;</code></p>
<a id="more"></a>

<p><img src="/2018/12/13/%E5%8E%BB%E6%8E%89UIWebView%E5%BA%95%E9%83%A8%E7%9A%84%E9%BB%91%E6%9D%A1/1.png" alt="å›¾ä¸€"></p>
<p><img src="/2018/12/13/%E5%8E%BB%E6%8E%89UIWebView%E5%BA%95%E9%83%A8%E7%9A%84%E9%BB%91%E6%9D%A1/2.png" alt="å›¾äºŒ"></p>
<p>çœ‹æ–‡æ¡£é‡Œé¢çš„æ³¨é‡Šï¼Œå‘ç°ï¼Œæˆ‘çš„è‹±æ–‡çœŸçš„ä¸å’‹åœ°ï¼Œè‡ªå·±ç¿»è¯‘å§ã€‚ã€‚ã€‚ã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">getter</span>=isOpaque) <span class="built_in">BOOL</span>  opaque;                     </span><br><span class="line"><span class="comment">// default is YES. opaque views must fill their entire bounds or the results are undefined. </span></span><br><span class="line"><span class="comment">//the active CGContext in drawRect: will not have been cleared and may have non-zeroed pixels</span></span><br></pre></td></tr></table></figure>
]]></content>
  </entry>
  <entry>
    <title>åƒé¥­å•¦</title>
    <url>/2020/05/22/%E5%90%83%E9%A5%AD%E5%95%A6/</url>
    <content><![CDATA[<p><img src="/2020/05/22/%E5%90%83%E9%A5%AD%E5%95%A6/0522lunch.jpg" alt></p>
<p>å°±ç®—ä¸€ä¸ªäººåœ¨å®¶æ¬¡é¥­ï¼Œä¹Ÿè¦å…ƒæ°”æ»¡æ»¡çš„å“¦ï¼Œä»‹ç»ä¸€ä¸‹è¿™ä¸ªå°èœå•å§ï¼Œå“ˆå“ˆï¼š</p>
<p>ğŸŸğŸŸğŸŸğŸŸæ¸…çƒ¤å¤šæ˜¥é±¼</p>
<blockquote>
<p>äº¬éƒ½å¤šæ˜¥é›¨ï¼Œå›é¦–å¤šæ˜¥å…‰ã€‚å…¬å­å¤šæ˜¥æƒ…ï¼Œç»¿è‰å¤šæ˜¥èŠ³ã€‚å…«è½½å¤šæ˜¥ä¼¤ï¼Œæ©™å­å¤šæ˜¥é±¼ã€‚</p>
</blockquote>
<a id="more"></a>

<p>â€‹    å¤šæ˜¥é±¼çš„åå­—èµ·å¾—å¯ä»¥è¯´éå¸¸è´´åˆ‡ï¼Œå››å­£å¤šå­ï¼Œæ»¡è…¹é±¼å­ï¼Œåƒèµ·æ¥Qå¼¹åˆæœ‰è¥å…»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">æ‹”æ‰é±¼é³ƒå’Œå†…è„</span><br><span class="line">åŠ ä¸€äº›æ–™é…’å‘€ã€ç”Ÿå§œå‘€ã€èƒ¡æ¤’ç²‰ è…Œ10åˆ†é’Ÿå°±å¯ä»¥å–½</span><br><span class="line">çƒ¤ç®±ä¸Šä¸‹220é¢„çƒ­5åˆ†é’Ÿï¼Œçƒ˜çƒ¤æ—¶é—´è®¾ç½®ä¸º15åˆ†é’Ÿ</span><br><span class="line">é¢„çƒ­æœŸé—´å¯ä»¥å‡†å¤‡åˆ·æ²¹äº†ï¼Œè½»è½»åˆ·ä¸€ç‚¹å°±å¥½äº†ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯æ¸…çƒ¤å˜›ï¼Œå˜»å˜»~~</span><br></pre></td></tr></table></figure>



<p>ğŸ†æ¸…è’¸èŒ„å­</p>
<p>æ¸…è’¸èŒ„å­æ˜¯æˆ‘å¤å¤©æœ€å–œæ¬¢åƒçš„ä¸€é“èœï¼Œçˆ½å£åˆæ²¡æœ‰çƒ­é‡ğŸ˜³</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">èŒ„å­æ´—å‡€åˆ‡ç‰‡ï¼Œä¸Šé”…è’¸</span><br><span class="line">å‡†å¤‡è’œå’Œé¦™æ²¹ï¼Œè’œåˆ‡æœ«å¤‡ç”¨ï¼Œçœ‹è‡ªå·±å–œå¥½æ”¾å¤šå°‘å§</span><br><span class="line">èŒ„å­æ•´å¥½ä»¥åï¼Œæ”¾åœ¨å®¹å™¨ä¸­ï¼ŒåŠ å…¥ç›ã€è’œæœ«ã€é¦™æ²¹å‡ æ»´</span><br><span class="line">å¯ä»¥å¼€åŠ¨äº†ï¼Œé¦™å–·å–·ç¾æ»‹æ»‹å‘€</span><br></pre></td></tr></table></figure>

<p>PSï¼šæˆ‘ä¸ªäººå¾ˆå–œæ¬¢åœ¨èœé‡Œæ”¾å¤§è’œï¼Œå› ä¸ºåƒå¤§è’œå¯ä»¥è®©äººå¿«ä¹ã€‚å“ˆå“ˆã€‚</p>
<p>ğŸŒ²å¦ä¸€ä¸ªèœå«ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>å…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå“ˆå“ˆï¼ŒåœŸè±†ã€é’æ¤’ã€æ´‹è‘±å¤§æ‚çƒ©ï¼Œåˆ‡æˆå°ç‰‡ï¼Œä¸€èµ·ç¿»ç‚’ï¼Œå–œæ¬¢åƒè‚‰å¯ä»¥æ”¾ç‚¹è‚‰ç²’ï¼Œæˆ‘ä¸å–œæ¬¢ï¼Œæ‰€ä»¥æ˜¯ç´ ç‚’çš„ã€‚</p>
<p>ğŸšæœ€åé…ä¸Šä¸€ç¢—ç™½ç±³é¥­ï¼Œå¯ä»¥å¼€åŠ¨å•¦<del>~</del></p>
<p>å•èº«ç‹—ä»¬çœ‹å®Œä¼šä¸ä¼šè§‰å¾—å¾ˆéº»çƒ¦å‘¢ï¼Œä¸€ä¸ªäººåšè¿™ä¹ˆå¤šè¦å¤šä¹…å‘€ï¼Œå¥½çƒ¦ã€‚å‘ï¼Œæ—¶é—´ç®¡ç†å¤§å¸ˆè¯´è¿‡(ä¸æ˜¯ç½—å¿—ç¥¥ğŸ™…â€â™‚ï¸)ï¼Œæ‰€æœ‰çš„ä»»åŠ¡è¦åŒºåˆ†å¥½ï¼Œå¹¶è¡Œå’Œä¸²è¡Œï¼æ‹¿æˆ‘ä»¬è¿™æ¬¡çš„åˆé¤ä¸¾ä¾‹ï¼š</p>
<blockquote>
<p>è’¸ğŸš -&gt; å¤„ç†ğŸ† -&gt; ä¸Šé”…è’¸ -&gt; å¤„ç†ğŸŸ + åˆ‡åœŸè±†ç­‰ç­‰ -&gt; ğŸŸè¿›çƒ¤ç®± -&gt; ğŸ†å‡ºé”… -&gt; ç‚’å¤§æ‚çƒ© = åƒé¥­å•¦<del>~</del></p>
</blockquote>
<p>ä¸ºä»€ä¹ˆåˆ†äº«ç¾é£Ÿå‘¢ï¼Œå…¶å®æˆ‘å°±æ˜¯è¯•ä¸€ä¸‹å›¾ç‰‡ä¸ºä»€ä¹ˆåŠ ä¸è¿›å»äº†ï¼Œç°åœ¨å¥½äº†<del>~</del>QTQ</p>
]]></content>
  </entry>
  <entry>
    <title>ç”± Pod å¯¼è‡´çš„ File not found</title>
    <url>/2020/09/04/%E7%94%B1%20Pod%20%E5%AF%BC%E8%87%B4%E7%9A%84File%20not%20found/</url>
    <content><![CDATA[<p>ä»Šå¤©å¯¹ä¸€ä¸ª Pod åº“åšäº†å°ç‰ˆæœ¬çš„å‡çº§ï¼Œç„¶ååˆå›é€€åˆ°åŸæ¥çš„ç‰ˆæœ¬ï¼ŒCocoaPods å°±ä¸ä¹æ„äº†ï¼Œ ä¸€ç›´æŠ¥ <code>#import &lt;Masonry/Masonry.h&gt; file not found</code> ç±»ä¼¼çš„é”™è¯¯ï¼Œæ‰€æœ‰çš„ Pod åº“éƒ½è¿™æ ·ï¼Œç€å®è®©äººå¤´å¤§ã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼š<br> ç‚¹å‡» <code>YourProject -&gt; Project -&gt; é€‰ä¸­ YourProject -&gt; Info -&gt; Configurations -&gt;</code> æŠŠå¯¹åº”çš„ <code>Debug</code> å’Œ <code>Release</code> é‡Œçš„å‚æ•°è®¾ä¸º <code>Pods-xxxxxx.Debug / Pods-xxxxxx.Release</code>ï¼ˆè¿™äº›å‚æ•°åœ¨æœªè®¾ç½®å‰åº”è¯¥æ˜¯ Noneï¼Œå¯èƒ½ CocoaPods åœ¨å®‰è£…ç¬¬ä¸‰æ–¹åº“æ—¶æ²¡æ­£ç¡®è®¾ç½®è¿™ä¸ªå‚æ•°ï¼‰ã€‚<br> é‡æ–°ç¼–è¯‘å·¥ç¨‹ï¼Œåº”è¯¥èƒ½æˆåŠŸäº†ã€‚</p>
<p><img src="/2020/09/04/%E7%94%B1%20Pod%20%E5%AF%BC%E8%87%B4%E7%9A%84File%20not%20found/1.png" alt></p>
<h6 id><a href="#" class="headerlink" title></a></h6>]]></content>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title>éšå¿</title>
    <url>/2021/01/06/%E9%9A%90%E5%BF%8D/</url>
    <content><![CDATA[<p>124 VS 3565</p>
<p>å¯èƒ½å‚»å­éƒ½çŸ¥é“ï¼Œå½“ç„¶é€‰æ‹© 3565 äº†ã€‚æ˜¯å§ã€‚</p>
<p>ä¸€ä»½ç¾å¥½çš„çˆ±ï¼Œåœ¨ä»Šå¤©ç»“æŸã€‚</p>
<p>ä¸€ä»½éšå¿çš„çˆ±ï¼Œåœ¨ä»Šå¤©å¼€å§‹ã€‚</p>
<p>å¸Œæœ›ä½ å¹¸ç¦ï¼Œçˆ±ç¬‘çš„æ±¤å…ˆç”Ÿã€‚</p>
]]></content>
      <tags>
        <tag>æˆ‘</tag>
      </tags>
  </entry>
  <entry>
    <title>iOSç¼–ç è§„èŒƒæ€»ç»“</title>
    <url>/2017/01/04/iOS%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/</url>
    <content><![CDATA[<h3 id="ä¸€ã€ç©ºæ ¼"><a href="#ä¸€ã€ç©ºæ ¼" class="headerlink" title="ä¸€ã€ç©ºæ ¼"></a>ä¸€ã€ç©ºæ ¼</h3><h4 id="åœ¨é€‚å½“çš„åœ°æ–¹ã€é€‚å½“åœ°åŠ ç©ºæ ¼ã€å¯ä»¥é€‚å½“åœ°æé«˜ä»£ç å¯è¯»æ€§"><a href="#åœ¨é€‚å½“çš„åœ°æ–¹ã€é€‚å½“åœ°åŠ ç©ºæ ¼ã€å¯ä»¥é€‚å½“åœ°æé«˜ä»£ç å¯è¯»æ€§" class="headerlink" title="åœ¨é€‚å½“çš„åœ°æ–¹ã€é€‚å½“åœ°åŠ ç©ºæ ¼ã€å¯ä»¥é€‚å½“åœ°æé«˜ä»£ç å¯è¯»æ€§"></a>åœ¨é€‚å½“çš„åœ°æ–¹ã€é€‚å½“åœ°åŠ ç©ºæ ¼ã€å¯ä»¥é€‚å½“åœ°æé«˜ä»£ç å¯è¯»æ€§</h4><p>ä½ ä¸€å®šè¯»è¿‡â€ç´§å‡‘å‹â€çš„ä»£ç ï¼Œä¸€ä¸ªå­—ç¬¦æŒ¨ç€ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœä¸æ˜¯ä¼šæŠ¥é”™ï¼Œå¯èƒ½ç±»åå’Œå˜é‡åä¹‹é—´éƒ½æ²¡æœ‰ç©ºæ ¼äº†ã€‚æˆ‘ä¹‹å‰è®¤ä¸ºåå•¬ç©ºæ ¼çš„äººæ˜¯ä¸æ˜¯éƒ½ç”Ÿæ´»çš„å¾ˆçº ç»“æˆ–è€…å¾ˆæ²¡æ¡ç†ï¼Œæ˜æ˜å¯ä»¥è±è¾¾ä¸€äº›ã€‚ä½†ç°åœ¨ä»–ä»¬æ”¹å˜äº†æˆ‘ï¼Œâ€è°åˆèƒ½çŸ¥é“å‘¢ï¼Œæ¯•ç«Ÿäººä¸èƒ½ä»è¡¨è±¡å°±èƒ½åˆ†æé€å½»ï¼Œä¹Ÿè®¸ä»–åªæ˜¯å•çº¯çš„    æ‡’   ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚â€œ</p>
<a id="more"></a>

<p>ä¸ºäº†é¿å…åšå®¢é£æ ¼å½±å“è§†è§‰ï¼Œç›´æ¥ä¸Šå›¾ç‰‡å§ã€‚å…¶å®æˆ‘ä¸çŸ¥é“æ˜¯ä¸æ˜¯æœ‰è¿™æ ·æ˜ç¡®çš„ç¼–ç è§„èŒƒï¼Œæˆ‘åªæ˜¯çœ‹è‹¹æœçš„æ€ä¹ˆå†™ï¼Œæˆ‘å°±æ€ä¹ˆå†™ï¼Œä¸‹é¢ä¹Ÿåªæ˜¯ä¸¾ä¸€äº›ç®€å•çš„ä¾‹å­ã€‚</p>
<p><img src="/2017/01/04/iOS%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83/1.png" alt></p>
<h3 id="äºŒã€è®¡æ—¶å™¨"><a href="#äºŒã€è®¡æ—¶å™¨" class="headerlink" title="äºŒã€è®¡æ—¶å™¨"></a>äºŒã€è®¡æ—¶å™¨</h3><h4 id="NSTimer-æ›¿æ¢ä¸ºdispatch-source-timer"><a href="#NSTimer-æ›¿æ¢ä¸ºdispatch-source-timer" class="headerlink" title="NSTimer æ›¿æ¢ä¸ºdispatch source timer"></a>NSTimer æ›¿æ¢ä¸ºdispatch source timer</h4><p>NSTimer åœ¨ä¸»çº¿ç¨‹çš„ Runloop é‡Œä¼šåœ¨ Runloop åˆ‡æ¢å…¶å®ƒæ¨¡å¼æ—¶åœæ­¢ï¼Œè¿™æ—¶å°±éœ€è¦æ‰‹åŠ¨åœ¨å­çº¿ç¨‹å¼€å¯ä¸€ä¸ªæ¨¡å¼ä¸º NSRunLoopCommonModes çš„ Runloopï¼Œå¹¶ä¸”é‡Šæ”¾ä¸åˆ°ä½ï¼Œä¼šå¯¼è‡´å¼•ç”¨ Timer çš„å¯¹è±¡ä¹Ÿå¾—ä¸åˆ°é‡Šæ”¾ã€‚ å¦‚æœä¸æƒ³å¼€å¯ä¸€ä¸ªæ–°çš„ Runloopï¼Œå¹¶ä¸”é¿å…å¼•ç”¨é—®é¢˜ï¼Œå¯ä»¥ç”¨ä¸è·Ÿ Runloop å…³è”çš„ dispatch source timerã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)createTimer &#123;</span><br><span class="line">    __block <span class="keyword">int</span> timeout = <span class="number">60</span>;</span><br><span class="line">    <span class="built_in">dispatch_queue_t</span> global = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>);</span><br><span class="line">    dispatch_source_t timer = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER, <span class="number">0</span>, <span class="number">0</span>, global);</span><br><span class="line">    </span><br><span class="line">    dispatch_source_set_timer(timer, DISPATCH_TIME_NOW, <span class="number">1.0</span> * <span class="built_in">NSEC_PER_SEC</span>, <span class="number">0</span> * <span class="built_in">NSEC_PER_SEC</span>);</span><br><span class="line">    dispatch_source_set_event_handler(timer, ^&#123;</span><br><span class="line">        timeout --;</span><br><span class="line">        <span class="keyword">if</span> (timeout &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            dispatch_source_cancel(timer);</span><br><span class="line">            <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">                <span class="comment">//do something after timer done.</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    dispatch_resume(timer);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ›´å¤šå…³äºGCDçš„ç”¨æ³•ï¼Œè¯·è§æˆ‘çš„å¦ä¸€ä¸ªæ€»ç»“<a href="https://atang1011.github.io/2016/01/13/GCD%EF%BC%88Grand%20Central%20Dispatch%EF%BC%89/">GCD (Grand Central Dispatch)</a> ã€‚</p>
<h3 id="ä¸‰ã€URLå­—ç¬¦ä¸²è§£æ"><a href="#ä¸‰ã€URLå­—ç¬¦ä¸²è§£æ" class="headerlink" title="ä¸‰ã€URLå­—ç¬¦ä¸²è§£æ"></a>ä¸‰ã€URLå­—ç¬¦ä¸²è§£æ</h3><h4 id="åˆ†æURLå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä½¿ç”¨-NSURLComponents-ç±»åšè§£æï¼Œä¸è¦é€šè¿‡å­—ç¬¦ä¸²æˆªå–ç­‰æ–¹å¼"><a href="#åˆ†æURLå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä½¿ç”¨-NSURLComponents-ç±»åšè§£æï¼Œä¸è¦é€šè¿‡å­—ç¬¦ä¸²æˆªå–ç­‰æ–¹å¼" class="headerlink" title="åˆ†æURLå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä½¿ç”¨ NSURLComponents ç±»åšè§£æï¼Œä¸è¦é€šè¿‡å­—ç¬¦ä¸²æˆªå–ç­‰æ–¹å¼"></a>åˆ†æURLå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä½¿ç”¨ NSURLComponents ç±»åšè§£æï¼Œä¸è¦é€šè¿‡å­—ç¬¦ä¸²æˆªå–ç­‰æ–¹å¼</h4><p>æˆ‘çœ‹å¾ˆå¤šäººçš„ä»£ç ï¼Œåœ¨è§£æåˆ«äººä¼ ç»™ä»–çš„URL å­—ç¬¦ä¸²æ—¶ï¼ˆä¾‹å¦‚è‡ªå·±çš„APPè¢«æ‹‰èµ·æ—¶ï¼‰ï¼Œéƒ½æ˜¯ä½¿ç”¨ <code>NSString</code> çš„å„ç§æˆªå–æ–¹æ³•ï¼Œç„¶åå†è‡ªå·±åšåˆ¤æ–­ï¼Œè¿™æ˜¯æœ‰ç‚¹â€å±é™©â€çš„åšæ³•ã€‚å¦‚æœä½ è‡ªä¿¡é€»è¾‘ä¸¥è°¨çš„è¯ï¼Œé‚£æ²¡çš„è¯´ï¼Œå¦‚æœä½ ä¸æ“…é•¿æˆ–è€…æ‡’å¾—åšå¼‚å¸¸å¤„ç†ï¼Œ <code>NSRange</code>  çš„ <code>location</code> å­˜ä¸å­˜åœ¨ä»¥åŠ <code>length</code> è¶Šç•Œé—®é¢˜ï¼Œå°±å¯ä»¥æŠŠç¨‹åºæcrashã€‚æ‰€ä»¥å»ºè®®ä¸è¦è¿™æ ·åšï¼Œä½¿ç”¨ <code>NSURLComponents</code> ã€‚æ–‡æ¡£<a href="https://developer.apple.com/documentation/foundation/nsurlcomponents" target="_blank" rel="noopener">NSURLComponents</a></p>
<p>çœ‹å®Œæ–‡æ¡£å°±ä¼šçŸ¥é“ï¼ŒçœŸçš„å¥½æ–¹ä¾¿ã€‚ã€‚ã€‚</p>
<ul>
<li>åˆå§‹åŒ–å°±ä¸å¤šè¯´äº†ï¼Œçœ‹è‡ªå·±éœ€è¦</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Initialize a NSURLComponents with all components undefined. Designated initializer.</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init;</span><br><span class="line">- (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)initWithURL:(<span class="built_in">NSURL</span> *)url resolvingAgainstBaseURL:(<span class="built_in">BOOL</span>)resolve;</span><br><span class="line">+ (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)componentsWithURL:(<span class="built_in">NSURL</span> *)url resolvingAgainstBaseURL:(<span class="built_in">BOOL</span>)resolve;</span><br><span class="line">- (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)initWithString:(<span class="built_in">NSString</span> *)URLString;</span><br><span class="line">+ (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)componentsWithString:(<span class="built_in">NSString</span> *)URLString;</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–URLé‡Œçš„å†…å®¹ï¼Œç®€ç›´ä¸è¦å¤ªæ–¹ä¾¿å“¦ï¼ŒURLEncodeä¹‹åçš„å‚æ•°éƒ½å‡†å¤‡å¥½äº†</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *scheme; <span class="comment">// Attempting to set the scheme with an invalid scheme string will cause an exception.</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *user;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *password;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *host;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSNumber</span> *port; <span class="comment">// Attempting to set a negative port number will cause an exception.</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *path;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *query;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *fragment;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *percentEncodedUser;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *percentEncodedPassword;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *percentEncodedHost;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *percentEncodedPath;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *percentEncodedQuery;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *percentEncodedFragment;</span><br><span class="line"></span><br><span class="line"><span class="comment">//begin ios 9.0</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSRange</span> rangeOfScheme;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSRange</span> rangeOfUser;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSRange</span> rangeOfPassword;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSRange</span> rangeOfHost;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSRange</span> rangeOfPort;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSRange</span> rangeOfPath;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSRange</span> rangeOfQuery;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSRange</span> rangeOfFragment;</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶å…³äº NSRange çš„è·å–ï¼Œæ˜¯ä»ios 9.0 å¼€å§‹æœ‰çš„ï¼Œé€‚é…ä½ç‰ˆæœ¬çš„è¯ï¼Œéœ€è¦æ³¨æ„ä¸€å“ˆã€‚</p>
<ul>
<li>å‚æ•°çš„é›†åˆï¼Œ<code>NSURLQueryItem</code> ç±»å‘¢å°±æ˜¯é€šè¿‡ key ã€value æ¥å–å‚æ•°ä»¬äº†</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">// API_AVAILABLE(macos(10.10), ios(8.0), watchos(2.0), tvos(9.0))</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSArray</span>&lt;<span class="built_in">NSURLQueryItem</span> *&gt; *queryItems;</span><br><span class="line"><span class="comment">// API_AVAILABLE(macosx(10.13), ios(11.0), watchos(4.0), tvos(11.0))</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSArray</span>&lt;<span class="built_in">NSURLQueryItem</span> *&gt; *percentEncodedQueryItems;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä¹‹å‰ä¸æ˜¯ç‰¹åˆ«ç†è§£ï¼Œå‚æ•°è¦ç”¨æ•°ç»„ï¼‹Itemçš„æ–¹å¼ï¼Œç›´åˆ°é‡åˆ°äº†é‚£ä½ç»™æˆ‘ä¼ çš„URLé‡Œï¼Œæœ‰ä¸¤ä¸ªåŒåå‚æ•°ä¸åŒå€¼çš„ä»å…„ï¼Œæˆ‘æ‰æ›´åŠ ä½“ä¼šåˆ°äº†è‹¹æœå¼€å‘è€…çš„ä¸¥è°¨ã€‚ã€‚ã€‚</p>
<h3 id="å››ã€-æšä¸¾"><a href="#å››ã€-æšä¸¾" class="headerlink" title="å››ã€ æšä¸¾"></a>å››ã€ æšä¸¾</h3><p>ä¸¾ä¸€ä¸ªç®€å•çš„åœºæ™¯ï¼šèŠå¤©è½¯ä»¶ï¼Œä¼šåŒºåˆ† å•èŠã€ç¾¤èŠã€èŠå¤©å®¤ã€æœåŠ¡å·ç­‰ç­‰ç­‰ç­‰ ä¸åŒç±»å‹çš„ä¼šè¯ï¼Œå¼€å‘æ—¶åœ¨åšé¡µé¢é—´ä¼ å€¼çš„æ—¶å€™ï¼Œå¾€å¾€éœ€è¦æŠŠç±»å‹ä¼ é€’ä¸‹å»æ¥åšä¸åŒçš„äº‹æƒ…ï¼Œæ€ä¹ˆæ˜ç¡®çš„ä¼ å‘¢ï¼Ÿå¦‚æœè¿™ä¸ªé¡¹ç›®æ˜¯å¤šäººè´Ÿè´£ï¼Œæ¯ä¸ªäººè´Ÿè´£ä¸åŒçš„æ¨¡å—ï¼Œåƒä¸‹é¢è¿™æ ·å†™ä»£ç ï¼Œæ—¶é—´ä¹…äº†è°ä¹Ÿçœ‹ä¸æ‡‚ï¼š</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//0å•èŠ,1ç¾¤èŠ</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">NSInteger</span> type;</span><br></pre></td></tr></table></figure>

<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">vc.type = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p>ä¸è¦ç¬‘ï¼Œä½ è‚¯å®šä¹Ÿå†™è¿‡è¿™æ ·çš„ä»£ç ï¼Œæ¨¡å—å¤šäº†ã€æ—¶é—´ä¹…äº†ï¼Œtype  æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸWho JB Know å•Šã€‚</p>
<p><strong>æšä¸¾å°±åœ¨è¿™ä¸ªæ—¶å€™å‘æŒ¥ä½œç”¨äº†ï¼šå¢åŠ ä»£ç å¯è¯»æ€§ã€‚</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSUInteger</span>, ConversationType) &#123;</span><br><span class="line">    <span class="comment">//å•èŠ</span></span><br><span class="line">    ConversationTypePRIVATE = <span class="number">1</span>,</span><br><span class="line">    <span class="comment">//ç¾¤ç»„</span></span><br><span class="line">    ConversationTypeGROUP = <span class="number">2</span>,</span><br><span class="line">    <span class="comment">//èŠå¤©å®¤</span></span><br><span class="line">    ConversationTypeCHATROOM = <span class="number">3</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·ä¸€æ¥æ¯”èµ·å•è–„çš„æ•°å­—ï¼Œæ˜¯ä¸æ˜¯æ›´è§åçŸ¥æ„äº†å‘¢ï¼Ÿè€Œä¸” OC ä¸­æšä¸¾å®šä¹‰å€¼çš„æ—¶å€™ï¼Œéƒ½æ˜¯ æšä¸¾å + å…·ä½“åˆ†ç±»ï¼Œä¾‹å¦‚æˆ‘ä»¬å†™çš„è¿™ä¸ªæšä¸¾ä¸­å•èŠçš„å®šä¹‰å°±æ˜¯  <code>ConversationType</code> + <code>PRIVATE</code> = <code>ConversationTypePRIVATE</code>ã€‚æ•²å‡ºæ¥çš„æ—¶å€™å¥½æ•²ï¼Œå“ˆå“ˆã€‚</p>
<p>æœ‰çš„åŒå­¦å¯èƒ½ä¼šé—®äº†ï¼Œåº”å¯¹ç±»å‹æ˜¯æ•´å‹çš„ type è¿™ä¸ªæšä¸¾æ˜¯å¤Ÿç”¨äº†ï¼Œé‚£ç”¨å­—ç¬¦ä¸²æ¥åˆ†ç±»çš„å‘¢ï¼Ÿæ²¡é”™ï¼Œè¿™æ˜¯ä¸ªé—®é¢˜ï¼Œå°¤å…¶æ˜¯å’ŒæœåŠ¡ç«¯å¯¹æ¥ä¹…äº†ï¼Œä½ ä¼šå‘ç°ï¼Œä»–ä»¬ä½¿ç”¨ å­—ç¬¦ä¸² å¤šè¿‡ æ•°å€¼ç±»å‹ã€‚ä¸æ€¥ï¼Œæˆ‘ä»¬æ¥å°æ¢ä¸€ä¸‹ OC ä¸­æšä¸¾éƒ½æ€ä¹ˆç”¨çš„ï¼š</p>
<h4 id="æ™®é€šæšä¸¾"><a href="#æ™®é€šæšä¸¾" class="headerlink" title="æ™®é€šæšä¸¾"></a>æ™®é€šæšä¸¾</h4><h5 id="1ã€C-è¯­è¨€çš„æšä¸¾å†™æ³•-enum"><a href="#1ã€C-è¯­è¨€çš„æšä¸¾å†™æ³•-enum" class="headerlink" title="1ã€C è¯­è¨€çš„æšä¸¾å†™æ³• enum"></a>1ã€C è¯­è¨€çš„æšä¸¾å†™æ³• enum</h5><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">enum</span>&#123;</span><br><span class="line">    ConversationTypePRIVATE = <span class="number">1</span>,</span><br><span class="line">    ConversationTypeGROUP = <span class="number">2</span>,</span><br><span class="line">    ConversationTypeCHATROOM = <span class="number">3</span>,</span><br><span class="line">&#125; ConversationType;</span><br></pre></td></tr></table></figure>

<h5 id="2ã€OC-æ•´å‹æšä¸¾"><a href="#2ã€OC-æ•´å‹æšä¸¾" class="headerlink" title="2ã€OC æ•´å‹æšä¸¾"></a>2ã€OC æ•´å‹æšä¸¾</h5><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSUInteger</span>, ConversationType) &#123;</span><br><span class="line">    <span class="comment">//å•èŠ</span></span><br><span class="line">    ConversationTypePRIVATE = <span class="number">1</span>,</span><br><span class="line">    <span class="comment">//ç¾¤ç»„</span></span><br><span class="line">    ConversationTypeGROUP = <span class="number">2</span>,</span><br><span class="line">    <span class="comment">//èŠå¤©å®¤</span></span><br><span class="line">    ConversationTypeCHATROOM = <span class="number">3</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="3ã€å­—ç¬¦ä¸²æšä¸¾å®ç°æ–¹æ¡ˆ"><a href="#3ã€å­—ç¬¦ä¸²æšä¸¾å®ç°æ–¹æ¡ˆ" class="headerlink" title="3ã€å­—ç¬¦ä¸²æšä¸¾å®ç°æ–¹æ¡ˆ"></a>3ã€å­—ç¬¦ä¸²æšä¸¾å®ç°æ–¹æ¡ˆ</h5><h6 id="1ã€åŸºäºæ™®é€šæšä¸¾ï¼ŒC-è¯­è¨€å®ç°"><a href="#1ã€åŸºäºæ™®é€šæšä¸¾ï¼ŒC-è¯­è¨€å®ç°" class="headerlink" title="1ã€åŸºäºæ™®é€šæšä¸¾ï¼ŒC è¯­è¨€å®ç°"></a>1ã€åŸºäºæ™®é€šæšä¸¾ï¼ŒC è¯­è¨€å®ç°</h6><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å…ˆå®šä¹‰ä¸€ä¸ªæ™®é€šçš„æ•´å‹æšä¸¾</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSUInteger</span>, ConversationType) &#123;</span><br><span class="line">    <span class="comment">//å•èŠ</span></span><br><span class="line">    ConversationTypePRIVATE = <span class="number">1</span>,</span><br><span class="line">    <span class="comment">//ç¾¤ç»„</span></span><br><span class="line">    ConversationTypeGROUP = <span class="number">2</span>,</span><br><span class="line">    <span class="comment">//èŠå¤©å®¤</span></span><br><span class="line">    ConversationTypeCHATROOM = <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å®ç°ä¸€ä¸ªæ–¹æ³•ï¼Œå®ç°é‡Œåš æ•´å‹ å’Œ å­—ç¬¦ä¸² çš„åŒ¹é…</span></span><br><span class="line"><span class="built_in">NSString</span> *ConversationTypeString(ConversationType status) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (status) &#123;</span><br><span class="line">        <span class="keyword">case</span> ConversationTypePRIVATE:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">@"private"</span>;</span><br><span class="line">        <span class="keyword">case</span> ConversationTypeGROUP:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">@"group"</span>;</span><br><span class="line">        <span class="keyword">case</span> ConversationTypeCHATROOM:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">@"chatroom"</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">@""</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ–è€…ä½¿ç”¨ ä¸€ä¸ª NSString * ç±»å‹çš„æ•°ç»„</span></span><br><span class="line"><span class="built_in">NSString</span> *ConversationTypeStringMap[] = &#123;</span><br><span class="line">    [ConversationTypePRIVATE] = <span class="string">@"private"</span>,</span><br><span class="line">    [ConversationTypeGROUP] = <span class="string">@"group"</span>,</span><br><span class="line">    [ConversationTypeCHATROOM] = <span class="string">@"chatroom"</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>ä½†è¿™ä¸¤ç§æ–¹å¼æœ‰ä¸€ä¸ªå¼Šç«¯ï¼Œå°±æ˜¯ä¸èƒ½åƒæšä¸¾ç±»å‹ä¸€æ ·ç›´æ¥ä½œä¸ºä¸€ä¸ªç±»å‹ é™å®šä¼ å‚çš„ç±»å‹ã€‚</strong></p>
<h6 id="2ã€å®å®šä¹‰"><a href="#2ã€å®å®šä¹‰" class="headerlink" title="2ã€å®å®šä¹‰"></a>2ã€å®å®šä¹‰</h6><p>åˆæœŸæˆ‘ä½¿ç”¨å®å®šä¹‰æ¯”è¾ƒå¤šï¼Œæ¯ä¸ªç±»å‹å€¼å®šä¹‰ä¸€ä¸ªå®ã€‚ã€‚ã€‚è¿™é‡Œä¸ä¸¾ä¾‹äº†ã€‚ã€‚ã€‚</p>
<h6 id="3ã€è‹¹æœå®˜æ–¹çš„åšæ³•"><a href="#3ã€è‹¹æœå®˜æ–¹çš„åšæ³•" class="headerlink" title="3ã€è‹¹æœå®˜æ–¹çš„åšæ³•"></a>3ã€è‹¹æœå®˜æ–¹çš„åšæ³•</h6><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//.h ä¸­ </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NSString</span> *ConversationTypeKey <span class="built_in">NS_STRING_ENUM</span>;</span><br><span class="line"></span><br><span class="line">FOUNDATION_EXPORT ConversationTypeKey <span class="keyword">const</span> ConversationTypeKeyPRIVATE;</span><br><span class="line">FOUNDATION_EXPORT ConversationTypeKey <span class="keyword">const</span> ConversationTypeKeyGROUP;</span><br><span class="line">FOUNDATION_EXPORT ConversationTypeKey <span class="keyword">const</span> ConversationTypeKeyCHATROOM;</span><br><span class="line"></span><br><span class="line"><span class="comment">//.m ä¸­ </span></span><br><span class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> ConversationTypeKeyPRIVATE = <span class="string">@"private"</span>;</span><br><span class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> ConversationTypeKeyGROUP = <span class="string">@"group"</span>;</span><br><span class="line"><span class="built_in">NSString</span> * <span class="keyword">const</span> ConversationTypeKeyCHATROOM = <span class="string">@"chatroom"</span>;</span><br></pre></td></tr></table></figure>

<p><strong>ç›¸æ¯”ä¼šäº§ç”Ÿè¿‡å¤šäºŒè¿›åˆ¶æ–‡ä»¶çš„å®å®šä¹‰æ–¹å¼, å»ºè®®ç”¨FOUNDATION_EXPORT</strong></p>
<h4 id="ä½ç§»æšä¸¾"><a href="#ä½ç§»æšä¸¾" class="headerlink" title="ä½ç§»æšä¸¾"></a>ä½ç§»æšä¸¾</h4><p>==</p>
]]></content>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
  <entry>
    <title>mailcore 2  iOS  ä¹‹ä¸€ IMAP</title>
    <url>/2018/02/02/mailcore2-iOS%E4%B9%8B%E4%B8%80IMAP/</url>
    <content><![CDATA[<p>å…¬å¸å¼€å‘oaä¸­çš„é‚®ç®±ï¼Œèµ„æºé™åˆ¶ï¼Œæœ€åiOSå¼€å‘é‡‡ç”¨çš„mailcore2-iosæ¡†æ¶ã€‚ç ”ç©¶çš„ä¸æ·±ï¼Œåªå½“åšä¸ªåˆ†äº«ï¼Œå£æ¡ä¸å¥½ï¼Œå‡‘åˆçœ‹å§ã€‚</p>
<h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><p>æˆ‘ç›´æ¥ç”¨çš„cocoapodsï¼Œéå¸¸æ–¹ä¾¿ï¼Œåªæ˜¯èµ„æºåŒ…å¤§äº†ä¸€ç‚¹ï¼Œè€å¿ƒç­‰å¾…å°±å¥½äº†ï¼Œå…¶ä»–æ–¹å¼æ²¡è¯•è¿‡ã€‚<br><code>pod &#39;mailcore2-ios&#39;</code></p>
<p><a href="https://github.com/MailCore/mailcore2" target="_blank" rel="noopener">https://github.com/MailCore/mailcore2</a> å®˜æ–¹ï¼Œæœ‰é—®é¢˜æissueï¼Œå¼€å‘è€…ä¼šå¾ˆçƒ­å¿ƒå›ç­”çš„ã€‚</p>
<a id="more"></a>

<h5 id="æ›´æ–°-çº é”™æ—¥å¿—"><a href="#æ›´æ–°-çº é”™æ—¥å¿—" class="headerlink" title="æ›´æ–°/çº é”™æ—¥å¿—"></a>æ›´æ–°/çº é”™æ—¥å¿—</h5><ul>
<li>2018-12-11 çº é”™ï¼šIMAP-4.å•å°é‚®ä»¶è·å–å’Œå¤„ç†.æ ¹æ®uidè·å–å•å°é‚®ä»¶ æœ‰è¯¯ï¼Œ<code>rangeçš„èŒƒå›´åº”è¯¥æ˜¯ï¼ˆuid, 0ï¼‰ï¼Œè€Œä¸æ˜¯(uid, 1)ï¼Œè¿™æ ·è·å–åˆ°çš„æ˜¯ä¸¤å°</code>ï¼Œè„‘å­ç§€é€—äº†ã€‚</li>
<li>2018-12-11 æ›´æ–°ï¼šåˆ›å»ºè‰ç¨¿é‚®ä»¶</li>
<li>2018-12-12 æ›´æ–°ï¼šSMTPåè®®</li>
</ul>
<h5 id="å¼€å‘"><a href="#å¼€å‘" class="headerlink" title="å¼€å‘"></a>å¼€å‘</h5><p>ä¸ªäººæ¯”è¾ƒå–œæ¬¢imapåè®®ï¼ŒåŠŸèƒ½æ¯”è¾ƒä¸°å¯Œï¼Œä¸è¿‡ç”¨mailcoreæèµ·æ¥ä¼¼ä¹è´¹åŠ²äº†ä¸€ç‚¹ï¼Œæˆ‘ä¹Ÿåªæ˜¯å®ç°äº†ä¸€äº›åŸºæœ¬åŠŸèƒ½ï¼Œé«˜çº§çš„è¿˜åœ¨ç ”ç©¶ã€‚</p>
<p>è®¡åˆ’åˆ†äº«ä¸€ä¸‹ä¸‹é¢å‡ é¡¹ğŸ¤—ğŸ¤—ğŸ¤—ğŸ¤—ğŸ¤—</p>
<ul>
<li>IMAP<ul>
<li>ç™»å½•</li>
<li>æ–‡ä»¶å¤¹åˆ—è¡¨ã€å‘½åç©ºé—´</li>
<li>é‚®ä»¶åˆ—è¡¨æ‹‰å–</li>
<li>é‚®ä»¶åˆ—è¡¨ä¸­å•å°é‚®ä»¶å†…å®¹è·å–å’Œå¤„ç†</li>
<li>é‚®ä»¶çš„å„ç§æ ‡è®°æ·»åŠ </li>
<li>åˆ é™¤é‚®ä»¶</li>
<li>é™„ä»¶å’Œhtmlå†…å®¹è§£æ</li>
<li>è‰ç¨¿ç®±é‚®ä»¶åˆ›å»º</li>
</ul>
</li>
<li>POP</li>
<li>SMTP<ul>
<li>è§<a href="https://atang1011.github.io/2018/12/12/mailcore2-iOSä¹‹äºŒSMTP/">mailcore2-ios  ä¹‹äºŒ SMTP</a></li>
</ul>
</li>
</ul>
<h5 id="IMAP"><a href="#IMAP" class="headerlink" title="IMAP"></a>IMAP</h5><h6 id="1-ç™»å½•"><a href="#1-ç™»å½•" class="headerlink" title="1.ç™»å½•"></a>1.ç™»å½•</h6><p>é¦–å…ˆè®¾ç½®è´¦å·ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯åˆ›å»ºsessionï¼›ç„¶åæ ¡éªŒï¼›</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">self</span>.imapSession.hostname = session.imapHost; <span class="comment">//imap.xxx.com.cn</span></span><br><span class="line"><span class="keyword">self</span>.imapSession.username = session.username; <span class="comment">//littlecat@xxx.com.cn</span></span><br><span class="line"><span class="keyword">self</span>.imapSession.password = session.password; <span class="comment">//password</span></span><br><span class="line"><span class="keyword">self</span>.imapSession.port     = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)session.imapPort;<span class="comment">//143ã€993</span></span><br><span class="line"><span class="keyword">self</span>.imapSession.connectionType = session.imapIsSSL ? MCOConnectionTypeTLS: MCOConnectionTypeClear;<span class="comment">//å–å†³äºä½ çš„é‚®ä»¶æœåŠ¡å™¨æ˜¯ä¸æ˜¯SSLçš„ï¼›</span></span><br></pre></td></tr></table></figure>

<p>æ ¡éªŒä¿¡æ¯ï¼š</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">MCOIMAPOperation *checkOp = [session checkAccountOperation];<span class="comment">//è¿™é‡Œçš„sessionå°±æ˜¯é…ç½®å¸å·ä¿¡æ¯çš„session</span></span><br><span class="line">[checkOp start:^(<span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">     <span class="built_in">NSLog</span>(<span class="string">@"finished checking account."</span>);</span><br><span class="line">     <span class="keyword">if</span> (error == <span class="literal">nil</span>) &#123;</span><br><span class="line">         complete(<span class="literal">nil</span>);</span><br><span class="line">     &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         err(error);</span><br><span class="line">         <span class="built_in">NSLog</span>(<span class="string">@"error loading account: %@"</span>, [error userInfo][<span class="string">@"NSLocalizedDescription"</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h6 id="2-è·å–æ–‡ä»¶å¤¹ç›®å½•"><a href="#2-è·å–æ–‡ä»¶å¤¹ç›®å½•" class="headerlink" title="2.è·å–æ–‡ä»¶å¤¹ç›®å½•"></a>2.è·å–æ–‡ä»¶å¤¹ç›®å½•</h6><p>å‘½åç©ºé—´ï¼šå®ƒè¿™é‡Œæœ‰ä¸ªnamespaceï¼Œå¯¹äº<code>ä¸­æ–‡åç§°</code>çš„ğŸ“‚åç§°ï¼Œéœ€è¦é€šè¿‡<code>å‘½åç©ºé—´</code>æ¥è§£æï¼Œ<code>ä¸ç„¶å¾ˆå¯èƒ½æ˜¯ğŸ‘‡è¿™ç§ä¹±ç </code>ï¼š</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿™æ˜¯å½“æ—¶è§£æç½‘æ˜“é‚®ç®±çš„ä¹±ç ï¼Œæ‰¾åŸå› æ‰¾äº†å¥½ä¹…ğŸ˜­ğŸ˜­ğŸ˜­ï¼Œåœ¨ä¸€ç¯‡åšå®¢ä¸Šçœ‹åˆ°çš„è§£å†³åŠæ³•ã€‚</span></span><br><span class="line">INBOX</span><br><span class="line">&amp;g0l6P3ux-</span><br><span class="line">&amp;XfJT0ZAB-</span><br><span class="line">&amp;XfJSIJZk-</span><br><span class="line">&amp;V4NXPpCuTvY-</span><br><span class="line">&amp;dcVr0mWHTvZZOQ-</span><br><span class="line">&amp;Xn9USpCuTvY-</span><br><span class="line">&amp;i6KWBZCuTvY-</span><br><span class="line">Deleted Messages</span><br><span class="line">Archive</span><br><span class="line">Junk</span><br></pre></td></tr></table></figure>

<p>å…ˆæŠŠæ­£ç¡®çš„æ”¾å‡ºæ¥ï¼Œæ‰¾å›ç‚¹èµ°ä¸‹å»çš„ä¿¡å¿ƒğŸ’”ğŸ’”ğŸ’—ğŸ’–â€¦</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">INBOX</span><br><span class="line">è‰ç¨¿ç®±</span><br><span class="line">å·²å‘é€</span><br><span class="line">å·²åˆ é™¤</span><br><span class="line">åƒåœ¾é‚®ä»¶</span><br><span class="line">ç—…æ¯’æ–‡ä»¶å¤¹</span><br><span class="line">å¹¿å‘Šé‚®ä»¶</span><br><span class="line">è®¢é˜…é‚®ä»¶</span><br><span class="line">Deleted Messages</span><br><span class="line">Archive</span><br><span class="line">Junk</span><br></pre></td></tr></table></figure>

<p>å› ä¸º<code>æŸäº›é‚®ç®±çš„sessionè«åå…¶å¦™æ²¡æœ‰è‡ªå¸¦é»˜è®¤çš„å‘½åç©ºé—´</code>ï¼Œæˆ‘é‡‡å–çš„ç¬¨åŠæ³•æ˜¯å…ˆå»è·å–ä¸€ä¸‹namespaceï¼Œä¸è¿‡å˜›ï¼Œï¼Œï¼Œå±…ç„¶è·å–åˆ°çš„ä¹Ÿæ—¶æœ‰æ—¶æ— ğŸ˜±ğŸ˜±ğŸ˜±ğŸ˜±ğŸ˜±</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">MCOIMAPSession *session = [MMIMAPTool getSession];</span><br><span class="line">MCOIMAPFetchNamespaceOperation * op = [session fetchNamespaceOperation];</span><br><span class="line">[op start:^(<span class="built_in">NSError</span> * __<span class="keyword">nullable</span> error, <span class="built_in">NSDictionary</span> * namespaces) &#123;</span><br><span class="line">     MCOIMAPNamespace * namespace = (session.defaultNamespace != <span class="literal">nil</span>) ? session.defaultNamespace : [namespaces objectForKey:MCOIMAPNamespacePersonal];</span><br><span class="line">    <span class="keyword">if</span> (!namespace) &#123;</span><br><span class="line">        <span class="comment">//æ²¡æœ‰å‘½åç©ºé—´ï¼Œå¾ˆå¯èƒ½æ–‡ä»¶å¤¹çš„åå­—è§£æå‡ºæ¥æ˜¯ä¹±ç ï¼Œè¿™ä¸ªçœ‹ä¸ªäººæ€ä¹ˆå¤„ç†å§ï¼›</span></span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¦‚æœæ‹¿åˆ°äº†namespaceï¼Œå¯ä»¥å®‰å¿ƒè·å–folderlistäº†</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p>å…³é”®çš„ä¸€å¥ï¼š<code>NSString *folername = [namespace componentsFromPath:f.path][0];</code></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">MCOIMAPFetchFoldersOperation * ops = [session fetchAllFoldersOperation];</span><br><span class="line">[ops start:^(<span class="built_in">NSError</span> * error,<span class="built_in">NSArray</span> *folders) &#123;</span><br><span class="line">   <span class="keyword">if</span> (error) &#123;</span><br><span class="line">      <span class="keyword">return</span> ;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="built_in">NSMutableDictionary</span> *dic = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line">   <span class="keyword">for</span> (MCOIMAPFolder *f <span class="keyword">in</span> folders) &#123;</span><br><span class="line">      <span class="built_in">NSString</span> *folername = [namespace componentsFromPath:f.path][<span class="number">0</span>];</span><br><span class="line">      [dic setValue:f.path forKey:folername];</span><br><span class="line">   &#125;</span><br><span class="line">  <span class="comment">//ç»§ç»­å…¶ä»–å¤„ç†ï¼›</span></span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p>è·å–æŸä¸ªæ–‡ä»¶å¤¹çš„mailæ•°ç›®ç­‰ä¿¡æ¯</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">MCOIMAPFolderInfoOperation *folderInfo = [session folderInfoOperation:foldername];</span><br><span class="line"></span><br><span class="line">[folderInfo start:^(<span class="built_in">NSError</span> *error, MCOIMAPFolderInfo *info) &#123;</span><br><span class="line">    <span class="keyword">if</span> (error) &#123;    </span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">     &#125;</span><br><span class="line">    complete(info.messageCount);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<h6 id="3-æ‹‰å–æŸä¸ªæ–‡ä»¶å¤¹é‚®ä»¶åˆ—è¡¨"><a href="#3-æ‹‰å–æŸä¸ªæ–‡ä»¶å¤¹é‚®ä»¶åˆ—è¡¨" class="headerlink" title="3.æ‹‰å–æŸä¸ªæ–‡ä»¶å¤¹é‚®ä»¶åˆ—è¡¨"></a>3.æ‹‰å–æŸä¸ªæ–‡ä»¶å¤¹é‚®ä»¶åˆ—è¡¨</h6><figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿™é‡Œçš„kindæˆ‘è§‰å¾—æ˜¯éœ€è¦æ‹‰å–çš„å†…å®¹ä»¬ï¼Œæˆ‘æ˜¯å‡ ä¹å¤§éƒ¨åˆ†éƒ½downäº†ï¼Œå¯ä»¥çœ‹æƒ…å†µè‡ªå·±é€‰æ‹©ï¼›</span></span><br><span class="line"><span class="comment">//æ‹‰å–èŒƒå›´ï¼Œï¼ˆ0ï¼ŒUINT64_MAXï¼‰å°±æ˜¯éƒ½æ‹‰å–äº†ï¼Œæˆ‘æ˜¯10æ¡10æ¡çš„æ¥çš„ã€‚</span></span><br><span class="line">MCOIMAPMessagesRequestKind requestKind = (MCOIMAPMessagesRequestKind)</span><br><span class="line">(MCOIMAPMessagesRequestKindHeaders |</span><br><span class="line"> MCOIMAPMessagesRequestKindStructure |</span><br><span class="line"> MCOIMAPMessagesRequestKindInternalDate|</span><br><span class="line"> MCOIMAPMessagesRequestKindHeaderSubject |</span><br><span class="line"> MCOIMAPMessagesRequestKindFlags);</span><br><span class="line"></span><br><span class="line">MCOIndexSet *uids = [MCOIndexSet indexSetWithRange:MCORangeMake(range.location, range.length)];<span class="comment">//rangeæ§åˆ¶æ‹‰å–çš„é‚®ä»¶çš„èŒƒå›´ï¼ŒUINT64_MAX</span></span><br><span class="line">MCOIMAPFetchMessagesOperation *op = [session fetchMessagesOperationWithFolder:foldername requestKind:requestKind uids:uids];</span><br><span class="line">[op start:^(<span class="built_in">NSError</span> * _Nullable error, <span class="built_in">NSArray</span> * _Nullable messages, MCOIndexSet * _Nullable vanishedMessages) &#123;</span><br><span class="line">     <span class="built_in">NSMutableArray</span> *listArr = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">     <span class="built_in">NSInteger</span> count = messages.count;</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i ++) &#123;</span><br><span class="line">            MCOIMAPMessage *msg = messages[i];</span><br><span class="line">            <span class="comment">//ä¸€å †å±æ€§ï¼Œè‡ªå·±æ‘˜å–å§ï¼Œå¤§å¤šæ˜¯headeré‡Œçš„ï¼Œä¸ºäº†æ˜¾ç¤ºé‚®ä»¶åˆ—è¡¨ï¼Œé‚®ä»¶å†…å®¹æ˜¯å¦å¤–å•ç‹¬è·å–çš„ï¼Œå­˜å‚¨ä¹Ÿåªæ˜¯å­˜å‚¨äº†åˆ—è¡¨ï¼›</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆæ‹äº†ä¸€æ¬¡é¡ºåºï¼Œå¥½åƒæœ‰ç‚¹è ¢ğŸ™„ğŸ™„ğŸ™„ğŸ™„ğŸ™„ã€‚ã€‚ã€‚æˆ‘æ˜¯æ ¹æ®uidæ’åºçš„ï¼Œç›®å‰è¿˜æ²¡å‘ç°ä¹±åºä»€ä¹ˆçš„</span></span><br><span class="line">    <span class="built_in">NSSortDescriptor</span> *sortDescriptor = [<span class="built_in">NSSortDescriptor</span> sortDescriptorWithKey:<span class="string">@"uid"</span> ascending:<span class="literal">NO</span>];</span><br><span class="line">    [listArr sortUsingDescriptors:[<span class="built_in">NSArray</span> arrayWithObject:sortDescriptor]];</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰å¦å¤–ä¸€ä¸ªæ–¹æ³•ï¼Œä½†æ˜¯å®åœ¨æ²¡å¤ªææ‡‚é‡Œé¢çš„numberå‚æ•°ï¼Œæ–‡æ¡£é‡Œè¯´sequence numberä¸èƒ½æ’åºç”¨ï¼Œæ‰€ä»¥æˆ‘æ²¡é€‰æ‹©è¿™ä¸ªæ–¹æ³•ï¼Œä¸»è¦æ˜¯æ²¡æ‡‚ğŸ‘ºğŸ‘ºğŸ‘ºğŸ‘ºğŸ‘ºğŸ‘ºğŸ‘º</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Returns an operation to fetch messages by (sequence) number.</span></span><br><span class="line">- (MCOIMAPFetchMessagesOperation *) fetchMessagesByNumberOperationWithFolder:(<span class="built_in">NSString</span> *)folder requestKind:(MCOIMAPMessagesRequestKind)requestKind numbers:(MCOIndexSet *)numbers;</span><br></pre></td></tr></table></figure>

<h6 id="4-å•å°é‚®ä»¶è·å–å’Œå¤„ç†"><a href="#4-å•å°é‚®ä»¶è·å–å’Œå¤„ç†" class="headerlink" title="4.å•å°é‚®ä»¶è·å–å’Œå¤„ç†"></a>4.å•å°é‚®ä»¶è·å–å’Œå¤„ç†</h6><ul>
<li><p>æ ¹æ®uidè·å–å•å°é‚®ä»¶</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å’Œè·å–é‚®ä»¶åˆ—è¡¨ä¸€æ ·ï¼Œä¸è¿‡rangeçš„é•¿åº¦æ˜¯0ï¼›</span></span><br><span class="line">MCOIndexSet *uids = [MCOIndexSet indexSetWithRange:MCORangeMake(uid, <span class="number">0</span>)];</span><br><span class="line"><span class="comment">//ä¹‹å‰å†™é”™äº†ï¼Œrangeé•¿åº¦åº”è¯¥æ˜¯0ï¼Œè€Œä¸æ˜¯1ï¼›</span></span><br><span class="line"><span class="comment">//MCOIndexSet *uids = [MCOIndexSet indexSetWithRange:MCORangeMake(uid, 1)];</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>è·å–é‚®ä»¶çº¯æ–‡æœ¬å†…å®¹ï¼ˆä¸åŒ…æ‹¬htmlæ ·å¼ç­‰ï¼‰</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     <span class="comment">//è¿™é‡Œæ˜¯åœ¨ä¸Šä¸€æ­¥è·å–å•ä¸ªé‚®ä»¶çš„å›è°ƒå†…è¿›è¡Œçš„</span></span><br><span class="line">     <span class="comment">//è¿™ä¸ªæ–¹æ³•æ˜¯è‡ªåŠ¨æŠŠæ–‡æœ¬ä¸­çš„ç©ºè¡Œä¹‹ç±»çš„å»æ‰äº†ï¼Œä¹Ÿæœ‰ä¸å»æ‰å’Œå¯é€‰æ˜¯å¦å»æ‰çš„æ–¹æ³•</span></span><br><span class="line">        MCOIMAPMessage *msg = [<span class="comment">//ä¸Šä¸€æ­¥çš„message];</span></span><br><span class="line">        MCOIMAPMessageRenderingOperation *  messageRenderingOperation = [session plainTextBodyRenderingOperationWithMessage:msg folder:foldername];</span><br><span class="line">        [messageRenderingOperation start:^(<span class="built_in">NSString</span> * plainTextBodyString,<span class="built_in">NSError</span> * error) &#123;</span><br><span class="line">            <span class="keyword">if</span> (error == <span class="literal">nil</span>) &#123;</span><br><span class="line">                complete(plainTextBodyString, msg);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"fetch plain text error:%@"</span>,error);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">æ–‡æ¡£é‡Œæ³¨é‡Šçš„ä¸èƒ½å†æ¸…æ¥šäº†ï¼Œè‡ªå·±æŸ¥é˜…å§ğŸ˜ˆğŸ˜ˆğŸ˜ˆğŸ˜ˆğŸ˜ˆ</span><br><span class="line"><span class="comment">//Returns an operation to render the plain text version of a message.</span></span><br><span class="line">- (MCOIMAPMessageRenderingOperation *) plainTextRenderingOperationWithMessage:(MCOIMAPMessage *)message folder:(<span class="built_in">NSString</span> *)folder;</span><br><span class="line"><span class="comment">// All end of line will be removed and white spaces cleaned up if requested.</span></span><br><span class="line">- (MCOIMAPMessageRenderingOperation *) plainTextBodyRenderingOperationWithMessage:(MCOIMAPMessage *)message folder:(<span class="built_in">NSString</span> *)folder stripWhitespace:(<span class="built_in">BOOL</span>)stripWhitespace;</span><br></pre></td></tr></table></figure>

<ul>
<li>è·å–htmlå†…å®¹ï¼Œæ”¾åœ¨ä¸€ä¸ªwebviewä¸­æ˜¾ç¤ºåŸºæœ¬å†…å®¹åº”è¯¥æ²¡é—®é¢˜äº†<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">MCOIMAPMessage *msg = [åŒæ ·æ˜¯ä¸Šä¸€æ­¥çš„message];</span><br><span class="line">MCOIMAPMessageRenderingOperation *  messageRenderingOperation = [session htmlBodyRenderingOperationWithMessage:msg folder:foldername];</span><br><span class="line">[messageRenderingOperation start:^(<span class="built_in">NSString</span> * _Nullable htmlString, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">     <span class="keyword">if</span> (error == <span class="literal">nil</span>) &#123;</span><br><span class="line">         complete(htmlString, msg);</span><br><span class="line">     &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">         <span class="built_in">NSLog</span>(<span class="string">@"fetch plain text error:%@"</span>,error);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h6 id="5-æ·»åŠ å„ç§æ ‡è®°"><a href="#5-æ·»åŠ å„ç§æ ‡è®°" class="headerlink" title="5.æ·»åŠ å„ç§æ ‡è®°"></a>5.æ·»åŠ å„ç§æ ‡è®°</h6><p>å·²è¯»æœªè¯»ï¼Œå°çº¢æ——æ ‡è®°ç­‰ç­‰ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>â€œkindâ€åŒºåˆ†æ˜¯æ·»åŠ æ ‡è®°è¿˜æ˜¯ç§»é™¤æ ‡è®°</code>ï¼Œä¾‹å¦‚å·²è¯»â€œMCOMessageFlagSeenâ€æ ‡è®°ï¼Œç§»é™¤å°±æˆäº†æœªè¯»ï¼Œ<code>æ²¡æœ‰â€œunseenâ€ä¹‹ç±»çš„ã€‚ã€‚ã€‚</code></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)setFlagged:(<span class="built_in">BOOL</span>)flagged message:(<span class="built_in">NSInteger</span>)uid folder:(<span class="built_in">NSString</span> *)folder &#123;</span><br><span class="line">    MCOIMAPSession *session = <span class="comment">//imap sessionï¼›</span></span><br><span class="line">    MCOIndexSet *uids = [MCOIndexSet indexSetWithIndex:uid];</span><br><span class="line">    MCOIMAPOperation *op = [session storeFlagsOperationWithFolder:folder</span><br><span class="line">                                                             uids:uids</span><br><span class="line">                                                             kind:(flagged ? MCOIMAPStoreFlagsRequestKindSet : MCOIMAPStoreFlagsRequestKindRemove)</span><br><span class="line">                                                            flags:MCOMessageFlagFlagged];</span><br><span class="line">    [op start:^(<span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"store star flag 's error: %@"</span>,error);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœè¦æ‰¹é‡è®¾ç½®æ ‡è®°ï¼Œuidså¯ä»¥é€šè¿‡rangeæ¥åˆ›å»º</span></span><br><span class="line">    MCOIndexSet *uids = [MCOIndexSet indexSetWithRange:MCORangeMake(range.location, range.length)];</span><br></pre></td></tr></table></figure>

<h6 id="6-åˆ é™¤é‚®ä»¶"><a href="#6-åˆ é™¤é‚®ä»¶" class="headerlink" title="6.åˆ é™¤é‚®ä»¶"></a>6.åˆ é™¤é‚®ä»¶</h6><p>ä¸ºä»€ä¹ˆå…ˆè¯´çš„æ ‡è®°é‚£éƒ¨åˆ†ï¼Œå› ä¸ºåˆ é™¤é‚®ä»¶ä¹Ÿæ˜¯æ·»åŠ â€œdeleteâ€æ ‡è®°ã€‚è¿™é‡Œéœ€è¦åšä¸€ä¸ªåŒºåˆ†ï¼Œ<code>è¦åˆ é™¤çš„é‚®ä»¶æ˜¯ä¸æ˜¯åœ¨ â€œå·²åˆ é™¤/è‰ç¨¿ç®±â€ è¿™ä¸¤ä¸ªæ–‡ä»¶å¤¹</code>ã€‚</p>
<p>ä¸»è¦æ“ä½œæœ‰ä¸‰ä¸ªï¼š</p>
<ul>
<li>1ã€copyä¸€ä»½åˆ°â€œå·²åˆ é™¤â€</li>
<li>2ã€è®¾ç½®åˆ é™¤æ ‡è®°</li>
<li>3ã€æ‰§è¡Œæ“¦é™¤expungeæ“ä½œ</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//**å¦‚æœæ˜¯ä¸åœ¨å·²åˆ é™¤ï¼Œè‰ç¨¿ç®±ï¼Œæ‰§è¡Œ1ã€2ã€3</span></span><br><span class="line"><span class="comment">//**å¦‚æœåœ¨ï¼Œåªæ‰§è¡Œ2ã€3</span></span><br><span class="line">    <span class="keyword">if</span> (![folder isEqualToString:deleteFolder] &amp;&amp; ![folder isEqualToString:draftFolder]) &#123;</span><br><span class="line">        <span class="comment">//copy ä¸€ä»½åˆ°å·²åˆ é™¤</span></span><br><span class="line">        MCOIMAPCopyMessagesOperation *op = [imapSession copyMessagesOperationWithFolder:folder</span><br><span class="line">                                                                                                    uids:[MCOIndexSet indexSetWithIndex:uid]</span><br><span class="line">                                                                                              destFolder:deleteFolder];</span><br><span class="line">        [op start:^(<span class="built_in">NSError</span> *error, <span class="built_in">NSDictionary</span> *uidMapping) &#123;</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@"Error copy message to folder:%@"</span>, error);</span><br><span class="line">            [<span class="keyword">self</span> unturnedDelete:uid folder:folder];</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">self</span> unturnedDelete:uid folder:folder];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)unturnedDelete:(<span class="built_in">NSInteger</span>)uid folder:(<span class="built_in">NSString</span> *)folder </span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//å…ˆæ·»åŠ åˆ é™¤flags</span></span><br><span class="line">    MCOIMAPOperation * op2 = [imapSession storeFlagsOperationWithFolder:folder</span><br><span class="line">                                                                                    uids:[MCOIndexSet indexSetWithIndex:uid]</span><br><span class="line">                                                                                    kind:MCOIMAPStoreFlagsRequestKindSet</span><br><span class="line">                                                                                   flags:MCOMessageFlagDeleted];</span><br><span class="line">    [op2 start:^(<span class="built_in">NSError</span> * error) &#123;</span><br><span class="line">        <span class="comment">//æ·»åŠ æˆåŠŸä¹‹åå¯¹å½“å‰æ–‡ä»¶å¤¹è¿›è¡Œexpungeæ“ä½œ</span></span><br><span class="line">        MCOIMAPOperation *deleteOp = [imapSession expungeOperation:folder];</span><br><span class="line">        [deleteOp start:^(<span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">            <span class="keyword">if</span>(error) &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"Error expunging folder:%@"</span>, error);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">NSLog</span>(<span class="string">@"Successfully expunged folder"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h6 id="7-é™„ä»¶å¤„ç†å’Œhtmlå†…å®¹è§£æ"><a href="#7-é™„ä»¶å¤„ç†å’Œhtmlå†…å®¹è§£æ" class="headerlink" title="7.é™„ä»¶å¤„ç†å’Œhtmlå†…å®¹è§£æ"></a>7.é™„ä»¶å¤„ç†å’Œhtmlå†…å®¹è§£æ</h6><ul>
<li><p>å®˜æ–¹demo<br><a href="https://github.com/MailCore/mailcore2/tree/master/example/ios/iOS%20UI%20Test/iOS%20UI%20Test" target="_blank" rel="noopener">https://github.com/MailCore/mailcore2/tree/master/example/ios/iOS%20UI%20Test/iOS%20UI%20Test</a><br>githubä¸Šä»–ä»¬æœ‰å†™ä¸€ä¸ªdemoï¼Œæˆ‘ç›´æ¥ç”¨äº†é‡Œé¢ä¸¤ä¸ªç±»ï¼ŒmessageViewåˆè‡ªå·±åŠ äº†äº›ä¹±ä¸ƒå…«ç³Ÿçš„é€»è¾‘ã€‚protocolæ–¹ä¾¿è§£æçš„ï¼Œå…·ä½“è®²è§£åç»­æ›´æ–°ã€‚<br><img src="/2018/02/02/mailcore2-iOS%E4%B9%8B%E4%B8%80IMAP/1.png" alt></p>
</li>
<li><p>MCOHTMLRendererIMAPDelegate<br>è¿™ä¸ªåè®®é‡Œé¢ï¼Œæä¾›äº†å¯ä»¥è‡ªä¸»è§£æé™„ä»¶ã€å›¾ç‰‡ã€htmlå†…å®¹ï¼Œä»¥åŠç®€å•ç»™å®šhtmlå±•ç¤ºæ ·å¼çš„æ–¹æ³•ã€‚å…ˆè´´å‡ºheaderã€æ­£æ–‡ã€é™„ä»¶ï¼Œæˆ‘è‡ªå·±å†™çš„ä¸€ä¸ªç®€å•å±•ç¤ºæ¨¡æ¿å§ï¼Œå†…å®¹å¤„ç†è¿™å—ä¸œè¥¿å¤ªå¤šäº†ï¼Œæ•´ç†ä¸€ä¸‹å†ç»§ç»­æ›´æ–°ã€‚<br><a href="https://github.com/zhengyatian/TemplateForMailCore2" target="_blank" rel="noopener">TemplateForAttachment.html</a><br><a href="https://github.com/zhengyatian/TemplateForMailCore2" target="_blank" rel="noopener">TemplateForMessage.html</a><br><a href="https://github.com/zhengyatian/TemplateForMailCore2" target="_blank" rel="noopener">TemplateForMainHeader.html</a></p>
</li>
</ul>
<h6 id="8-åˆ›å»ºè‰ç¨¿ç®±é‚®ä»¶"><a href="#8-åˆ›å»ºè‰ç¨¿ç®±é‚®ä»¶" class="headerlink" title="8.åˆ›å»ºè‰ç¨¿ç®±é‚®ä»¶"></a>8.åˆ›å»ºè‰ç¨¿ç®±é‚®ä»¶</h6><p>â€‹     â€œappendâ€ æ‹¼æ¥çš„æ¦‚å¿µï¼Œå¾€ä¸€ä¸ªæ–‡ä»¶å¤¹å†…æ·»åŠ é‚®ä»¶ï¼›</p>
<ul>
<li>1ã€æ–°å»ºä¸€å°æ–°é‚®ä»¶(SMTPä¸­è®²åˆ›å»ºé‚®ä»¶)</li>
<li>2ã€è·å–ä½ çš„è‰ç¨¿ç®±æ–‡ä»¶å¤¹åç§°</li>
<li>3ã€æ‰§è¡Œappendæ“ä½œ<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//è¿™é‡Œçš„dataå°±æ˜¯æ–°å»ºçš„é‚®ä»¶ï¼›</span></span><br><span class="line">- (<span class="keyword">void</span>)createDraft:(<span class="built_in">NSData</span> *)data block:(<span class="keyword">void</span>(^)(<span class="keyword">bool</span> success, uint32_t uid, <span class="built_in">NSString</span> *folder))block</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!imapSession ) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">NSString</span> *folder = <span class="string">@"Drafts"</span> <span class="comment">//è‰ç¨¿ç®± ,æˆ–è€…æ˜¯ä½ é‚®ç®±æœåŠ¡å™¨è§£æåˆ°çš„è‰ç¨¿ç®±æ–‡ä»¶å¤¹åç§°ï¼›</span></span><br><span class="line"></span><br><span class="line">    MCOIMAPAppendMessageOperation *op = [imapSession appendMessageOperationWithFolder:folder messageData:data flags:MCOMessageFlagDraft];</span><br><span class="line">    [op start:^(<span class="built_in">NSError</span> *error, uint32_t createdUID) &#123;</span><br><span class="line">        <span class="comment">//do your operation;</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"create Draft message :%@"</span>,@(createdUID));</span><br><span class="line"></span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>HTTP çš„ä¸€ç‚¹å„¿å°çŸ¥è¯†</title>
    <url>/2017/10/02/HTTP%20%E7%9A%84%E4%B8%80%E7%82%B9%E5%84%BF%E5%B0%8F%E7%9F%A5%E8%AF%86/</url>
    <content><![CDATA[<h2 id="HTTPè¯·æ±‚"><a href="#HTTPè¯·æ±‚" class="headerlink" title="HTTPè¯·æ±‚"></a>HTTPè¯·æ±‚</h2><h3 id="ä¸€ã€è¶…æ–‡æœ¬ä¼ è¾“åè®®-è¶…æ–‡æœ¬ä¼ è¾“åè®®-Hypertext-Transfer-Protocol"><a href="#ä¸€ã€è¶…æ–‡æœ¬ä¼ è¾“åè®®-è¶…æ–‡æœ¬ä¼ è¾“åè®®-Hypertext-Transfer-Protocol" class="headerlink" title="ä¸€ã€è¶…æ–‡æœ¬ä¼ è¾“åè®® è¶…æ–‡æœ¬ä¼ è¾“åè®®(Hypertext Transfer Protocol)"></a>ä¸€ã€è¶…æ–‡æœ¬ä¼ è¾“åè®® è¶…æ–‡æœ¬ä¼ è¾“åè®®(Hypertext Transfer Protocol)</h3><blockquote>
<p>httpåè®®è§„å®šäº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“æ ¼å¼ã€‚</p>
<p>httpåè®®æ˜¯åœ¨ç½‘ç»œå¼€å‘ä¸­æœ€å¸¸ç”¨çš„åè®®ï¼Œä¸ç®¡æ˜¯ç§»åŠ¨å®¢æˆ·ç«¯è¿˜æ˜¯PCç«¯,è®¿é—®ç½‘ç»œèµ„æºç»å¸¸ä½¿ç”¨httpåè®®ã€‚</p>
</blockquote>
<p>â€‹        <a id="more"></a></p>
<p>httpä¼˜ç‚¹:</p>
<ul>
<li><strong>ç®€å•å¿«é€Ÿ</strong>ï¼šhttpåè®®ç®€å•,é€šä¿¡é€Ÿåº¦å¾ˆå¿«.</li>
<li><strong>çµæ´»</strong>ï¼šhttpåè®®å…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®.</li>
<li>httpåè®®æ˜¯<strong>çŸ­è¿æ¥</strong>(éæŒç»­æ€§è¿æ¥) (TCP/IP  UDP/IP)ï¼šhttpåè®®é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„è¯·æ±‚ä½œå‡ºå“åº”åï¼Œé©¬ä¸Šæ–­å¼€è¿æ¥ï¼Œè¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚</li>
</ul>
<h3 id="äºŒã€-httpåè®®çš„ä½¿ç”¨"><a href="#äºŒã€-httpåè®®çš„ä½¿ç”¨" class="headerlink" title="äºŒã€ httpåè®®çš„ä½¿ç”¨"></a>äºŒã€ httpåè®®çš„ä½¿ç”¨</h3><ol>
<li><strong>è¯·æ±‚</strong>ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç´¢è¦æ•°æ®ã€‚</li>
</ol>
<p>â€‹        httpåè®®è§„å®šï¼šä¸€ä¸ªå®Œæ•´çš„httpè¯·æ±‚åŒ…å«<code>è¯·æ±‚è¡Œã€è¯·æ±‚å¤´ã€è¯·æ±‚ä½“</code>ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p>
<ul>
<li>è¯·æ±‚è¡Œ : åŒ…å«äº†è¯·æ±‚æ–¹æ³•ï¼Œè¯·æ±‚èµ„æºè·¯å¾„ï¼Œhttpåè®®ç‰ˆæœ¬ã€‚</li>
</ul>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/resources/images/</span> HTTP/1.1</span><br></pre></td></tr></table></figure>

<ul>
<li>è¯·æ±‚å¤´ï¼šåŒ…å«äº†å¯¹å®¢æˆ·ç«¯çš„ç¯å¢ƒæè¿°ï¼Œå®¢æˆ·ç«¯è¯·æ±‚çš„ä¸»æœºåœ°å€ç­‰ä¿¡æ¯ã€‚</li>
</ul>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">:</span><br><span class="line"><span class="attribute">Accept</span>: text/html // å®¢æˆ·ç«¯æ‰€èƒ½æ¥æ”¶çš„æ•°æ®ç±»å‹</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-cn // å®¢æˆ·ç«¯çš„è¯­è¨€ç¯å¢ƒ</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip // å®¢æˆ·ç«¯æ”¯æŒçš„æ•°æ®å‹ç¼©æ ¼å¼</span><br><span class="line"><span class="attribute">Host</span>: m.baidu.com // å®¢æˆ·ç«¯æƒ³è®¿é—®çš„æœåŠ¡å™¨ä¸»æœºåœ°å€</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:37.0) Gecko/20100101 Firefox/37.0// å®¢æˆ·ç«¯çš„ç±»å‹,å®¢æˆ·ç«¯çš„è½¯ä»¶ç¯å¢ƒ</span><br></pre></td></tr></table></figure>

<ul>
<li>è¯·æ±‚ä½“ï¼šå®¢æˆ·ç«¯å‘ç»™æœåŠ¡å™¨çš„å…·ä½“æ•°æ®ï¼Œæ¯”å¦‚æ–‡ä»¶/å›¾ç‰‡ç­‰ã€‚ </li>
</ul>
<ol start="2">
<li><strong>å“åº”</strong>ï¼šæœåŠ¡å™¨è¿”å›å®¢æˆ·ç«¯æƒ³è¦çš„æ•°æ®ã€‚</li>
</ol>
<p>â€‹        httpåè®®è§„å®šï¼šä¸€ä¸ªå®Œæ•´çš„httpå“åº”åŒ…å« <code>çŠ¶æ€è¡Œã€å“åº”å¤´ã€å®ä½“å†…å®¹</code> ä¸‰ä¸ªéƒ¨åˆ†ã€‚</p>
<ul>
<li>çŠ¶æ€è¡Œï¼šåŒ…å«äº†httpåè®®ç‰ˆæœ¬,çŠ¶æ€å—,çŠ¶æ€è‹±æ–‡åç§°ã€‚</li>
</ul>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">HTTP/1.1 <span class="number">200</span> OK</span><br></pre></td></tr></table></figure>

<ul>
<li>å“åº”å¤´ï¼šåŒ…å«äº†å¯¹æœåŠ¡å™¨çš„æè¿°,å¯¹è¿”å›æ•°æ®çš„æè¿°ã€‚    </li>
</ul>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">:</span><br><span class="line"><span class="attribute">Content-Encoding</span>: gzip // æœåŠ¡å™¨æ”¯æŒçš„æ•°æ®å‹ç¼©æ ¼å¼</span><br><span class="line"><span class="attribute">Content-Length</span>:  1528 // è¿”å›æ•°æ®çš„é•¿åº¦</span><br><span class="line"><span class="attribute">Content-Type</span>:  application/xhtml+xml;charset=utf-8// è¿”å›æ•°æ®çš„ç±»å‹</span><br><span class="line"><span class="attribute">Date</span>: Mon, 15 Jun 201509:06:46 GMT // å“åº”çš„æ—¶é—´</span><br><span class="line"><span class="attribute">Server</span>: apache  // æœåŠ¡å™¨ç±»å‹</span><br></pre></td></tr></table></figure>

<ul>
<li>å®ä½“å†…å®¹ï¼šæœåŠ¡å™¨è¿”å›ç»™å®¢æˆ·ç«¯çš„å…·ä½“æ•°æ®(å›¾ç‰‡/html/æ–‡ä»¶â€¦)ã€‚  </li>
</ul>
<ol start="3">
<li>å‘é€httpè¯·æ±‚</li>
</ol>
<p>â€‹        åœ¨iOSå¼€å‘ä¸­,å‘é€httpè¯·æ±‚çš„æ–¹æ¡ˆæœ‰å¾ˆå¤šï¼Œå¸¸è§çš„æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p>
<ul>
<li>è‹¹æœåŸç”Ÿ:</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSURLConnection</span>: ç”¨æ³•ç®€å•,å¤è€ç»å…¸çš„ä¸€ç§æ–¹æ¡ˆ.</span><br><span class="line"><span class="built_in">NSURLSession</span>: iOS7ä»¥åæ¨å‡ºçš„æŠ€æœ¯,åŠŸèƒ½æ¯”<span class="built_in">NSURLConnection</span>æ›´åŠ å¼ºå¤§.</span><br><span class="line"><span class="built_in">CFNetWork</span>: <span class="built_in">NSURL</span> çš„åº•å±‚,çº¯Cè¯­è¨€,ä¸€èˆ¬ä¸ç”¨.</span><br></pre></td></tr></table></figure>

<ul>
<li>ç¬¬ä¸‰æ–¹æ¡†æ¶:</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">ASIHttpRequest: httpç»ˆç»“è€…,åŠŸèƒ½å¾ˆå¼ºå¤§,å¯æƒœä½œè€…å·²åœæ­¢æ›´æ–°.</span><br><span class="line">AFNetWorking: ç®€å•æ˜“ç”¨,æä¾›äº†åŸºæœ¬å¤Ÿç”¨çš„å¸¸ç”¨åŠŸèƒ½,ç»´æŠ¤å’Œä½¿ç”¨è€…å¤š.</span><br><span class="line"><span class="built_in">MKNetWorkKit</span>: ç®€å•æ˜“ç”¨,äº§è‡ªå°åº¦,ç»´æŠ¤å’Œä½¿ç”¨è€…å°‘.</span><br></pre></td></tr></table></figure>

<p>â€‹      </p>
<h3 id="ä¸‰ã€æ–¹æ³•"><a href="#ä¸‰ã€æ–¹æ³•" class="headerlink" title="ä¸‰ã€æ–¹æ³•"></a>ä¸‰ã€æ–¹æ³•</h3><h4 id="1-httpæ–¹æ³•"><a href="#1-httpæ–¹æ³•" class="headerlink" title="1. httpæ–¹æ³•"></a>1. httpæ–¹æ³•</h4><p>â€‹    httpåè®®å®šä¹‰äº†å¾ˆå¤šæ–¹æ³•å¯¹åº”ä¸åŒçš„èµ„æºæ“ä½œ,å…¶ä¸­æœ€å¸¸ç”¨çš„æ˜¯GET å’Œ POST æ–¹æ³•.</p>
<blockquote>
<p>GETã€POSTã€OPTIONSã€HEADã€PUTã€DELETEã€TRACEã€CONNECTã€PATCH</p>
<p>å¢:PUT</p>
<p> åˆ :DELETE</p>
<p>æ”¹:POST</p>
<p>æŸ¥:GET    </p>
</blockquote>
<ul>
<li>OPTIONS</li>
</ul>
<p>è¿”å›æœåŠ¡å™¨é’ˆå¯¹ç‰¹å®šèµ„æºæ‰€æ”¯æŒçš„HTTPè¯·æ±‚æ–¹æ³•ã€‚ä¹Ÿå¯ä»¥åˆ©ç”¨å‘WebæœåŠ¡å™¨å‘é€â€™*â€™çš„è¯·æ±‚æ¥æµ‹è¯•æœåŠ¡å™¨çš„åŠŸèƒ½æ€§ã€‚</p>
<ul>
<li>HEAD</li>
</ul>
<p>å‘æœåŠ¡å™¨ç´¢è¦ä¸GETè¯·æ±‚ç›¸ä¸€è‡´çš„å“åº”ï¼Œåªä¸è¿‡å“åº”ä½“å°†ä¸ä¼šè¢«è¿”å›ã€‚è¿™ä¸€æ–¹æ³•å¯ä»¥åœ¨ä¸å¿…ä¼ è¾“æ•´ä¸ªå“åº”å†…å®¹çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è·å–åŒ…å«åœ¨å“åº”æ¶ˆæ¯å¤´ä¸­çš„å…ƒä¿¡æ¯ã€‚</p>
<ul>
<li>GET</li>
</ul>
<p>å‘ç‰¹å®šçš„èµ„æºå‘å‡ºè¯·æ±‚ã€‚æ³¨æ„ï¼šGETæ–¹æ³•ä¸åº”å½“è¢«ç”¨äºäº§ç”Ÿâ€œå‰¯ä½œç”¨â€çš„æ“ä½œä¸­ã€‚</p>
<ul>
<li>POST</li>
</ul>
<p>å‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„å»ºç«‹å’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚</p>
<ul>
<li>PUT</li>
</ul>
<p>å‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ å…¶æœ€æ–°å†…å®¹ã€‚</p>
<ul>
<li>DELETE</li>
</ul>
<p>è¯·æ±‚æœåŠ¡å™¨åˆ é™¤Request-URIæ‰€æ ‡è¯†çš„èµ„æºã€‚</p>
<ul>
<li>TRACE</li>
</ul>
<p>å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚</p>
<ul>
<li>CONNECT</li>
</ul>
<p>HTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚</p>
<p>â€‹       </p>
<h4 id="2-å‚æ•°"><a href="#2-å‚æ•°" class="headerlink" title="2. å‚æ•°"></a>2. å‚æ•°</h4><p>å› ä¸º GET å’Œ POST å¯ä»¥å®ç°ä¸Šè¿°æ‰€æœ‰æ“ä½œï¼Œæ‰€ä»¥ï¼Œåœ¨ç°å®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬åªè¦ä¼šç”¨GET å’Œ POST æ–¹æ³•å°±å¯ä»¥äº†ã€‚åœ¨ä¸æœåŠ¡å™¨äº¤äº’æ—¶ï¼Œæœ‰æ—¶å€™éœ€è¦ç»™æœåŠ¡å™¨å‘é€ä¸€äº›æ•°æ®ï¼Œæ¯”å¦‚ç™»å½•æ—¶éœ€è¦å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚</p>
<p><strong>å‚æ•°</strong>:å°±æ˜¯æŒ‡ä¼ é€’ç»™æœåŠ¡å™¨çš„å…·ä½“æ•°æ®.</p>
<h4 id="3-GET-å’Œ-POST-çš„ä¸»è¦åŒºåˆ«è¡¨ç°åœ¨å‚æ•°çš„ä¼ é€’ä¸Š"><a href="#3-GET-å’Œ-POST-çš„ä¸»è¦åŒºåˆ«è¡¨ç°åœ¨å‚æ•°çš„ä¼ é€’ä¸Š" class="headerlink" title="3. GET å’Œ POST çš„ä¸»è¦åŒºåˆ«è¡¨ç°åœ¨å‚æ•°çš„ä¼ é€’ä¸Š"></a>3. GET å’Œ POST çš„ä¸»è¦åŒºåˆ«è¡¨ç°åœ¨å‚æ•°çš„ä¼ é€’ä¸Š</h4><h6 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h6><p>â€‹    GETçš„æœ¬è´¨æ˜¯ä»æœåŠ¡å™¨å¾—åˆ°æ•°æ®ï¼Œæ•ˆç‡æ›´é«˜ï¼Œå¹¶ä¸”GETè¯·æ±‚å¯ä»¥è¢«ç¼“å­˜ã€‚</p>
<p>â€‹    æ³¨æ„ï¼šç½‘ç»œç¼“å­˜æ•°æ®ï¼Œä¿å­˜åœ¨SQLiteçš„æ•°æ®åº“ä¸­(è·¯å¾„ï¼šNSHomeDirectory())ã€‚</p>
<p>â€‹        æŸ¥çœ‹ç¼“å­˜æ•°æ®å‘½ä»¤è¡Œï¼š</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">cd æ–‡ä»¶ç›®å½•   (æ‰“å¼€æ–‡ä»¶ç›®å½•)</span><br><span class="line">ls   æŸ¥çœ‹å½“å‰æ–‡ä»¶ä¸‹ç›®å½•</span><br><span class="line">sqlite3 Cache.db   æ‰“å¼€æ•°æ®åº“</span><br><span class="line">.tables    æŸ¥çœ‹æ•°æ®åº“ä¸­çš„è¡¨å•</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> cfurl_cache_response;   æŸ¥çœ‹æœåŠ¡å™¨å“åº”ç¼“å­˜</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> cfurl_cache_receiver_data;   æŸ¥çœ‹æœåŠ¡å™¨è¿”å›çš„æ•°æ®ç¼“å­˜</span><br></pre></td></tr></table></figure>

<p>â€‹    åœ¨è¯·æ±‚ URL åé¢ä»¥ ? çš„å½¢å¼è·Ÿä¸Šå‘ç»™æœåŠ¡å™¨çš„å‚æ•°ï¼Œå‚æ•°ä»¥ â€œå‚æ•°åâ€=â€å‚æ•°å€¼â€ çš„å½¢å¼æ‹¼æ¥ï¼Œå¤šä¸ªå‚æ•°ä¹‹é—´ç”¨ &amp; åˆ†éš”ã€‚</p>
<p>â€‹    æ³¨æ„ï¼šGETçš„é•¿åº¦æ˜¯æœ‰é™åˆ¶çš„ï¼Œä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒçš„é•¿åº¦é™åˆ¶ï¼Œä¸€èˆ¬åœ¨2~8Kä¹‹é—´ã€‚         </p>
<h6 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h6><p>â€‹    POSTçš„æœ¬è´¨æ˜¯å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œä¹Ÿå¯ä»¥è·å¾—æœåŠ¡å™¨å¤„ç†ä¹‹åçš„ç»“æœï¼Œæ•ˆç‡ä¸å¦‚GETã€‚POSTè¯·æ±‚ä¸å¯ä»¥è¢«ç¼“å­˜ï¼Œæ¯æ¬¡åˆ·æ–°ä¹‹åéƒ½éœ€è¦é‡æ–°æäº¤è¡¨å•ã€‚å‘é€ç»™æœåŠ¡å™¨çš„å‚æ•°å…¨éƒ¨æ”¾åœ¨ <code>è¯·æ±‚ä½“</code> ä¸­ï¼Œç†è®ºä¸Šï¼ŒPOSTä¼ é€’çš„æ•°æ®é‡æ²¡æœ‰é™åˆ¶ã€‚</p>
<p>â€‹    æ³¨æ„ï¼šæ‰€æœ‰æ¶‰åŠåˆ°ç”¨æˆ·éšç§çš„æ•°æ®(å¯†ç /é“¶è¡Œå¡å·ç­‰â€¦)éƒ½è¦ç”¨POSTçš„æ–¹å¼ä¼ é€’ã€‚    </p>
<h4 id="4-æ³¨æ„-URLä¸­ä¸èƒ½å‡ºç°ç©ºæ ¼ä»¥åŠä¸­æ–‡ç­‰ç‰¹æ®Šç¬¦å·"><a href="#4-æ³¨æ„-URLä¸­ä¸èƒ½å‡ºç°ç©ºæ ¼ä»¥åŠä¸­æ–‡ç­‰ç‰¹æ®Šç¬¦å·" class="headerlink" title="4. æ³¨æ„:URLä¸­ä¸èƒ½å‡ºç°ç©ºæ ¼ä»¥åŠä¸­æ–‡ç­‰ç‰¹æ®Šç¬¦å·"></a>4. æ³¨æ„:URLä¸­ä¸èƒ½å‡ºç°ç©ºæ ¼ä»¥åŠä¸­æ–‡ç­‰ç‰¹æ®Šç¬¦å·</h4><ul>
<li><p>URLä¸­,æ‰€æœ‰çš„å­—ç¬¦éƒ½å¿…é¡»æ˜¯ ASCII ç </p>
</li>
<li><p>URLä¸­ä¸èƒ½å‡ºç°ä¸­æ–‡å’Œç‰¹æ®Šç¬¦å·(å¦‚ç©ºæ ¼)</p>
</li>
</ul>
<p>â€‹    æ‰€ä»¥ï¼Œå¦‚æœ URL ä¸­å‡ºç°äº†ä¸­æ–‡ï¼Œéœ€è¦æ·»åŠ ç™¾åˆ†å·è½¬ä¹‰ã€‚    </p>
<h2 id="URL-ä¸­-äº•å·ï¼ˆé”šç‚¹ï¼‰çš„ç”¨æ³•"><a href="#URL-ä¸­-äº•å·ï¼ˆé”šç‚¹ï¼‰çš„ç”¨æ³•" class="headerlink" title="URL ä¸­ # äº•å·ï¼ˆé”šç‚¹ï¼‰çš„ç”¨æ³•"></a>URL ä¸­ # äº•å·ï¼ˆé”šç‚¹ï¼‰çš„ç”¨æ³•</h2><p>â€‹       æˆ‘ä»¬ç»å¸¸ä½¿ç”¨URL å®šä½ï¼Œä¼ é€’å‚æ•°ç­‰åº”ç”¨ï¼Œæœ€ç»å¸¸ä½¿ç”¨çš„æ˜¯ï¼Ÿ é—®å·ï¼Œä¸€èˆ¬ä½œä¸ºå‚æ•°ä¼ é€’ï¼Œè€Œæˆ‘ä»¬åœ¨æ¥è§¦åˆ°å•é¡µå¼€å‘æ¨¡å¼çš„æ—¶å€™ä¼šæ¥è§¦åˆ°url ä¸­å¤§é‡# äº•å·çš„ä½¿ç”¨ï¼Œæœ‰æ—¶å€™ä¼šå¯¹è¿™ä¸‰ä¸ªå¸¸è§ç¬¦å·æœ‰äº›åˆ†ä¸æ¸…ï¼Œæä¸æ‡‚å…·ä½“å«ä¹‰ã€‚ </p>
<h3 id="æ¶µä¹‰"><a href="#æ¶µä¹‰" class="headerlink" title="# æ¶µä¹‰"></a># æ¶µä¹‰</h3><p> åœ¨url ä¸­ä½¿ç”¨# ä¾‹å¦‚  index.html#product  å«ä¹‰ä¸€èˆ¬æ˜¯å®šä½åˆ°æœ¬é¡µé¢çš„productä½ç½®ï¼Œæ‰€ä»¥# åœ¨url ä¸­ä¸€èˆ¬æ˜¯ä½œä¸ºé¡µé¢å®šä½ä½¿ç”¨ï¼Œé‚£ä¹ˆproduct åˆ°åº•æ˜¯ç”¨ä»€ä¹ˆå®šä½ </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">name</span>=<span class="string">"product"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"product"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸¤ç§æ–¹å¼éƒ½å¯ä»¥æŠŠæ»šåŠ¨æ¡å®šä½åˆ°é¡µé¢çš„å“åº”ä½ç½® </p>
<blockquote>
<p>Twitter åœ¨æ”¹ç‰ˆçš„æ—¶å€™æŠŠ æ”¹ç‰ˆå‰çš„ç”¨æˆ·ä¸»é¡µç½‘å€ä¸º<a href="http://twitter.com/usernameæ”¹ç‰ˆåï¼Œå°±å˜æˆäº†http://twitter.com/#!/username" target="_blank" rel="noopener">http://twitter.com/usernameæ”¹ç‰ˆåï¼Œå°±å˜æˆäº†http://twitter.com/#!/username</a> è¿™æ˜¯ä¸»æµç½‘ç«™ç¬¬ä¸€æ¬¡å°†â€#â€å¤§è§„æ¨¡ç”¨äºé‡è¦URLä¸­ã€‚è¿™è¡¨æ˜äº•å·ï¼ˆHashï¼‰çš„ä½œç”¨æ­£åœ¨è¢«é‡æ–°è®¤è¯† </p>
</blockquote>
<h3 id="ç‰¹æ€§1ï¼šHTTP-è¯·æ±‚ä¸­çš„ä½œç”¨"><a href="#ç‰¹æ€§1ï¼šHTTP-è¯·æ±‚ä¸­çš„ä½œç”¨" class="headerlink" title="ç‰¹æ€§1ï¼šHTTP è¯·æ±‚ä¸­çš„ä½œç”¨"></a>ç‰¹æ€§1ï¼šHTTP è¯·æ±‚ä¸­çš„ä½œç”¨</h3><p>â€‹    æ˜¯ç”¨æ¥æŒ‡å¯¼æµè§ˆå™¨åŠ¨ä½œçš„ï¼Œå¯¹æœåŠ¡å™¨ç«¯å®Œå…¨æ— ç”¨ã€‚æ‰€ä»¥ï¼ŒHTTPè¯·æ±‚ä¸­ä¸åŒ…æ‹¬#ã€‚</p>
<p>â€‹    æ¯”å¦‚ï¼Œè®¿é—®ä¸‹é¢çš„ç½‘å€ï¼Œ<a href="http://www.example.com/index.html#printï¼Œæµè§ˆå™¨å®é™…å‘å‡ºçš„è¯·æ±‚æ˜¯è¿™æ ·çš„ï¼š" target="_blank" rel="noopener">http://www.example.com/index.html#printï¼Œæµè§ˆå™¨å®é™…å‘å‡ºçš„è¯·æ±‚æ˜¯è¿™æ ·çš„ï¼š</a></p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">GET /index.html HTTP/1.1 </span><br><span class="line"><span class="attribute">Host</span>: www.example.com</span><br></pre></td></tr></table></figure>

<pre><code>åœ¨ç¬¬ä¸€ä¸ª#åé¢å‡ºç°çš„ä»»ä½•å­—ç¬¦ï¼Œéƒ½ä¼šè¢«æµè§ˆå™¨è§£è¯»ä¸ºä½ç½®æ ‡è¯†ç¬¦ã€‚è¿™æ„å‘³ç€ï¼Œè¿™äº›å­—ç¬¦éƒ½ä¸ä¼šè¢«å‘é€åˆ°æœåŠ¡å™¨ç«¯ã€‚</code></pre><p>â€‹    æ¯”å¦‚ï¼Œä¸‹é¢URLçš„åŸæ„æ˜¯æŒ‡å®šä¸€ä¸ªé¢œè‰²å€¼ï¼š<a href="http://www.example.com/?color=#fffï¼Œä½†æ˜¯ï¼Œæµè§ˆå™¨å®é™…å‘å‡ºçš„è¯·æ±‚æ˜¯ï¼š" target="_blank" rel="noopener">http://www.example.com/?color=#fffï¼Œä½†æ˜¯ï¼Œæµè§ˆå™¨å®é™…å‘å‡ºçš„è¯·æ±‚æ˜¯ï¼š</a></p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">GET /?color= HTTP/1.1 </span><br><span class="line"><span class="attribute">Host</span>: www.example.com</span><br></pre></td></tr></table></figure>



<h3 id="ç‰¹æ€§2ï¼šæ”¹ç‰ˆ-ä¸ä¼šå¯¼è‡´ç½‘é¡µé‡è½½"><a href="#ç‰¹æ€§2ï¼šæ”¹ç‰ˆ-ä¸ä¼šå¯¼è‡´ç½‘é¡µé‡è½½" class="headerlink" title="ç‰¹æ€§2ï¼šæ”¹ç‰ˆ#ä¸ä¼šå¯¼è‡´ç½‘é¡µé‡è½½"></a>ç‰¹æ€§2ï¼šæ”¹ç‰ˆ#ä¸ä¼šå¯¼è‡´ç½‘é¡µé‡è½½</h3><p>â€‹    å•å•æ”¹å˜#åçš„éƒ¨åˆ†ï¼Œæµè§ˆå™¨åªä¼šæ»šåŠ¨åˆ°ç›¸åº”ä½ç½®ï¼Œä¸ä¼šé‡æ–°åŠ è½½ç½‘é¡µã€‚</p>
<p>â€‹    æ¯”å¦‚ï¼Œä»<a href="http://www.example.com/index.html#location1æ”¹æˆhttp://www.example.com/index.html#location2ï¼Œæµè§ˆå™¨ä¸ä¼šé‡æ–°å‘æœåŠ¡å™¨è¯·æ±‚index.htmlã€‚" target="_blank" rel="noopener">http://www.example.com/index.html#location1æ”¹æˆhttp://www.example.com/index.html#location2ï¼Œæµè§ˆå™¨ä¸ä¼šé‡æ–°å‘æœåŠ¡å™¨è¯·æ±‚index.htmlã€‚</a></p>
<h3 id="ç‰¹æ€§3ï¼šæ”¹ç‰ˆ-åå¯¹history-èŒƒå›´å†å²çš„å½±å“"><a href="#ç‰¹æ€§3ï¼šæ”¹ç‰ˆ-åå¯¹history-èŒƒå›´å†å²çš„å½±å“" class="headerlink" title="ç‰¹æ€§3ï¼šæ”¹ç‰ˆ# åå¯¹history èŒƒå›´å†å²çš„å½±å“"></a>ç‰¹æ€§3ï¼šæ”¹ç‰ˆ# åå¯¹history èŒƒå›´å†å²çš„å½±å“</h3><p>â€‹    æ¯ä¸€æ¬¡æ”¹å˜#åçš„éƒ¨åˆ†ï¼Œéƒ½ä¼šåœ¨æµè§ˆå™¨çš„è®¿é—®å†å²ä¸­å¢åŠ ä¸€ä¸ªè®°å½•ï¼Œä½¿ç”¨â€åé€€â€æŒ‰é’®ï¼Œå°±å¯ä»¥å›åˆ°ä¸Šä¸€ä¸ªä½ç½®ã€‚è¿™å¯¹äºajaxåº”ç”¨ç¨‹åºç‰¹åˆ«æœ‰ç”¨ï¼Œå¯ä»¥ç”¨ä¸åŒçš„#å€¼ï¼Œè¡¨ç¤ºä¸åŒçš„è®¿é—®çŠ¶æ€ï¼Œç„¶åå‘ç”¨æˆ·ç»™å‡ºå¯ä»¥è®¿é—®æŸä¸ªçŠ¶æ€çš„é“¾æ¥ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°è§„åˆ™å¯¹IE 6å’ŒIE 7ä¸æˆç«‹ï¼Œå®ƒä»¬ä¸ä¼šå› ä¸º#çš„æ”¹å˜è€Œå¢åŠ å†å²è®°å½•ã€‚</p>
<p>â€‹    é‰´äºç‰¹æ€§2ã€3 å®ç°äº†åœ¨å•é¡µä¸‹view çš„è·¯ç”±å’Œå†å²å›é€€ï¼Œç›®å‰h5æ‰‹æœºå¼€å‘æ‰€é‡‡ç”¨çš„å•é¡µæ¨¡å¼çš„åŸºç¡€ã€‚</p>
<h3 id="ç‰¹æ€§4ï¼šwindow-location-hashè¯»å–-å€¼"><a href="#ç‰¹æ€§4ï¼šwindow-location-hashè¯»å–-å€¼" class="headerlink" title="ç‰¹æ€§4ï¼šwindow.location.hashè¯»å–#å€¼"></a>ç‰¹æ€§4ï¼šwindow.location.hashè¯»å–#å€¼</h3><pre><code>window.location.hash è¿™ä¸ªå±æ€§å¯è¯»å¯å†™ã€‚è¯»å–æ—¶ï¼Œå¯ä»¥ç”¨æ¥åˆ¤æ–­ç½‘é¡µçŠ¶æ€æ˜¯å¦æ”¹å˜ï¼›å†™å…¥æ—¶ï¼Œåˆ™ä¼šåœ¨ä¸é‡è½½ç½‘é¡µçš„å‰æä¸‹ï¼Œåˆ›é€ ä¸€æ¡è®¿é—®å†å²è®°å½•ã€‚</code></pre><h3 id="ç‰¹æ€§5ï¼šonhashchangeäº‹ä»¶-H5æ–°å¢"><a href="#ç‰¹æ€§5ï¼šonhashchangeäº‹ä»¶-H5æ–°å¢" class="headerlink" title="ç‰¹æ€§5ï¼šonhashchangeäº‹ä»¶ H5æ–°å¢"></a>ç‰¹æ€§5ï¼šonhashchangeäº‹ä»¶ H5æ–°å¢</h3><p>â€‹    è¿™æ˜¯ä¸€ä¸ªHTML 5æ–°å¢çš„äº‹ä»¶ï¼Œå½“#å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªäº‹ä»¶ã€‚IE8+ã€Firefox 3.6+ã€Chrome 5+ã€Safari 4.0+æ”¯æŒè¯¥äº‹ä»¶ã€‚</p>
<p>ã€€ã€€å®ƒçš„ä½¿ç”¨æ–¹æ³•æœ‰ä¸‰ç§ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">window.onhashchange = func; </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onhashchange</span>=<span class="string">"func();"</span>&gt;</span> </span><br><span class="line">window.addEventListener("hashchange"ï¼Œ func, false);</span><br></pre></td></tr></table></figure>



<p>å¯¹äºä¸æ”¯æŒonhashchangeçš„æµè§ˆå™¨ï¼Œå¯ä»¥ç”¨setIntervalç›‘æ§location.hashçš„å˜åŒ–ã€‚</p>
<h3 id="ç‰¹æ€§6ï¼šGoogleæŠ“å–-çš„æœºåˆ¶"><a href="#ç‰¹æ€§6ï¼šGoogleæŠ“å–-çš„æœºåˆ¶" class="headerlink" title="ç‰¹æ€§6ï¼šGoogleæŠ“å–#çš„æœºåˆ¶"></a>ç‰¹æ€§6ï¼šGoogleæŠ“å–#çš„æœºåˆ¶</h3><p>â€‹    é»˜è®¤æƒ…å†µä¸‹ï¼ŒGoogleçš„ç½‘ç»œèœ˜è››å¿½è§†URLçš„#éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼ŒGoogleè¿˜è§„å®šï¼Œå¦‚æœä½ å¸Œæœ›Ajaxç”Ÿæˆçš„å†…å®¹è¢«æµè§ˆå¼•æ“è¯»å–ï¼Œé‚£ä¹ˆURLä¸­å¯ä»¥ä½¿ç”¨â€#!â€ï¼ŒGoogleä¼šè‡ªåŠ¨å°†å…¶åé¢çš„å†…å®¹è½¬æˆæŸ¥è¯¢å­—ç¬¦ä¸²escaped_fragmentçš„å€¼ã€‚</p>
<p>ã€€ã€€æ¯”å¦‚ï¼ŒGoogleå‘ç°æ–°ç‰ˆTwitterçš„URLï¼š<a href="http://twitter.com/#!/username" target="_blank" rel="noopener">http://twitter.com/#!/username</a></p>
<p>ã€€ã€€å°±ä¼šè‡ªåŠ¨æŠ“å–å¦ä¸€ä¸ªURLï¼š<a href="http://twitter.com/?escaped_fragment=/username" target="_blank" rel="noopener">http://twitter.com/?escaped_fragment=/username</a> </p>
<p>ã€€ã€€é€šè¿‡è¿™ç§æœºåˆ¶ï¼ŒGoogleå°±å¯ä»¥ç´¢å¼•åŠ¨æ€çš„Ajaxå†…å®¹ã€‚</p>
<p>ç¾¤è®¨è®ºï¼š</p>
<p>URLä¸­çš„#åªæ˜¯ä½œä¸ºä¸€ä¸ªåˆ†è§£ç¬¦ï¼Œ#åé¢çš„å†…å®¹ï¼ŒæœåŠ¡å™¨ä¸ä¼šå¤„ç†ï¼Œä½†æ˜¯æµè§ˆå™¨é¡µé¢èƒ½è·å–åˆ°ï¼Œä½†æ˜¯æ‹¿åˆ°è¿™ä¸ªå€¼å¹²å•¥ç”¨ï¼Œå°±çœ‹æ€ä¹ˆå¤„ç†äº†ï¼Œæ¯”å¦‚ç°åœ¨H5åšçš„SPAï¼Œå°±æ˜¯é #åé¢çš„å†…å®¹ä½œä¸ºå‚æ•°ï¼Œæ¥å¤„ç†å‰ç«¯è·¯ç”±ã€‚</p>
<h2 id="ç½‘ç»œç›¸åº”çš„å¸¸è§çŠ¶æ€"><a href="#ç½‘ç»œç›¸åº”çš„å¸¸è§çŠ¶æ€" class="headerlink" title="ç½‘ç»œç›¸åº”çš„å¸¸è§çŠ¶æ€"></a>ç½‘ç»œç›¸åº”çš„å¸¸è§çŠ¶æ€</h2><h3 id="1xxæ¶ˆæ¯"><a href="#1xxæ¶ˆæ¯" class="headerlink" title="1xxæ¶ˆæ¯"></a>1xxæ¶ˆæ¯</h3><p>â€‹    è¿™ä¸€ç±»å‹çš„çŠ¶æ€ç ï¼Œä»£è¡¨è¯·æ±‚å·²è¢«æ¥å—ï¼Œéœ€è¦ç»§ç»­å¤„ç†ã€‚è¿™ç±»å“åº”æ˜¯ä¸´æ—¶å“åº”ï¼ŒåªåŒ…å«çŠ¶æ€è¡Œå’ŒæŸäº›å¯é€‰çš„å“åº”å¤´ä¿¡æ¯ï¼Œå¹¶ä»¥ç©ºè¡Œç»“æŸã€‚ç”±äºHTTP/1.0åè®®ä¸­æ²¡æœ‰å®šä¹‰ä»»ä½•1xxçŠ¶æ€ç ï¼Œæ‰€ä»¥é™¤éåœ¨æŸäº›è¯•éªŒæ¡ä»¶ä¸‹ï¼ŒæœåŠ¡å™¨ç¦æ­¢å‘æ­¤ç±»å®¢æˆ·ç«¯å‘é€1xxå“åº”ã€‚è¿™äº›çŠ¶æ€ç ä»£è¡¨çš„å“åº”éƒ½æ˜¯ä¿¡æ¯æ€§çš„ï¼Œæ ‡ç¤ºå®¢æˆ·åº”è¯¥é‡‡å–çš„å…¶ä»–è¡ŒåŠ¨ã€‚</p>
<h4 id="100-Continue"><a href="#100-Continue" class="headerlink" title="100 Continue"></a>100 Continue</h4><p>â€‹    å®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘é€è¯·æ±‚ã€‚è¿™ä¸ªä¸´æ—¶å“åº”æ˜¯ç”¨æ¥é€šçŸ¥å®¢æˆ·ç«¯å®ƒçš„éƒ¨åˆ†è¯·æ±‚å·²ç»è¢«æœåŠ¡å™¨æ¥æ”¶ï¼Œä¸”ä»æœªè¢«æ‹’ç»ã€‚å®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘é€è¯·æ±‚çš„å‰©ä½™éƒ¨åˆ†ï¼Œæˆ–è€…å¦‚æœè¯·æ±‚å·²ç»å®Œæˆï¼Œå¿½ç•¥è¿™ä¸ªå“åº”ã€‚æœåŠ¡å™¨å¿…é¡»åœ¨è¯·æ±‚å®Œæˆåå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªæœ€ç»ˆå“åº”ã€‚</p>
<h4 id="101-Switching-Protocols"><a href="#101-Switching-Protocols" class="headerlink" title="101 Switching Protocols"></a>101 Switching Protocols</h4><p>â€‹    æœåŠ¡å™¨å·²ç»ç†è§£äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†é€šè¿‡Upgradeæ¶ˆæ¯å¤´é€šçŸ¥å®¢æˆ·ç«¯é‡‡ç”¨ä¸åŒçš„åè®®æ¥å®Œæˆè¿™ä¸ªè¯·æ±‚ã€‚åœ¨å‘é€å®Œè¿™ä¸ªå“åº”æœ€åçš„ç©ºè¡Œåï¼ŒæœåŠ¡å™¨å°†ä¼šåˆ‡æ¢åˆ°åœ¨Upgradeæ¶ˆæ¯å¤´ä¸­å®šä¹‰çš„é‚£äº›åè®®ã€‚: åªæœ‰åœ¨åˆ‡æ¢æ–°çš„åè®®æ›´æœ‰å¥½å¤„çš„æ—¶å€™æ‰åº”è¯¥é‡‡å–ç±»ä¼¼æªæ–½ã€‚ä¾‹å¦‚ï¼Œåˆ‡æ¢åˆ°æ–°çš„HTTPç‰ˆæœ¬æ¯”æ—§ç‰ˆæœ¬æ›´æœ‰ä¼˜åŠ¿ï¼Œæˆ–è€…åˆ‡æ¢åˆ°ä¸€ä¸ªå®æ—¶ä¸”åŒæ­¥çš„åè®®ä»¥ä¼ é€åˆ©ç”¨æ­¤ç±»ç‰¹æ€§çš„èµ„æºã€‚</p>
<h4 id="102-Processing"><a href="#102-Processing" class="headerlink" title="102 Processing"></a>102 Processing</h4><p>â€‹    ç”±WebDAVï¼ˆRFC 2518ï¼‰æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨å¤„ç†å°†è¢«ç»§ç»­æ‰§è¡Œã€‚</p>
<h3 id="2xxæˆåŠŸ"><a href="#2xxæˆåŠŸ" class="headerlink" title="2xxæˆåŠŸ"></a>2xxæˆåŠŸ</h3><p>â€‹    è¿™ä¸€ç±»å‹çš„çŠ¶æ€ç ï¼Œä»£è¡¨è¯·æ±‚å·²æˆåŠŸè¢«æœåŠ¡å™¨æ¥æ”¶ã€ç†è§£ã€å¹¶æ¥å—ã€‚</p>
<h4 id="200-OK"><a href="#200-OK" class="headerlink" title="200 OK"></a>200 OK</h4><p>â€‹    è¯·æ±‚å·²æˆåŠŸï¼Œè¯·æ±‚æ‰€å¸Œæœ›çš„å“åº”å¤´æˆ–æ•°æ®ä½“å°†éšæ­¤å“åº”è¿”å›ã€‚</p>
<h4 id="201-Created"><a href="#201-Created" class="headerlink" title="201 Created"></a>201 Created</h4><p>â€‹    è¯·æ±‚å·²ç»è¢«å®ç°ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªæ–°çš„èµ„æºå·²ç»ä¾æ®è¯·æ±‚çš„éœ€è¦è€Œåˆ›å»ºï¼Œä¸”å…¶URIå·²ç»éšLocationå¤´ä¿¡æ¯è¿”å›ã€‚å‡å¦‚éœ€è¦çš„èµ„æºæ— æ³•åŠæ—¶åˆ›å»ºçš„è¯ï¼Œåº”å½“è¿”å›â€™202 Acceptedâ€™ã€‚</p>
<h4 id="202-Accepted"><a href="#202-Accepted" class="headerlink" title="202 Accepted"></a>202 Accepted</h4><p>â€‹    æœåŠ¡å™¨å·²æ¥å—è¯·æ±‚ï¼Œä½†å°šæœªå¤„ç†ã€‚æ­£å¦‚å®ƒå¯èƒ½è¢«æ‹’ç»ä¸€æ ·ï¼Œæœ€ç»ˆè¯¥è¯·æ±‚å¯èƒ½ä¼šä¹Ÿå¯èƒ½ä¸ä¼šè¢«æ‰§è¡Œã€‚åœ¨å¼‚æ­¥æ“ä½œçš„åœºåˆä¸‹ï¼Œæ²¡æœ‰æ¯”å‘é€è¿™ä¸ªçŠ¶æ€ç æ›´æ–¹ä¾¿çš„åšæ³•äº†ã€‚:è¿”å›202çŠ¶æ€ç çš„å“åº”çš„ç›®çš„æ˜¯å…è®¸æœåŠ¡å™¨æ¥å—å…¶ä»–è¿‡ç¨‹çš„è¯·æ±‚ï¼ˆä¾‹å¦‚æŸä¸ªæ¯å¤©åªæ‰§è¡Œä¸€æ¬¡çš„åŸºäºæ‰¹å¤„ç†çš„æ“ä½œï¼‰ï¼Œè€Œä¸å¿…è®©å®¢æˆ·ç«¯ä¸€ç›´ä¿æŒä¸æœåŠ¡å™¨çš„è¿æ¥ç›´åˆ°æ‰¹å¤„ç†æ“ä½œå…¨éƒ¨å®Œæˆã€‚åœ¨æ¥å—è¯·æ±‚å¤„ç†å¹¶è¿”å›202çŠ¶æ€ç çš„å“åº”åº”å½“åœ¨è¿”å›çš„å®ä½“ä¸­åŒ…å«ä¸€äº›æŒ‡ç¤ºå¤„ç†å½“å‰çŠ¶æ€çš„ä¿¡æ¯ï¼Œä»¥åŠæŒ‡å‘å¤„ç†çŠ¶æ€ç›‘è§†å™¨æˆ–çŠ¶æ€é¢„æµ‹çš„æŒ‡é’ˆï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿä¼°è®¡æ“ä½œæ˜¯å¦å·²ç»å®Œæˆã€‚</p>
<h4 id="203-Non-Authoritative-Information"><a href="#203-Non-Authoritative-Information" class="headerlink" title="203 Non-Authoritative Information"></a>203 Non-Authoritative Information</h4><p>â€‹    æœåŠ¡å™¨å·²æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†è¿”å›çš„å®ä½“å¤´éƒ¨å…ƒä¿¡æ¯ä¸æ˜¯åœ¨åŸå§‹æœåŠ¡å™¨ä¸Šæœ‰æ•ˆçš„ç¡®å®šé›†åˆï¼Œè€Œæ˜¯æ¥è‡ªæœ¬åœ°æˆ–è€…ç¬¬ä¸‰æ–¹çš„æ‹·è´ã€‚å½“å‰çš„ä¿¡æ¯å¯èƒ½æ˜¯åŸå§‹ç‰ˆæœ¬çš„å­é›†æˆ–è€…è¶… é›†ã€‚ä¾‹å¦‚ï¼ŒåŒ…å«èµ„æºçš„å…ƒæ•°æ®å¯èƒ½å¯¼è‡´åŸå§‹æœåŠ¡å™¨çŸ¥é“å…ƒä¿¡æ¯çš„è¶…é›†ã€‚ä½¿ç”¨æ­¤çŠ¶æ€ç ä¸æ˜¯å¿…é¡»çš„ï¼Œè€Œä¸”åªæœ‰åœ¨å“åº”ä¸ä½¿ç”¨æ­¤çŠ¶æ€ç ä¾¿ä¼šè¿”å›200 OKçš„æƒ…å†µä¸‹æ‰æ˜¯åˆé€‚çš„ã€‚</p>
<h4 id="204-No-Content"><a href="#204-No-Content" class="headerlink" title="204 No Content"></a>204 No Content</h4><p>â€‹    æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä½†ä¸éœ€è¦è¿”å›ä»»ä½•å®ä½“å†…å®¹ï¼Œå¹¶ä¸”å¸Œæœ›è¿”å›æ›´æ–°äº†çš„å…ƒä¿¡æ¯ã€‚å“åº”å¯èƒ½é€šè¿‡å®ä½“å¤´éƒ¨çš„å½¢å¼ï¼Œè¿”å›æ–°çš„æˆ–æ›´æ–°åçš„å…ƒä¿¡æ¯ã€‚å¦‚æœå­˜åœ¨è¿™äº›å¤´éƒ¨ä¿¡æ¯ï¼Œåˆ™åº”å½“ä¸æ‰€è¯·æ±‚çš„å˜é‡ç›¸å‘¼åº”ã€‚</p>
<p>â€‹    å¦‚æœå®¢æˆ·ç«¯æ˜¯æµè§ˆå™¨çš„è¯ï¼Œé‚£ä¹ˆç”¨æˆ·æµè§ˆå™¨åº”ä¿ç•™å‘é€äº†è¯¥è¯·æ±‚çš„é¡µé¢ï¼Œè€Œä¸äº§ç”Ÿä»»ä½•æ–‡æ¡£è§†å›¾ä¸Šçš„å˜åŒ–ï¼Œå³ä½¿æŒ‰ç…§è§„èŒƒæ–°çš„æˆ–æ›´æ–°åçš„å…ƒä¿¡æ¯åº”å½“è¢«åº”ç”¨åˆ°ç”¨æˆ·æµè§ˆå™¨æ´»åŠ¨è§†å›¾ä¸­çš„æ–‡æ¡£ã€‚</p>
<p>â€‹    ç”±äº204å“åº”è¢«ç¦æ­¢åŒ…å«ä»»ä½•æ¶ˆæ¯ä½“ï¼Œå› æ­¤å®ƒå§‹ç»ˆä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“å°¾ã€‚</p>
<h4 id="205-Reset-Content"><a href="#205-Reset-Content" class="headerlink" title="205 Reset Content"></a>205 Reset Content</h4><p>â€‹    æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼Œä¸”æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ã€‚ä½†æ˜¯ä¸204å“åº”ä¸åŒï¼Œè¿”å›æ­¤çŠ¶æ€ç çš„å“åº”è¦æ±‚è¯·æ±‚è€…é‡ç½®æ–‡æ¡£è§†å›¾ã€‚è¯¥å“åº”ä¸»è¦æ˜¯è¢«ç”¨äºæ¥å—ç”¨æˆ·è¾“å…¥åï¼Œç«‹å³é‡ç½®è¡¨å•ï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿè½»æ¾åœ°å¼€å§‹å¦ä¸€æ¬¡è¾“å…¥ã€‚</p>
<pre><code>ä¸204å“åº”ä¸€æ ·ï¼Œè¯¥å“åº”ä¹Ÿè¢«ç¦æ­¢åŒ…å«ä»»ä½•æ¶ˆæ¯ä½“ï¼Œä¸”ä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“æŸã€‚</code></pre><h4 id="206-Partial-Content"><a href="#206-Partial-Content" class="headerlink" title="206 Partial Content"></a>206 Partial Content</h4><p>â€‹    æœåŠ¡å™¨å·²ç»æˆåŠŸå¤„ç†äº†éƒ¨åˆ†GETè¯·æ±‚ã€‚ç±»ä¼¼äºFlashGetæˆ–è€…è¿…é›·è¿™ç±»çš„HTTP ä¸‹è½½å·¥å…·éƒ½æ˜¯ä½¿ç”¨æ­¤ç±»å“åº”å®ç°æ–­ç‚¹ç»­ä¼ æˆ–è€…å°†ä¸€ä¸ªå¤§æ–‡æ¡£åˆ†è§£ä¸ºå¤šä¸ªä¸‹è½½æ®µåŒæ—¶ä¸‹è½½ã€‚</p>
<p>â€‹    è¯¥è¯·æ±‚å¿…é¡»åŒ…å«Rangeå¤´ä¿¡æ¯æ¥æŒ‡ç¤ºå®¢æˆ·ç«¯å¸Œæœ›å¾—åˆ°çš„å†…å®¹èŒƒå›´ï¼Œå¹¶ä¸”å¯èƒ½åŒ…å«If-Rangeæ¥ä½œä¸ºè¯·æ±‚æ¡ä»¶ã€‚</p>
<p>â€‹    å“åº”å¿…é¡»åŒ…å«å¦‚ä¸‹çš„å¤´éƒ¨åŸŸï¼š</p>
<blockquote>
<p>Content-Rangeç”¨ä»¥æŒ‡ç¤ºæœ¬æ¬¡å“åº”ä¸­è¿”å›çš„å†…å®¹çš„èŒƒå›´ï¼›å¦‚æœæ˜¯Content-Typeä¸ºmultipart/byterangesçš„å¤šæ®µä¸‹è½½ï¼Œåˆ™æ¯ä¸€multipartæ®µä¸­éƒ½åº”åŒ…å«Content-RangeåŸŸç”¨ä»¥æŒ‡ç¤ºæœ¬æ®µçš„å†…å®¹èŒƒå›´ã€‚å‡å¦‚å“åº”ä¸­åŒ…å«Content-Lengthï¼Œé‚£ä¹ˆå®ƒçš„æ•°å€¼å¿…é¡»åŒ¹é…å®ƒè¿”å›çš„å†…å®¹èŒƒå›´çš„çœŸå®å­—èŠ‚æ•°ã€‚</p>
<p>Date</p>
<p>ETagå’Œï¼æˆ–Content-Locationï¼Œå‡å¦‚åŒæ ·çš„è¯·æ±‚æœ¬åº”è¯¥è¿”å›200å“åº”ã€‚</p>
<p>Expires, Cache-Controlï¼Œå’Œï¼æˆ–Varyï¼Œå‡å¦‚å…¶å€¼å¯èƒ½ä¸ä¹‹å‰ç›¸åŒå˜é‡çš„å…¶ä»–å“åº”å¯¹åº”çš„å€¼ä¸åŒçš„è¯ã€‚</p>
</blockquote>
<p>â€‹    å‡å¦‚æœ¬å“åº”è¯·æ±‚ä½¿ç”¨äº†If-Rangeå¼ºç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ä¸åº”è¯¥åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›å‡å¦‚æœ¬å“åº”çš„è¯·æ±‚ä½¿ç”¨äº†If-Rangeå¼±ç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ç¦æ­¢åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›è¿™é¿å…äº†ç¼“å­˜çš„å®ä½“å†…å®¹å’Œæ›´æ–°äº†çš„å®ä½“å¤´ä¿¡æ¯ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚å¦åˆ™ï¼Œæœ¬å“åº”å°±åº”å½“åŒ…å«æ‰€æœ‰æœ¬åº”è¯¥è¿”å›200å“åº”ä¸­åº”å½“è¿”å›çš„æ‰€æœ‰å®ä½“å¤´éƒ¨åŸŸã€‚</p>
<p>â€‹    å‡å¦‚ETagæˆ–Last-Modifiedå¤´éƒ¨ä¸èƒ½ç²¾ç¡®åŒ¹é…çš„è¯ï¼Œåˆ™å®¢æˆ·ç«¯ç¼“å­˜åº”ç¦æ­¢å°†206å“åº”è¿”å›çš„å†…å®¹ä¸ä¹‹å‰ä»»ä½•ç¼“å­˜è¿‡çš„å†…å®¹ç»„åˆåœ¨ä¸€èµ·ã€‚</p>
<p>â€‹    ä»»ä½•ä¸æ”¯æŒRangeä»¥åŠContent-Rangeå¤´çš„ç¼“å­˜éƒ½ç¦æ­¢ç¼“å­˜206å“åº”è¿”å›çš„å†…å®¹ã€‚</p>
<p>207 Multi-Status</p>
<p>â€‹    ç”±WebDAV(RFC 2518)æ‰©å±•çš„çŠ¶æ€ç ï¼Œä»£è¡¨ä¹‹åçš„æ¶ˆæ¯ä½“å°†æ˜¯ä¸€ä¸ªXMLæ¶ˆæ¯ï¼Œå¹¶ä¸”å¯èƒ½ä¾ç…§ä¹‹å‰å­è¯·æ±‚æ•°é‡çš„ä¸åŒï¼ŒåŒ…å«ä¸€ç³»åˆ—ç‹¬ç«‹çš„å“åº”ä»£ç ã€‚</p>
<h3 id="3xxé‡å®šå‘"><a href="#3xxé‡å®šå‘" class="headerlink" title="3xxé‡å®šå‘"></a>3xxé‡å®šå‘</h3><p>â€‹    è¿™ç±»çŠ¶æ€ç ä»£è¡¨éœ€è¦å®¢æˆ·ç«¯é‡‡å–è¿›ä¸€æ­¥çš„æ“ä½œæ‰èƒ½å®Œæˆè¯·æ±‚ã€‚é€šå¸¸ï¼Œè¿™äº›çŠ¶æ€ç ç”¨æ¥é‡å®šå‘ï¼Œåç»­çš„è¯·æ±‚åœ°å€ï¼ˆé‡å®šå‘ç›®æ ‡ï¼‰åœ¨æœ¬æ¬¡å“åº”çš„LocationåŸŸä¸­æŒ‡æ˜ã€‚</p>
<p>â€‹    å½“ä¸”ä»…å½“åç»­çš„è¯·æ±‚æ‰€ä½¿ç”¨çš„æ–¹æ³•æ˜¯GETæˆ–è€…HEADæ—¶ï¼Œç”¨æˆ·æµè§ˆå™¨æ‰å¯ä»¥åœ¨æ²¡æœ‰ç”¨æˆ·ä»‹å…¥çš„æƒ…å†µä¸‹è‡ªåŠ¨æäº¤æ‰€éœ€è¦çš„åç»­è¯·æ±‚ã€‚å®¢æˆ·ç«¯åº”å½“è‡ªåŠ¨ç›‘æµ‹æ— é™å¾ªç¯é‡å®šå‘ï¼ˆä¾‹å¦‚ï¼šAâ†’Bâ†’Câ†’â€¦â€¦â†’Aæˆ–Aâ†’Aï¼‰ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å¤§é‡ä¸å¿…è¦çš„èµ„æºæ¶ˆè€—ã€‚æŒ‰ç…§HTTP/1.0ç‰ˆè§„èŒƒçš„å»ºè®®ï¼Œæµè§ˆå™¨ä¸åº”è‡ªåŠ¨è®¿é—®è¶…è¿‡5æ¬¡çš„é‡å®šå‘ã€‚</p>
<h4 id="300-Multiple-Choices"><a href="#300-Multiple-Choices" class="headerlink" title="300 Multiple Choices"></a>300 Multiple Choices</h4><p>â€‹    è¢«è¯·æ±‚çš„èµ„æºæœ‰ä¸€ç³»åˆ—å¯ä¾›é€‰æ‹©çš„å›é¦ˆä¿¡æ¯ï¼Œæ¯ä¸ªéƒ½æœ‰è‡ªå·±ç‰¹å®šçš„åœ°å€å’Œæµè§ˆå™¨é©±åŠ¨çš„å•†è®®ä¿¡æ¯ã€‚ç”¨æˆ·æˆ–æµè§ˆå™¨èƒ½å¤Ÿè‡ªè¡Œé€‰æ‹©ä¸€ä¸ªé¦–é€‰çš„åœ°å€è¿›è¡Œé‡å®šå‘ã€‚</p>
<p>â€‹    é™¤éè¿™æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™è¯¥å“åº”åº”å½“åŒ…æ‹¬ä¸€ä¸ªèµ„æºç‰¹æ€§åŠåœ°å€çš„åˆ—è¡¨çš„å®ä½“ï¼Œä»¥ä¾¿ç”¨æˆ·æˆ–æµè§ˆå™¨ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„é‡å®šå‘åœ°å€ã€‚è¿™ä¸ªå®ä½“çš„æ ¼å¼ç”±Content-Typeå®šä¹‰çš„æ ¼å¼æ‰€å†³å®šã€‚æµè§ˆå™¨å¯èƒ½æ ¹æ®å“åº”çš„æ ¼å¼ä»¥åŠæµè§ˆå™¨è‡ªèº«èƒ½åŠ›ï¼Œè‡ªåŠ¨ä½œå‡ºæœ€åˆé€‚çš„é€‰æ‹©ã€‚å½“ç„¶ï¼ŒRFC 2616è§„èŒƒå¹¶æ²¡æœ‰è§„å®šè¿™æ ·çš„è‡ªåŠ¨é€‰æ‹©è¯¥å¦‚ä½•è¿›è¡Œã€‚</p>
<p>â€‹    å¦‚æœæœåŠ¡å™¨æœ¬èº«å·²ç»æœ‰äº†é¦–é€‰çš„å›é¦ˆé€‰æ‹©ï¼Œé‚£ä¹ˆåœ¨Locationä¸­åº”å½“æŒ‡æ˜è¿™ä¸ªå›é¦ˆçš„URIï¼›æµè§ˆå™¨å¯èƒ½ä¼šå°†è¿™ä¸ªLocationå€¼ä½œä¸ºè‡ªåŠ¨é‡å®šå‘çš„åœ°å€ã€‚æ­¤å¤–ï¼Œé™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªå“åº”ä¹Ÿæ˜¯å¯ç¼“å­˜çš„ã€‚</p>
<h4 id="301-Moved-Permanently"><a href="#301-Moved-Permanently" class="headerlink" title="301 Moved Permanently"></a>301 Moved Permanently</h4><p>â€‹    è¢«è¯·æ±‚çš„èµ„æºå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ï¼Œå¹¶ä¸”å°†æ¥ä»»ä½•å¯¹æ­¤èµ„æºçš„å¼•ç”¨éƒ½åº”è¯¥ä½¿ç”¨æœ¬å“åº”è¿”å›çš„è‹¥å¹²ä¸ªURIä¹‹ä¸€ã€‚å¦‚æœå¯èƒ½ï¼Œæ‹¥æœ‰é“¾æ¥ç¼–è¾‘åŠŸèƒ½çš„å®¢æˆ·ç«¯åº”å½“è‡ªåŠ¨æŠŠè¯·æ±‚çš„åœ°å€ä¿®æ”¹ä¸ºä»æœåŠ¡å™¨åé¦ˆå›æ¥çš„åœ°å€ã€‚é™¤éé¢å¤–æŒ‡å®šï¼Œå¦åˆ™è¿™ä¸ªå“åº”ä¹Ÿæ˜¯å¯ç¼“å­˜çš„ã€‚</p>
<p>â€‹    æ–°çš„æ°¸ä¹…æ€§çš„URIåº”å½“åœ¨å“åº”çš„LocationåŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„URIçš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚</p>
<p>â€‹    å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ªGETæˆ–è€…HEADè¯·æ±‚ï¼Œå› æ­¤æµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>â€‹    æ³¨æ„ï¼šå¯¹äºæŸäº›ä½¿ç”¨HTTP/1.0åè®®çš„æµè§ˆå™¨ï¼Œå½“å®ƒä»¬å‘é€çš„POSTè¯·æ±‚å¾—åˆ°äº†ä¸€ä¸ª301å“åº”çš„è¯ï¼Œæ¥ä¸‹æ¥çš„é‡å®šå‘è¯·æ±‚å°†ä¼šå˜æˆGETæ–¹å¼ã€‚</p>
<h4 id="302-Found"><a href="#302-Found" class="headerlink" title="302 Found"></a>302 Found</h4><p>â€‹    è¯·æ±‚çš„èµ„æºç°åœ¨ä¸´æ—¶ä»ä¸åŒçš„URIå“åº”è¯·æ±‚ã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ã€‚åªæœ‰åœ¨Cache-Controlæˆ–Expiresä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚</p>
<p>â€‹    æ–°çš„ä¸´æ—¶æ€§çš„URIåº”å½“åœ¨å“åº”çš„LocationåŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„URIçš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚</p>
<p>â€‹    å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ªGETæˆ–è€…HEADè¯·æ±‚ï¼Œé‚£ä¹ˆæµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>â€‹    æ³¨æ„ï¼šè™½ç„¶RFC 1945å’ŒRFC 2068è§„èŒƒä¸å…è®¸å®¢æˆ·ç«¯åœ¨é‡å®šå‘æ—¶æ”¹å˜è¯·æ±‚çš„æ–¹æ³•ï¼Œä½†æ˜¯å¾ˆå¤šç°å­˜çš„æµè§ˆå™¨å°†302å“åº”è§†ä½œä¸º303å“åº”ï¼Œå¹¶ä¸”ä½¿ç”¨GETæ–¹å¼è®¿é—®åœ¨Locationä¸­è§„å®šçš„URIï¼Œè€Œæ— è§†åŸå…ˆè¯·æ±‚çš„æ–¹æ³•ã€‚çŠ¶æ€ç 303å’Œ307è¢«æ·»åŠ äº†è¿›æ¥ï¼Œç”¨ä»¥æ˜ç¡®æœåŠ¡å™¨æœŸå¾…å®¢æˆ·ç«¯è¿›è¡Œä½•ç§ååº”ã€‚</p>
<h4 id="303-See-Other"><a href="#303-See-Other" class="headerlink" title="303 See Other"></a>303 See Other</h4><p>â€‹    å¯¹åº”å½“å‰è¯·æ±‚çš„å“åº”å¯ä»¥åœ¨å¦ä¸€ä¸ªURIä¸Šè¢«æ‰¾åˆ°ï¼Œè€Œä¸”å®¢æˆ·ç«¯åº”å½“é‡‡ç”¨GETçš„æ–¹å¼è®¿é—®é‚£ä¸ªèµ„æºã€‚è¿™ä¸ªæ–¹æ³•çš„å­˜åœ¨ä¸»è¦æ˜¯ä¸ºäº†å…è®¸ç”±è„šæœ¬æ¿€æ´»çš„POSTè¯·æ±‚è¾“å‡ºé‡å®šå‘åˆ°ä¸€ä¸ªæ–°çš„èµ„æºã€‚è¿™ä¸ªæ–°çš„URIä¸æ˜¯åŸå§‹èµ„æºçš„æ›¿ä»£å¼•ç”¨ã€‚åŒæ—¶ï¼Œ303å“åº”ç¦æ­¢è¢«ç¼“å­˜ã€‚å½“ç„¶ï¼Œç¬¬äºŒä¸ªè¯·æ±‚ï¼ˆé‡å®šå‘ï¼‰å¯èƒ½è¢«ç¼“å­˜ã€‚</p>
<p>â€‹    æ–°çš„URIåº”å½“åœ¨å“åº”çš„LocationåŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„URIçš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚</p>
<p>â€‹    æ³¨æ„ï¼šè®¸å¤šHTTP/1.1ç‰ˆä»¥å‰çš„æµè§ˆå™¨ä¸èƒ½æ­£ç¡®ç†è§£303çŠ¶æ€ã€‚å¦‚æœéœ€è¦è€ƒè™‘ä¸è¿™äº›æµè§ˆå™¨ä¹‹é—´çš„äº’åŠ¨ï¼Œ302çŠ¶æ€ç åº”è¯¥å¯ä»¥èƒœä»»ï¼Œå› ä¸ºå¤§å¤šæ•°çš„æµè§ˆå™¨å¤„ç†302å“åº”æ—¶çš„æ–¹å¼æ°æ°å°±æ˜¯ä¸Šè¿°è§„èŒƒè¦æ±‚å®¢æˆ·ç«¯å¤„ç†303å“åº”æ—¶åº”å½“åšçš„ã€‚</p>
<h4 id="304-Not-Modified"><a href="#304-Not-Modified" class="headerlink" title="304 Not Modified"></a>304 Not Modified</h4><p>â€‹    å¦‚æœå®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªå¸¦æ¡ä»¶çš„GETè¯·æ±‚ä¸”è¯¥è¯·æ±‚å·²è¢«å…è®¸ï¼Œè€Œæ–‡æ¡£çš„å†…å®¹ï¼ˆè‡ªä¸Šæ¬¡è®¿é—®ä»¥æ¥æˆ–è€…æ ¹æ®è¯·æ±‚çš„æ¡ä»¶ï¼‰å¹¶æ²¡æœ‰æ”¹å˜ï¼Œåˆ™æœåŠ¡å™¨åº”å½“è¿”å›è¿™ä¸ªçŠ¶æ€ç ã€‚304å“åº”ç¦æ­¢åŒ…å«æ¶ˆæ¯ä½“ï¼Œå› æ­¤å§‹ç»ˆä»¥æ¶ˆæ¯å¤´åçš„ç¬¬ä¸€ä¸ªç©ºè¡Œç»“å°¾ã€‚</p>
<p>â€‹    è¯¥å“åº”å¿…é¡»åŒ…å«ä»¥ä¸‹çš„å¤´ä¿¡æ¯ï¼š</p>
<blockquote>
<p>Dateï¼Œé™¤éè¿™ä¸ªæœåŠ¡å™¨æ²¡æœ‰æ—¶é’Ÿã€‚å‡å¦‚æ²¡æœ‰æ—¶é’Ÿçš„æœåŠ¡å™¨ä¹Ÿéµå®ˆè¿™äº›è§„åˆ™ï¼Œé‚£ä¹ˆä»£ç†æœåŠ¡å™¨ä»¥åŠå®¢æˆ·ç«¯å¯ä»¥è‡ªè¡Œå°†Dateå­—æ®µæ·»åŠ åˆ°æ¥æ”¶åˆ°çš„å“åº”å¤´ä¸­å»ï¼ˆæ­£å¦‚RFC 2068ä¸­è§„å®šçš„ä¸€æ ·ï¼‰ï¼Œç¼“å­˜æœºåˆ¶å°†ä¼šæ­£å¸¸å·¥ä½œã€‚</p>
<p>ETagå’Œï¼æˆ–Content-Locationï¼Œå‡å¦‚åŒæ ·çš„è¯·æ±‚æœ¬åº”è¿”å›200å“åº”ã€‚</p>
<p>Expires, Cache-Controlï¼Œå’Œï¼æˆ–Varyï¼Œå‡å¦‚å…¶å€¼å¯èƒ½ä¸ä¹‹å‰ç›¸åŒå˜é‡çš„å…¶ä»–å“åº”å¯¹åº”çš„å€¼ä¸åŒçš„è¯ã€‚</p>
</blockquote>
<p>â€‹    å‡å¦‚æœ¬å“åº”è¯·æ±‚ä½¿ç”¨äº†å¼ºç¼“å­˜éªŒè¯ï¼Œé‚£ä¹ˆæœ¬æ¬¡å“åº”ä¸åº”è¯¥åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›å¦åˆ™ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸ªå¸¦æ¡ä»¶çš„GETè¯·æ±‚ä½¿ç”¨äº†å¼±ç¼“å­˜éªŒè¯ï¼‰ï¼Œæœ¬æ¬¡å“åº”ç¦æ­¢åŒ…å«å…¶ä»–å®ä½“å¤´ï¼›è¿™é¿å…äº†ç¼“å­˜äº†çš„å®ä½“å†…å®¹å’Œæ›´æ–°äº†çš„å®ä½“å¤´ä¿¡æ¯ä¹‹é—´çš„ä¸ä¸€è‡´ã€‚</p>
<p>â€‹    å‡å¦‚æŸä¸ª304å“åº”æŒ‡æ˜äº†å½“å‰æŸä¸ªå®ä½“æ²¡æœ‰ç¼“å­˜ï¼Œé‚£ä¹ˆç¼“å­˜ç³»ç»Ÿå¿…é¡»å¿½è§†è¿™ä¸ªå“åº”ï¼Œå¹¶ä¸”é‡å¤å‘é€ä¸åŒ…å«é™åˆ¶æ¡ä»¶çš„è¯·æ±‚ã€‚</p>
<p>â€‹    å‡å¦‚æ¥æ”¶åˆ°ä¸€ä¸ªè¦æ±‚æ›´æ–°æŸä¸ªç¼“å­˜æ¡ç›®çš„304å“åº”ï¼Œé‚£ä¹ˆç¼“å­˜ç³»ç»Ÿå¿…é¡»æ›´æ–°æ•´ä¸ªæ¡ç›®ä»¥åæ˜ æ‰€æœ‰åœ¨å“åº”ä¸­è¢«æ›´æ–°çš„å­—æ®µçš„å€¼ã€‚</p>
<h4 id="305-Use-Proxy"><a href="#305-Use-Proxy" class="headerlink" title="305 Use Proxy"></a>305 Use Proxy</h4><p>â€‹    è¢«è¯·æ±‚çš„èµ„æºå¿…é¡»é€šè¿‡æŒ‡å®šçš„ä»£ç†æ‰èƒ½è¢«è®¿é—®ã€‚LocationåŸŸä¸­å°†ç»™å‡ºæŒ‡å®šçš„ä»£ç†æ‰€åœ¨çš„URIä¿¡æ¯ï¼Œæ¥æ”¶è€…éœ€è¦é‡å¤å‘é€ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œé€šè¿‡è¿™ä¸ªä»£ç†æ‰èƒ½è®¿é—®ç›¸åº”èµ„æºã€‚åªæœ‰åŸå§‹æœåŠ¡å™¨æ‰èƒ½åˆ›å»º305å“åº”ã€‚</p>
<p>â€‹    æ³¨æ„ï¼šRFC 2068ä¸­æ²¡æœ‰æ˜ç¡®305å“åº”æ˜¯ä¸ºäº†é‡å®šå‘ä¸€ä¸ªå•ç‹¬çš„è¯·æ±‚ï¼Œè€Œä¸”åªèƒ½è¢«åŸå§‹æœåŠ¡å™¨åˆ›å»ºã€‚å¿½è§†è¿™äº›é™åˆ¶å¯èƒ½å¯¼è‡´ä¸¥é‡çš„å®‰å…¨åæœã€‚</p>
<h4 id="306-Switch-Proxy"><a href="#306-Switch-Proxy" class="headerlink" title="306 Switch Proxy"></a>306 Switch Proxy</h4><p>â€‹    åœ¨æœ€æ–°ç‰ˆçš„è§„èŒƒä¸­ï¼Œ306çŠ¶æ€ç å·²ç»ä¸å†è¢«ä½¿ç”¨ã€‚</p>
<h4 id="307-Temporary-Redirect"><a href="#307-Temporary-Redirect" class="headerlink" title="307 Temporary Redirect"></a>307 Temporary Redirect</h4><p>â€‹    è¯·æ±‚çš„èµ„æºç°åœ¨ä¸´æ—¶ä»ä¸åŒçš„URIå“åº”è¯·æ±‚ã€‚ç”±äºè¿™æ ·çš„é‡å®šå‘æ˜¯ä¸´æ—¶çš„ï¼Œå®¢æˆ·ç«¯åº”å½“ç»§ç»­å‘åŸæœ‰åœ°å€å‘é€ä»¥åçš„è¯·æ±‚ã€‚åªæœ‰åœ¨Cache-Controlæˆ–Expiresä¸­è¿›è¡Œäº†æŒ‡å®šçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå“åº”æ‰æ˜¯å¯ç¼“å­˜çš„ã€‚</p>
<p>â€‹    æ–°çš„ä¸´æ—¶æ€§çš„URIåº”å½“åœ¨å“åº”çš„LocationåŸŸä¸­è¿”å›ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™å“åº”çš„å®ä½“ä¸­åº”å½“åŒ…å«æŒ‡å‘æ–°çš„URIçš„è¶…é“¾æ¥åŠç®€çŸ­è¯´æ˜ã€‚å› ä¸ºéƒ¨åˆ†æµè§ˆå™¨ä¸èƒ½è¯†åˆ«307å“åº”ï¼Œå› æ­¤éœ€è¦æ·»åŠ ä¸Šè¿°å¿…è¦ä¿¡æ¯ä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿç†è§£å¹¶å‘æ–°çš„URIå‘å‡ºè®¿é—®è¯·æ±‚ã€‚</p>
<p>â€‹    å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ªGETæˆ–è€…HEADè¯·æ±‚ï¼Œé‚£ä¹ˆæµè§ˆå™¨ç¦æ­¢è‡ªåŠ¨è¿›è¡Œé‡å®šå‘ï¼Œé™¤éå¾—åˆ°ç”¨æˆ·çš„ç¡®è®¤ï¼Œå› ä¸ºè¯·æ±‚çš„æ¡ä»¶å¯èƒ½å› æ­¤å‘ç”Ÿå˜åŒ–ã€‚</p>
<h3 id="4xxå®¢æˆ·ç«¯é”™è¯¯"><a href="#4xxå®¢æˆ·ç«¯é”™è¯¯" class="headerlink" title="4xxå®¢æˆ·ç«¯é”™è¯¯"></a>4xxå®¢æˆ·ç«¯é”™è¯¯</h3><p>â€‹    è¿™ç±»çš„çŠ¶æ€ç ä»£è¡¨äº†å®¢æˆ·ç«¯çœ‹èµ·æ¥å¯èƒ½å‘ç”Ÿäº†é”™è¯¯ï¼Œå¦¨ç¢äº†æœåŠ¡å™¨çš„å¤„ç†ã€‚é™¤éå“åº”çš„æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™æœåŠ¡å™¨å°±åº”è¯¥è¿”å›ä¸€ä¸ªè§£é‡Šå½“å‰é”™è¯¯çŠ¶å†µçš„å®ä½“ï¼Œä»¥åŠè¿™æ˜¯ä¸´æ—¶çš„è¿˜æ˜¯æ°¸ä¹…æ€§çš„çŠ¶å†µã€‚è¿™äº›çŠ¶æ€ç é€‚ç”¨äºä»»ä½•è¯·æ±‚æ–¹æ³•ã€‚æµè§ˆå™¨åº”å½“å‘ç”¨æˆ·æ˜¾ç¤ºä»»ä½•åŒ…å«åœ¨æ­¤ç±»é”™è¯¯å“åº”ä¸­çš„å®ä½“å†…å®¹ã€‚</p>
<p>â€‹    å¦‚æœé”™è¯¯å‘ç”Ÿæ—¶å®¢æˆ·ç«¯æ­£åœ¨ä¼ é€æ•°æ®ï¼Œé‚£ä¹ˆä½¿ç”¨TCPçš„æœåŠ¡å™¨å®ç°åº”å½“ä»”ç»†ç¡®ä¿åœ¨å…³é—­å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ä¹‹å‰ï¼Œå®¢æˆ·ç«¯å·²ç»æ”¶åˆ°äº†åŒ…å«é”™è¯¯ä¿¡æ¯çš„æ•°æ®åŒ…ã€‚å¦‚æœå®¢æˆ·ç«¯åœ¨æ”¶åˆ°é”™è¯¯ä¿¡æ¯åç»§ç»­å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼ŒæœåŠ¡å™¨çš„TCPæ ˆå°†å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªé‡ç½®æ•°æ®åŒ…ï¼Œä»¥æ¸…é™¤è¯¥å®¢æˆ·ç«¯æ‰€æœ‰è¿˜æœªè¯†åˆ«çš„è¾“å…¥ç¼“å†²ï¼Œä»¥å…è¿™äº›æ•°æ®è¢«æœåŠ¡å™¨ä¸Šçš„åº”ç”¨ç¨‹åºè¯»å–å¹¶å¹²æ‰°åè€…ã€‚</p>
<h4 id="400-Bad-Request"><a href="#400-Bad-Request" class="headerlink" title="400 Bad Request"></a>400 Bad Request</h4><p>â€‹    ç”±äºåŒ…å«è¯­æ³•é”™è¯¯ï¼Œå½“å‰è¯·æ±‚æ— æ³•è¢«æœåŠ¡å™¨ç†è§£ã€‚é™¤éè¿›è¡Œä¿®æ”¹ï¼Œå¦åˆ™å®¢æˆ·ç«¯ä¸åº”è¯¥é‡å¤æäº¤è¿™ä¸ªè¯·æ±‚ã€‚</p>
<h4 id="401-Unauthorized"><a href="#401-Unauthorized" class="headerlink" title="401 Unauthorized"></a>401 Unauthorized</h4><p>â€‹    å½“å‰è¯·æ±‚éœ€è¦ç”¨æˆ·éªŒè¯ã€‚è¯¥å“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªé€‚ç”¨äºè¢«è¯·æ±‚èµ„æºçš„WWW-Authenticateä¿¡æ¯å¤´ç”¨ä»¥è¯¢é—®ç”¨æˆ·ä¿¡æ¯ã€‚å®¢æˆ·ç«¯å¯ä»¥é‡å¤æäº¤ä¸€ä¸ªåŒ…å«æ°å½“çš„Authorizationå¤´ä¿¡æ¯çš„è¯·æ±‚ã€‚å¦‚æœå½“å‰è¯·æ±‚å·²ç»åŒ…å«äº†Authorizationè¯ä¹¦ï¼Œé‚£ä¹ˆ401å“åº”ä»£è¡¨ç€æœåŠ¡å™¨éªŒè¯å·²ç»æ‹’ç»äº†é‚£äº›è¯ä¹¦ã€‚å¦‚æœ401å“åº”åŒ…å«äº†ä¸å‰ä¸€ä¸ªå“åº”ç›¸åŒçš„èº«ä»½éªŒè¯è¯¢é—®ï¼Œä¸”æµè§ˆå™¨å·²ç»è‡³å°‘å°è¯•äº†ä¸€æ¬¡éªŒè¯ï¼Œé‚£ä¹ˆæµè§ˆå™¨åº”å½“å‘ç”¨æˆ·å±•ç¤ºå“åº”ä¸­åŒ…å«çš„å®ä½“ä¿¡æ¯ï¼Œå› ä¸ºè¿™ä¸ªå®ä½“ä¿¡æ¯ä¸­å¯èƒ½åŒ…å«äº†ç›¸å…³è¯Šæ–­ä¿¡æ¯ã€‚å‚è§RFC 2617ã€‚</p>
<h4 id="402-Payment-Required"><a href="#402-Payment-Required" class="headerlink" title="402 Payment Required"></a>402 Payment Required</h4><p>â€‹    è¯¥çŠ¶æ€ç æ˜¯ä¸ºäº†å°†æ¥å¯èƒ½çš„éœ€æ±‚è€Œé¢„ç•™çš„ã€‚</p>
<h4 id="403-Forbidden"><a href="#403-Forbidden" class="headerlink" title="403 Forbidden"></a>403 Forbidden</h4><p>â€‹    æœåŠ¡å™¨å·²ç»ç†è§£è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æ‰§è¡Œå®ƒã€‚ä¸401å“åº”ä¸åŒçš„æ˜¯ï¼Œèº«ä»½éªŒè¯å¹¶ä¸èƒ½æä¾›ä»»ä½•å¸®åŠ©ï¼Œè€Œä¸”è¿™ä¸ªè¯·æ±‚ä¹Ÿä¸åº”è¯¥è¢«é‡å¤æäº¤ã€‚å¦‚æœè¿™ä¸æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œè€Œä¸”æœåŠ¡å™¨å¸Œæœ›èƒ½å¤Ÿè®²æ¸…æ¥šä¸ºä½•è¯·æ±‚ä¸èƒ½è¢«æ‰§è¡Œï¼Œé‚£ä¹ˆå°±åº”è¯¥åœ¨å®ä½“å†…æè¿°æ‹’ç»çš„åŸå› ã€‚å½“ç„¶æœåŠ¡å™¨ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ª404å“åº”ï¼Œå‡å¦‚å®ƒä¸å¸Œæœ›è®©å®¢æˆ·ç«¯è·å¾—ä»»ä½•ä¿¡æ¯ã€‚</p>
<h4 id="404-Not-Found"><a href="#404-Not-Found" class="headerlink" title="404 Not Found"></a>404 Not Found</h4><p>â€‹    è¯·æ±‚å¤±è´¥ï¼Œè¯·æ±‚æ‰€å¸Œæœ›å¾—åˆ°çš„èµ„æºæœªè¢«åœ¨æœåŠ¡å™¨ä¸Šå‘ç°ã€‚æ²¡æœ‰ä¿¡æ¯èƒ½å¤Ÿå‘Šè¯‰ç”¨æˆ·è¿™ä¸ªçŠ¶å†µåˆ°åº•æ˜¯æš‚æ—¶çš„è¿˜æ˜¯æ°¸ä¹…çš„ã€‚å‡å¦‚æœåŠ¡å™¨çŸ¥é“æƒ…å†µçš„è¯ï¼Œåº”å½“ä½¿ç”¨410çŠ¶æ€ç æ¥å‘ŠçŸ¥æ—§èµ„æºå› ä¸ºæŸäº›å†…éƒ¨çš„é…ç½®æœºåˆ¶é—®é¢˜ï¼Œå·²ç»æ°¸ä¹…çš„ä¸å¯ç”¨ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å¯ä»¥è·³è½¬çš„åœ°å€ã€‚404è¿™ä¸ªçŠ¶æ€ç è¢«å¹¿æ³›åº”ç”¨äºå½“æœåŠ¡å™¨ä¸æƒ³æ­ç¤ºåˆ°åº•ä¸ºä½•è¯·æ±‚è¢«æ‹’ç»æˆ–è€…æ²¡æœ‰å…¶ä»–é€‚åˆçš„å“åº”å¯ç”¨çš„æƒ…å†µä¸‹ã€‚</p>
<h4 id="405-Method-Not-Allowed"><a href="#405-Method-Not-Allowed" class="headerlink" title="405 Method Not Allowed"></a>405 Method Not Allowed</h4><p>â€‹    è¯·æ±‚è¡Œä¸­æŒ‡å®šçš„è¯·æ±‚æ–¹æ³•ä¸èƒ½è¢«ç”¨äºè¯·æ±‚ç›¸åº”çš„èµ„æºã€‚è¯¥å“åº”å¿…é¡»è¿”å›ä¸€ä¸ªAllowå¤´ä¿¡æ¯ç”¨ä»¥è¡¨ç¤ºå‡ºå½“å‰èµ„æºèƒ½å¤Ÿæ¥å—çš„è¯·æ±‚æ–¹æ³•çš„åˆ—è¡¨ã€‚</p>
<p>â€‹    é‰´äºPUTï¼ŒDELETEæ–¹æ³•ä¼šå¯¹æœåŠ¡å™¨ä¸Šçš„èµ„æºè¿›è¡Œå†™æ“ä½œï¼Œå› è€Œç»å¤§éƒ¨åˆ†çš„ç½‘é¡µæœåŠ¡å™¨éƒ½ä¸æ”¯æŒæˆ–è€…åœ¨é»˜è®¤é…ç½®ä¸‹ä¸å…è®¸ä¸Šè¿°è¯·æ±‚æ–¹æ³•ï¼Œå¯¹äºæ­¤ç±»è¯·æ±‚å‡ä¼šè¿”å›405é”™è¯¯ã€‚</p>
<h4 id="406-Not-Acceptable"><a href="#406-Not-Acceptable" class="headerlink" title="406 Not Acceptable"></a>406 Not Acceptable</h4><p>â€‹    è¯·æ±‚çš„èµ„æºçš„å†…å®¹ç‰¹æ€§æ— æ³•æ»¡è¶³è¯·æ±‚å¤´ä¸­çš„æ¡ä»¶ï¼Œå› è€Œæ— æ³•ç”Ÿæˆå“åº”å®ä½“ã€‚</p>
<p>â€‹    é™¤éè¿™æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™è¯¥å“åº”å°±åº”å½“è¿”å›ä¸€ä¸ªåŒ…å«å¯ä»¥è®©ç”¨æˆ·æˆ–è€…æµè§ˆå™¨ä»ä¸­é€‰æ‹©æœ€åˆé€‚çš„å®ä½“ç‰¹æ€§ä»¥åŠåœ°å€åˆ—è¡¨çš„å®ä½“ã€‚å®ä½“çš„æ ¼å¼ç”±Content-Typeå¤´ä¸­å®šä¹‰çš„åª’ä½“ç±»å‹å†³å®šã€‚æµè§ˆå™¨å¯ä»¥æ ¹æ®æ ¼å¼åŠè‡ªèº«èƒ½åŠ›è‡ªè¡Œä½œå‡ºæœ€ä½³é€‰æ‹©ã€‚ä½†æ˜¯ï¼Œè§„èŒƒä¸­å¹¶æ²¡æœ‰å®šä¹‰ä»»ä½•ä½œå‡ºæ­¤ç±»è‡ªåŠ¨é€‰æ‹©çš„æ ‡å‡†ã€‚</p>
<h4 id="407-Proxy-Authentication-Required"><a href="#407-Proxy-Authentication-Required" class="headerlink" title="407 Proxy Authentication Required"></a>407 Proxy Authentication Required</h4><p>â€‹    ä¸401å“åº”ç±»ä¼¼ï¼Œåªä¸è¿‡å®¢æˆ·ç«¯å¿…é¡»åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šè¿›è¡Œèº«ä»½éªŒè¯ã€‚ä»£ç†æœåŠ¡å™¨å¿…é¡»è¿”å›ä¸€ä¸ªProxy-Authenticateç”¨ä»¥è¿›è¡Œèº«ä»½è¯¢é—®ã€‚å®¢æˆ·ç«¯å¯ä»¥è¿”å›ä¸€ä¸ªProxy-Authorizationä¿¡æ¯å¤´ç”¨ä»¥éªŒè¯ã€‚å‚è§RFC 2617ã€‚</p>
<h4 id="408-Request-Timeout"><a href="#408-Request-Timeout" class="headerlink" title="408 Request Timeout"></a>408 Request Timeout</h4><p>â€‹    è¯·æ±‚è¶…æ—¶ã€‚å®¢æˆ·ç«¯æ²¡æœ‰åœ¨æœåŠ¡å™¨é¢„å¤‡ç­‰å¾…çš„æ—¶é—´å†…å®Œæˆä¸€ä¸ªè¯·æ±‚çš„å‘é€ã€‚å®¢æˆ·ç«¯å¯ä»¥éšæ—¶å†æ¬¡æäº¤è¿™ä¸€è¯·æ±‚è€Œæ— éœ€è¿›è¡Œä»»ä½•æ›´æ”¹ã€‚</p>
<h4 id="409-Conflict"><a href="#409-Conflict" class="headerlink" title="409 Conflict"></a>409 Conflict</h4><p>â€‹    ç”±äºå’Œè¢«è¯·æ±‚çš„èµ„æºçš„å½“å‰çŠ¶æ€ä¹‹é—´å­˜åœ¨å†²çªï¼Œè¯·æ±‚æ— æ³•å®Œæˆã€‚è¿™ä¸ªä»£ç åªå…è®¸ç”¨åœ¨è¿™æ ·çš„æƒ…å†µä¸‹æ‰èƒ½è¢«ä½¿ç”¨ï¼šç”¨æˆ·è¢«è®¤ä¸ºèƒ½å¤Ÿè§£å†³å†²çªï¼Œå¹¶ä¸”ä¼šé‡æ–°æäº¤æ–°çš„è¯·æ±‚ã€‚è¯¥å“åº”åº”å½“åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯ä»¥ä¾¿ç”¨æˆ·å‘ç°å†²çªçš„æºå¤´ã€‚</p>
<p>â€‹    å†²çªé€šå¸¸å‘ç”Ÿäºå¯¹PUTè¯·æ±‚çš„å¤„ç†ä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨é‡‡ç”¨ç‰ˆæœ¬æ£€æŸ¥çš„ç¯å¢ƒä¸‹ï¼ŒæŸæ¬¡PUTæäº¤çš„å¯¹ç‰¹å®šèµ„æºçš„ä¿®æ”¹è¯·æ±‚æ‰€é™„å¸¦çš„ç‰ˆæœ¬ä¿¡æ¯ä¸ä¹‹å‰çš„æŸä¸ªï¼ˆç¬¬ä¸‰æ–¹ï¼‰è¯·æ±‚å‘å†²çªï¼Œé‚£ä¹ˆæ­¤æ—¶æœåŠ¡å™¨å°±åº”è¯¥è¿”å›ä¸€ä¸ª409é”™è¯¯ï¼Œå‘ŠçŸ¥ç”¨æˆ·è¯·æ±‚æ— æ³•å®Œæˆã€‚æ­¤æ—¶ï¼Œå“åº”å®ä½“ä¸­å¾ˆå¯èƒ½ä¼šåŒ…å«ä¸¤ä¸ªå†²çªç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚æ¯”è¾ƒï¼Œä»¥ä¾¿ç”¨æˆ·é‡æ–°æäº¤å½’å¹¶ä»¥åçš„æ–°ç‰ˆæœ¬ã€‚</p>
<h4 id="410-Gone"><a href="#410-Gone" class="headerlink" title="410 Gone"></a>410 Gone</h4><p>â€‹    è¢«è¯·æ±‚çš„èµ„æºåœ¨æœåŠ¡å™¨ä¸Šå·²ç»ä¸å†å¯ç”¨ï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å·²çŸ¥çš„è½¬å‘åœ°å€ã€‚è¿™æ ·çš„çŠ¶å†µåº”å½“è¢«è®¤ä¸ºæ˜¯æ°¸ä¹…æ€§çš„ã€‚å¦‚æœå¯èƒ½ï¼Œæ‹¥æœ‰é“¾æ¥ç¼–è¾‘åŠŸèƒ½çš„å®¢æˆ·ç«¯åº”å½“åœ¨è·å¾—ç”¨æˆ·è®¸å¯ååˆ é™¤æ‰€æœ‰æŒ‡å‘è¿™ä¸ªåœ°å€çš„å¼•ç”¨ã€‚å¦‚æœæœåŠ¡å™¨ä¸çŸ¥é“æˆ–è€…æ— æ³•ç¡®å®šè¿™ä¸ªçŠ¶å†µæ˜¯å¦æ˜¯æ°¸ä¹…çš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥ä½¿ç”¨404çŠ¶æ€ç ã€‚é™¤éé¢å¤–è¯´æ˜ï¼Œå¦åˆ™è¿™ä¸ªå“åº”æ˜¯å¯ç¼“å­˜çš„ã€‚</p>
<p>â€‹    410å“åº”çš„ç›®çš„ä¸»è¦æ˜¯å¸®åŠ©ç½‘ç«™ç®¡ç†å‘˜ç»´æŠ¤ç½‘ç«™ï¼Œé€šçŸ¥ç”¨æˆ·è¯¥èµ„æºå·²ç»ä¸å†å¯ç”¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨æ‹¥æœ‰è€…å¸Œæœ›æ‰€æœ‰æŒ‡å‘è¿™ä¸ªèµ„æºçš„è¿œç«¯è¿æ¥ä¹Ÿè¢«åˆ é™¤ã€‚è¿™ç±»äº‹ä»¶åœ¨é™æ—¶ã€å¢å€¼æœåŠ¡ä¸­å¾ˆæ™®éã€‚åŒæ ·ï¼Œ410å“åº”ä¹Ÿè¢«ç”¨äºé€šçŸ¥å®¢æˆ·ç«¯åœ¨å½“å‰æœåŠ¡å™¨ç«™ç‚¹ä¸Šï¼ŒåŸæœ¬å±äºæŸä¸ªä¸ªäººçš„èµ„æºå·²ç»ä¸å†å¯ç”¨ã€‚å½“ç„¶ï¼Œæ˜¯å¦éœ€è¦æŠŠæ‰€æœ‰æ°¸ä¹…ä¸å¯ç”¨çš„èµ„æºæ ‡è®°ä¸ºâ€™410 Goneâ€™ï¼Œä»¥åŠæ˜¯å¦éœ€è¦ä¿æŒæ­¤æ ‡è®°å¤šé•¿æ—¶é—´ï¼Œå®Œå…¨å–å†³äºæœåŠ¡å™¨æ‹¥æœ‰è€…ã€‚</p>
<h4 id="411-Length-Required"><a href="#411-Length-Required" class="headerlink" title="411 Length Required"></a>411 Length Required</h4><p>â€‹    æœåŠ¡å™¨æ‹’ç»åœ¨æ²¡æœ‰å®šä¹‰Content-Lengthå¤´çš„æƒ…å†µä¸‹æ¥å—è¯·æ±‚ã€‚åœ¨æ·»åŠ äº†è¡¨æ˜è¯·æ±‚æ¶ˆæ¯ä½“é•¿åº¦çš„æœ‰æ•ˆContent-Lengthå¤´ä¹‹åï¼Œå®¢æˆ·ç«¯å¯ä»¥å†æ¬¡æäº¤è¯¥è¯·æ±‚ã€‚</p>
<h4 id="412-Precondition-Failed"><a href="#412-Precondition-Failed" class="headerlink" title="412 Precondition Failed"></a>412 Precondition Failed</h4><p>â€‹    æœåŠ¡å™¨åœ¨éªŒè¯åœ¨è¯·æ±‚çš„å¤´å­—æ®µä¸­ç»™å‡ºå…ˆå†³æ¡ä»¶æ—¶ï¼Œæ²¡èƒ½æ»¡è¶³å…¶ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªã€‚è¿™ä¸ªçŠ¶æ€ç å…è®¸å®¢æˆ·ç«¯åœ¨è·å–èµ„æºæ—¶åœ¨è¯·æ±‚çš„å…ƒä¿¡æ¯ï¼ˆè¯·æ±‚å¤´å­—æ®µæ•°æ®ï¼‰ä¸­è®¾ç½®å…ˆå†³æ¡ä»¶ï¼Œä»¥æ­¤é¿å…è¯¥è¯·æ±‚æ–¹æ³•è¢«åº”ç”¨åˆ°å…¶å¸Œæœ›çš„å†…å®¹ä»¥å¤–çš„èµ„æºä¸Šã€‚</p>
<h4 id="413-Request-Entity-Too-Large"><a href="#413-Request-Entity-Too-Large" class="headerlink" title="413 Request Entity Too Large"></a>413 Request Entity Too Large</h4><p>â€‹    æœåŠ¡å™¨æ‹’ç»å¤„ç†å½“å‰è¯·æ±‚ï¼Œå› ä¸ºè¯¥è¯·æ±‚æäº¤çš„å®ä½“æ•°æ®å¤§å°è¶…è¿‡äº†æœåŠ¡å™¨æ„¿æ„æˆ–è€…èƒ½å¤Ÿå¤„ç†çš„èŒƒå›´ã€‚æ­¤ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨å¯ä»¥å…³é—­è¿æ¥ä»¥å…å®¢æˆ·ç«¯ç»§ç»­å‘é€æ­¤è¯·æ±‚ã€‚</p>
<p>â€‹    å¦‚æœè¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼ŒæœåŠ¡å™¨åº”å½“è¿”å›ä¸€ä¸ªRetry-Afterçš„å“åº”å¤´ï¼Œä»¥å‘ŠçŸ¥å®¢æˆ·ç«¯å¯ä»¥åœ¨å¤šå°‘æ—¶é—´ä»¥åé‡æ–°å°è¯•ã€‚</p>
<h4 id="414-Request-URI-Too-Long"><a href="#414-Request-URI-Too-Long" class="headerlink" title="414 Request-URI Too Long"></a>414 Request-URI Too Long</h4><p>â€‹    è¯·æ±‚çš„URIé•¿åº¦è¶…è¿‡äº†æœåŠ¡å™¨èƒ½å¤Ÿè§£é‡Šçš„é•¿åº¦ï¼Œå› æ­¤æœåŠ¡å™¨æ‹’ç»å¯¹è¯¥è¯·æ±‚æä¾›æœåŠ¡ã€‚è¿™æ¯”è¾ƒå°‘è§ï¼Œé€šå¸¸çš„æƒ…å†µåŒ…æ‹¬ï¼š</p>
<p>â€‹        æœ¬åº”ä½¿ç”¨POSTæ–¹æ³•çš„è¡¨å•æäº¤å˜æˆäº†GETæ–¹æ³•ï¼Œå¯¼è‡´æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆQuery Stringï¼‰è¿‡é•¿ã€‚</p>
<p>â€‹        é‡å®šå‘URIâ€œé»‘æ´â€ï¼Œä¾‹å¦‚æ¯æ¬¡é‡å®šå‘æŠŠæ—§çš„URIä½œä¸ºæ–°çš„URIçš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´åœ¨è‹¥å¹²æ¬¡é‡å®šå‘åURIè¶…é•¿ã€‚</p>
<p>â€‹        å®¢æˆ·ç«¯æ­£åœ¨å°è¯•åˆ©ç”¨æŸäº›æœåŠ¡å™¨ä¸­å­˜åœ¨çš„å®‰å…¨æ¼æ´æ”»å‡»æœåŠ¡å™¨ã€‚è¿™ç±»æœåŠ¡å™¨ä½¿ç”¨å›ºå®šé•¿åº¦çš„ç¼“å†²è¯»å–æˆ–æ“ä½œè¯·æ±‚çš„URIï¼Œå½“GETåçš„å‚æ•°è¶…è¿‡æŸä¸ªæ•°å€¼åï¼Œå¯èƒ½ä¼šäº§ç”Ÿç¼“å†²åŒºæº¢å‡ºï¼Œå¯¼è‡´ä»»æ„ä»£ç è¢«æ‰§è¡Œ[1]ã€‚æ²¡æœ‰æ­¤ç±»æ¼æ´çš„æœåŠ¡å™¨ï¼Œåº”å½“è¿”å›414çŠ¶æ€ç ã€‚</p>
<h4 id="415-Unsupported-Media-Type"><a href="#415-Unsupported-Media-Type" class="headerlink" title="415 Unsupported Media Type"></a>415 Unsupported Media Type</h4><p>â€‹    å¯¹äºå½“å‰è¯·æ±‚çš„æ–¹æ³•å’Œæ‰€è¯·æ±‚çš„èµ„æºï¼Œè¯·æ±‚ä¸­æäº¤çš„å®ä½“å¹¶ä¸æ˜¯æœåŠ¡å™¨ä¸­æ‰€æ”¯æŒçš„æ ¼å¼ï¼Œå› æ­¤è¯·æ±‚è¢«æ‹’ç»ã€‚</p>
<p>416 Requested Range Not Satisfiable</p>
<p>â€‹    å¦‚æœè¯·æ±‚ä¸­åŒ…å«äº†Rangeè¯·æ±‚å¤´ï¼Œå¹¶ä¸”Rangeä¸­æŒ‡å®šçš„ä»»ä½•æ•°æ®èŒƒå›´éƒ½ä¸å½“å‰èµ„æºçš„å¯ç”¨èŒƒå›´ä¸é‡åˆï¼ŒåŒæ—¶è¯·æ±‚ä¸­åˆæ²¡æœ‰å®šä¹‰If-Rangeè¯·æ±‚å¤´ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±åº”å½“è¿”å›416çŠ¶æ€ç ã€‚</p>
<p>â€‹    å‡å¦‚Rangeä½¿ç”¨çš„æ˜¯å­—èŠ‚èŒƒå›´ï¼Œé‚£ä¹ˆè¿™ç§æƒ…å†µå°±æ˜¯æŒ‡è¯·æ±‚æŒ‡å®šçš„æ‰€æœ‰æ•°æ®èŒƒå›´çš„é¦–å­—èŠ‚ä½ç½®éƒ½è¶…è¿‡äº†å½“å‰èµ„æºçš„é•¿åº¦ã€‚æœåŠ¡å™¨ä¹Ÿåº”å½“åœ¨è¿”å›416çŠ¶æ€ç çš„åŒæ—¶ï¼ŒåŒ…å«ä¸€ä¸ªContent-Rangeå®ä½“å¤´ï¼Œç”¨ä»¥æŒ‡æ˜å½“å‰èµ„æºçš„é•¿åº¦ã€‚è¿™ä¸ªå“åº”ä¹Ÿè¢«ç¦æ­¢ä½¿ç”¨multipart/byterangesä½œä¸ºå…¶Content-Typeã€‚</p>
<h4 id="417-Expectation-Failed"><a href="#417-Expectation-Failed" class="headerlink" title="417 Expectation Failed"></a>417 Expectation Failed</h4><p>â€‹    åœ¨è¯·æ±‚å¤´Expectä¸­æŒ‡å®šçš„é¢„æœŸå†…å®¹æ— æ³•è¢«æœåŠ¡å™¨æ»¡è¶³ï¼Œæˆ–è€…è¿™ä¸ªæœåŠ¡å™¨æ˜¯ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå®ƒæœ‰æ˜æ˜¾çš„è¯æ®è¯æ˜åœ¨å½“å‰è·¯ç”±çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼ŒExpectçš„å†…å®¹æ— æ³•è¢«æ»¡è¶³ã€‚</p>
<h4 id="418-Iâ€™m-a-teapot"><a href="#418-Iâ€™m-a-teapot" class="headerlink" title="418 Iâ€™m a teapot"></a>418 Iâ€™m a teapot</h4><p>â€‹    æœ¬æ“ä½œç æ˜¯åœ¨1998å¹´ä½œä¸ºIETFçš„ä¼ ç»Ÿæ„šäººèŠ‚ç¬‘è¯, åœ¨RFC 2324è¶…æ–‡æœ¬å’–å•¡å£¶æ§åˆ¶åè®®ä¸­å®šä¹‰çš„ï¼Œå¹¶ä¸éœ€è¦åœ¨çœŸå®çš„HTTPæœåŠ¡å™¨ä¸­å®šä¹‰ã€‚</p>
<h4 id="421-There-are-too-many-connections-from-your-internet-address"><a href="#421-There-are-too-many-connections-from-your-internet-address" class="headerlink" title="421 There are too many connections from your internet address"></a>421 There are too many connections from your internet address</h4><p>â€‹    ä»å½“å‰å®¢æˆ·ç«¯æ‰€åœ¨çš„IPåœ°å€åˆ°æœåŠ¡å™¨çš„è¿æ¥æ•°è¶…è¿‡äº†æœåŠ¡å™¨è®¸å¯çš„æœ€å¤§èŒƒå›´ã€‚é€šå¸¸ï¼Œè¿™é‡Œçš„IPåœ°å€æŒ‡çš„æ˜¯ä»æœåŠ¡å™¨ä¸Šçœ‹åˆ°çš„å®¢æˆ·ç«¯åœ°å€ï¼ˆæ¯”å¦‚ç”¨æˆ·çš„ç½‘å…³æˆ–è€…ä»£ç†æœåŠ¡å™¨åœ°å€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿æ¥æ•°çš„è®¡ç®—å¯èƒ½æ¶‰åŠåˆ°ä¸æ­¢ä¸€ä¸ªç»ˆç«¯ç”¨æˆ·ã€‚</p>
<h4 id="422-Unprocessable-Entity"><a href="#422-Unprocessable-Entity" class="headerlink" title="422 Unprocessable Entity"></a>422 Unprocessable Entity</h4><p>â€‹    è¯·æ±‚æ ¼å¼æ­£ç¡®ï¼Œä½†æ˜¯ç”±äºå«æœ‰è¯­ä¹‰é”™è¯¯ï¼Œæ— æ³•å“åº”ã€‚ï¼ˆRFC 4918 WebDAVï¼‰</p>
<h4 id="423-Locked"><a href="#423-Locked" class="headerlink" title="423 Locked"></a>423 Locked</h4><p>â€‹    å½“å‰èµ„æºè¢«é”å®šã€‚ï¼ˆRFC 4918 WebDAVï¼‰</p>
<h4 id="424-Failed-Dependency"><a href="#424-Failed-Dependency" class="headerlink" title="424 Failed Dependency"></a>424 Failed Dependency</h4><p>â€‹    ç”±äºä¹‹å‰çš„æŸä¸ªè¯·æ±‚å‘ç”Ÿçš„é”™è¯¯ï¼Œå¯¼è‡´å½“å‰è¯·æ±‚å¤±è´¥ï¼Œä¾‹å¦‚PROPPATCHã€‚ï¼ˆRFC 4918 WebDAVï¼‰</p>
<h4 id="425-Unordered-Collection"><a href="#425-Unordered-Collection" class="headerlink" title="425 Unordered Collection"></a>425 Unordered Collection</h4><p>â€‹    åœ¨WebDav Advanced Collectionsè‰æ¡ˆä¸­å®šä¹‰ï¼Œä½†æ˜¯æœªå‡ºç°åœ¨ã€ŠWebDAVé¡ºåºé›†åè®®ã€‹ï¼ˆRFC 3658ï¼‰ä¸­ã€‚</p>
<h4 id="426-Upgrade-Required"><a href="#426-Upgrade-Required" class="headerlink" title="426 Upgrade Required"></a>426 Upgrade Required</h4><p>â€‹    å®¢æˆ·ç«¯åº”å½“åˆ‡æ¢åˆ°TLS/1.0ã€‚ï¼ˆRFC 2817ï¼‰</p>
<h4 id="449-Retry-With"><a href="#449-Retry-With" class="headerlink" title="449 Retry With"></a>449 Retry With</h4><p>â€‹    ç”±å¾®è½¯æ‰©å±•ï¼Œä»£è¡¨è¯·æ±‚åº”å½“åœ¨æ‰§è¡Œå®Œé€‚å½“çš„æ“ä½œåè¿›è¡Œé‡è¯•ã€‚</p>
<h3 id="5xxæœåŠ¡å™¨é”™è¯¯"><a href="#5xxæœåŠ¡å™¨é”™è¯¯" class="headerlink" title="5xxæœåŠ¡å™¨é”™è¯¯"></a>5xxæœåŠ¡å™¨é”™è¯¯</h3><p>â€‹    è¿™ç±»çŠ¶æ€ç ä»£è¡¨äº†æœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­æœ‰é”™è¯¯æˆ–è€…å¼‚å¸¸çŠ¶æ€å‘ç”Ÿï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æœåŠ¡å™¨æ„è¯†åˆ°ä»¥å½“å‰çš„è½¯ç¡¬ä»¶èµ„æºæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚é™¤éè¿™æ˜¯ä¸€ä¸ªHEADè¯·æ±‚ï¼Œå¦åˆ™æœåŠ¡å™¨åº”å½“åŒ…å«ä¸€ä¸ªè§£é‡Šå½“å‰é”™è¯¯çŠ¶æ€ä»¥åŠè¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„è¿˜æ˜¯æ°¸ä¹…çš„è§£é‡Šä¿¡æ¯å®ä½“ã€‚æµè§ˆå™¨åº”å½“å‘ç”¨æˆ·å±•ç¤ºä»»ä½•åœ¨å½“å‰å“åº”ä¸­è¢«åŒ…å«çš„å®ä½“ã€‚</p>
<p>â€‹    è¿™äº›çŠ¶æ€ç é€‚ç”¨äºä»»ä½•å“åº”æ–¹æ³•ã€‚</p>
<h4 id="500-Internal-Server-Error"><a href="#500-Internal-Server-Error" class="headerlink" title="500 Internal Server Error"></a>500 Internal Server Error</h4><p>â€‹    æœåŠ¡å™¨é‡åˆ°äº†ä¸€ä¸ªæœªæ›¾é¢„æ–™çš„çŠ¶å†µï¼Œå¯¼è‡´äº†å®ƒæ— æ³•å®Œæˆå¯¹è¯·æ±‚çš„å¤„ç†ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªé—®é¢˜éƒ½ä¼šåœ¨æœåŠ¡å™¨çš„ç¨‹åºç å‡ºé”™æ—¶å‡ºç°ã€‚</p>
<h4 id="501-Not-Implemented"><a href="#501-Not-Implemented" class="headerlink" title="501 Not Implemented"></a>501 Not Implemented</h4><p>â€‹    æœåŠ¡å™¨ä¸æ”¯æŒå½“å‰è¯·æ±‚æ‰€éœ€è¦çš„æŸä¸ªåŠŸèƒ½ã€‚å½“æœåŠ¡å™¨æ— æ³•è¯†åˆ«è¯·æ±‚çš„æ–¹æ³•ï¼Œå¹¶ä¸”æ— æ³•æ”¯æŒå…¶å¯¹ä»»ä½•èµ„æºçš„è¯·æ±‚ã€‚</p>
<h4 id="502-Bad-Gateway"><a href="#502-Bad-Gateway" class="headerlink" title="502 Bad Gateway"></a>502 Bad Gateway</h4><p>â€‹    ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥æ”¶åˆ°æ— æ•ˆçš„å“åº”ã€‚</p>
<h4 id="503-Service-Unavailable"><a href="#503-Service-Unavailable" class="headerlink" title="503 Service Unavailable"></a>503 Service Unavailable</h4><p>â€‹    ç”±äºä¸´æ—¶çš„æœåŠ¡å™¨ç»´æŠ¤æˆ–è€…è¿‡è½½ï¼ŒæœåŠ¡å™¨å½“å‰æ— æ³•å¤„ç†è¯·æ±‚ã€‚è¿™ä¸ªçŠ¶å†µæ˜¯ä¸´æ—¶çš„ï¼Œå¹¶ä¸”å°†åœ¨ä¸€æ®µæ—¶é—´ä»¥åæ¢å¤ã€‚å¦‚æœèƒ½å¤Ÿé¢„è®¡å»¶è¿Ÿæ—¶é—´ï¼Œé‚£ä¹ˆå“åº”ä¸­å¯ä»¥åŒ…å«ä¸€ä¸ªRetry-Afterå¤´ç”¨ä»¥æ ‡æ˜è¿™ä¸ªå»¶è¿Ÿæ—¶é—´ã€‚å¦‚æœæ²¡æœ‰ç»™å‡ºè¿™ä¸ªRetry-Afterä¿¡æ¯ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åº”å½“ä»¥å¤„ç†500å“åº”çš„æ–¹å¼å¤„ç†å®ƒã€‚</p>
<h4 id="504-Gateway-Timeout"><a href="#504-Gateway-Timeout" class="headerlink" title="504 Gateway Timeout"></a>504 Gateway Timeout</h4><p>â€‹    ä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œæœªèƒ½åŠæ—¶ä»ä¸Šæ¸¸æœåŠ¡å™¨ï¼ˆURIæ ‡è¯†å‡ºçš„æœåŠ¡å™¨ï¼Œä¾‹å¦‚HTTPã€FTPã€LDAPï¼‰æˆ–è€…è¾…åŠ©æœåŠ¡å™¨ï¼ˆä¾‹å¦‚DNSï¼‰æ”¶åˆ°å“åº”ã€‚</p>
<p>â€‹    æ³¨æ„ï¼šæŸäº›ä»£ç†æœåŠ¡å™¨åœ¨DNSæŸ¥è¯¢è¶…æ—¶æ—¶ä¼šè¿”å›400æˆ–è€…500é”™è¯¯</p>
<h4 id="505-HTTP-Version-Not-Supported"><a href="#505-HTTP-Version-Not-Supported" class="headerlink" title="505 HTTP Version Not Supported"></a>505 HTTP Version Not Supported</h4><p>â€‹    æœåŠ¡å™¨ä¸æ”¯æŒï¼Œæˆ–è€…æ‹’ç»æ”¯æŒåœ¨è¯·æ±‚ä¸­ä½¿ç”¨çš„HTTPç‰ˆæœ¬ã€‚è¿™æš—ç¤ºç€æœåŠ¡å™¨ä¸èƒ½æˆ–ä¸æ„¿ä½¿ç”¨ä¸å®¢æˆ·ç«¯ç›¸åŒçš„ç‰ˆæœ¬ã€‚å“åº”ä¸­åº”å½“åŒ…å«ä¸€ä¸ªæè¿°äº†ä¸ºä½•ç‰ˆæœ¬ä¸è¢«æ”¯æŒä»¥åŠæœåŠ¡å™¨æ”¯æŒå“ªäº›åè®®çš„å®ä½“ã€‚</p>
<h4 id="506-Variant-Also-Negotiates"><a href="#506-Variant-Also-Negotiates" class="headerlink" title="506 Variant Also Negotiates"></a>506 Variant Also Negotiates</h4><p>â€‹    ç”±ã€Šé€æ˜å†…å®¹åå•†åè®®ã€‹ï¼ˆRFC 2295ï¼‰æ‰©å±•ï¼Œä»£è¡¨æœåŠ¡å™¨å­˜åœ¨å†…éƒ¨é…ç½®é”™è¯¯ï¼šè¢«è¯·æ±‚çš„åå•†å˜å…ƒèµ„æºè¢«é…ç½®ä¸ºåœ¨é€æ˜å†…å®¹åå•†ä¸­ä½¿ç”¨è‡ªå·±ï¼Œå› æ­¤åœ¨ä¸€ä¸ªåå•†å¤„ç†ä¸­ä¸æ˜¯ä¸€ä¸ªåˆé€‚çš„é‡ç‚¹ã€‚</p>
<h4 id="507-Insufficient-Storage"><a href="#507-Insufficient-Storage" class="headerlink" title="507 Insufficient Storage"></a>507 Insufficient Storage</h4><p>â€‹    æœåŠ¡å™¨æ— æ³•å­˜å‚¨å®Œæˆè¯·æ±‚æ‰€å¿…é¡»çš„å†…å®¹ã€‚è¿™ä¸ªçŠ¶å†µè¢«è®¤ä¸ºæ˜¯ä¸´æ—¶çš„ã€‚WebDAVï¼ˆRFC 4918ï¼‰</p>
<h4 id="509-Bandwidth-Limit-Exceeded"><a href="#509-Bandwidth-Limit-Exceeded" class="headerlink" title="509 Bandwidth Limit Exceeded"></a>509 Bandwidth Limit Exceeded</h4><p>â€‹    æœåŠ¡å™¨è¾¾åˆ°å¸¦å®½é™åˆ¶ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªå®˜æ–¹çš„çŠ¶æ€ç ï¼Œä½†æ˜¯ä»è¢«å¹¿æ³›ä½¿ç”¨ã€‚</p>
<h4 id="510-Not-Extended"><a href="#510-Not-Extended" class="headerlink" title="510 Not Extended"></a>510 Not Extended</h4><p>â€‹    è·å–èµ„æºæ‰€éœ€è¦çš„ç­–ç•¥å¹¶æ²¡æœ‰æ²¡æ»¡è¶³ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>GCD (Grand Central Dispatch)</title>
    <url>/2016/01/13/GCD%EF%BC%88Grand%20Central%20Dispatch%EF%BC%89/</url>
    <content><![CDATA[<p>è½¬è½½è‡ª <a href="https://github.com/ming1016" target="_blank" rel="noopener">æˆ´é“­è€å¸ˆ</a></p>
<p>æ–‡ä¸­è¾ƒè¯¦ç»†ä»‹ç»GCDé˜Ÿåˆ—ï¼Œå„ç§GCDä½¿ç”¨æ–¹æ³•ï¼Œå®ä¾‹å¦‚ä½•ä½¿ç”¨Dispatch Sourceç›‘å¬ç³»ç»Ÿåº•å±‚å¯¹è±¡ï¼Œåˆ†æä¸åŒé”çš„æ€§èƒ½å¯¹æ¯”ï¼Œå®ä¾‹GCDæ­»é”æƒ…å†µã€‚ </p>
<p>æ–‡ä¸­çš„Demoåœ¨è¿™é‡Œ <a href="https://github.com/ming1016/GCDDemo" target="_blank" rel="noopener">https://github.com/ming1016/GCDDemo</a> å¯¹ç€æ–‡ç« è¯•ç€æ¥è°ƒdemoä½“ä¼šæ›´æ·±å“¦ï¼Œç»†ç»†åš¼æ¶ˆåŒ–å¥½ğŸ¤“</p>
<a id="more"></a>



<blockquote>
<p>å®˜æ–¹æ–‡æ¡£ï¼š</p>
<p><a href="https://developer.apple.com/library/prerelease/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/" target="_blank" rel="noopener">https://developer.apple.com/library/prerelease/ios/documentation/Performance/Reference/GCD_libdispatch_Ref/</a></p>
<p>GCDå±äºç³»ç»Ÿçº§çš„çº¿ç¨‹ç®¡ç†ï¼Œåœ¨Dispatch queueä¸­æ‰§è¡Œéœ€è¦æ‰§è¡Œçš„ä»»åŠ¡æ€§èƒ½éå¸¸çš„é«˜ã€‚ GCDè¿™å—å·²ç»å¼€æºï¼Œåœ°å€<a href="http://libdispatch.macosforge.org" target="_blank" rel="noopener">http://libdispatch.macosforge.org</a>ã€‚</p>
<p><strong>GCDä¸­çš„FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰é˜Ÿåˆ—ç§°ä¸ºdispatch queueï¼Œç”¨æ¥ä¿è¯å…ˆè¿›æ¥çš„ä»»åŠ¡å…ˆå¾—åˆ°æ‰§è¡Œã€‚</strong></p>
</blockquote>
<h2 id="GCDæ¦‚è¦"><a href="#GCDæ¦‚è¦" class="headerlink" title="GCDæ¦‚è¦"></a>GCDæ¦‚è¦</h2><ol>
<li><p>å’Œoperation queueä¸€æ ·éƒ½æ˜¯åŸºäºé˜Ÿåˆ—çš„å¹¶å‘ç¼–ç¨‹APIï¼Œä»–ä»¬é€šè¿‡é›†ä¸­ç®¡ç†å¤§å®¶ååŒä½¿ç”¨çš„çº¿ç¨‹æ± ã€‚</p>
</li>
<li><p><strong>å…¬å¼€çš„5ä¸ªä¸åŒé˜Ÿåˆ—</strong>ï¼šè¿è¡Œåœ¨ä¸»çº¿ç¨‹ä¸­çš„main queueï¼Œ3ä¸ªä¸åŒä¼˜å…ˆçº§çš„åå°é˜Ÿåˆ—ï¼ˆHigh Priority Queueï¼ŒDefault Priority Queueï¼ŒLow Priority Queueï¼‰ï¼Œä»¥åŠä¸€ä¸ªä¼˜å…ˆçº§æ›´ä½çš„åå°é˜Ÿåˆ—Background Priority Queueï¼ˆç”¨äºI/Oï¼‰ã€‚</p>
</li>
<li><p>å¯åˆ›å»ºè‡ªå®šä¹‰é˜Ÿåˆ—ï¼š<strong>ä¸²è¡Œ</strong>æˆ–<strong>å¹¶åˆ—</strong>é˜Ÿåˆ—ã€‚<strong>è‡ªå®šä¹‰ä¸€èˆ¬æ”¾åœ¨Default Priority Queueå’ŒMain Queueé‡Œ</strong>ã€‚</p>
</li>
<li><p>æ“ä½œæ˜¯åœ¨å¤šçº¿ç¨‹ä¸Šè¿˜æ˜¯å•çº¿ç¨‹ä¸»è¦æ˜¯çœ‹é˜Ÿåˆ—çš„ç±»å‹å’Œæ‰§è¡Œæ–¹æ³•ï¼Œ<strong>å¹¶è¡Œé˜Ÿåˆ—å¼‚æ­¥æ‰§è¡Œæ‰èƒ½åœ¨å¤šçº¿ç¨‹ï¼Œå¹¶è¡Œé˜Ÿåˆ—åŒæ­¥æ‰§è¡Œå°±åªä¼šåœ¨ä¸»çº¿ç¨‹æ‰§è¡Œäº†</strong>ã€‚</p>
</li>
</ol>
<h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><h4 id="ä¸€ã€-ç³»ç»Ÿæ ‡å‡†ä¸¤ä¸ªé˜Ÿåˆ—"><a href="#ä¸€ã€-ç³»ç»Ÿæ ‡å‡†ä¸¤ä¸ªé˜Ÿåˆ—" class="headerlink" title="ä¸€ã€ ç³»ç»Ÿæ ‡å‡†ä¸¤ä¸ªé˜Ÿåˆ—"></a>ä¸€ã€ ç³»ç»Ÿæ ‡å‡†ä¸¤ä¸ªé˜Ÿåˆ—</h4><p>â€‹    //å…¨å±€é˜Ÿåˆ—ï¼Œä¸€ä¸ªå¹¶è¡Œçš„é˜Ÿåˆ—</p>
<p>â€‹    <code>dispatch_get_global_queue</code></p>
<p>â€‹    //ä¸»é˜Ÿåˆ—ï¼Œä¸»çº¿ç¨‹ä¸­çš„å”¯ä¸€é˜Ÿåˆ—ï¼Œä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—</p>
<p>â€‹    <code>dispatch_get_main_queue</code></p>
<h4 id="äºŒã€è‡ªå®šä¹‰é˜Ÿåˆ—"><a href="#äºŒã€è‡ªå®šä¹‰é˜Ÿåˆ—" class="headerlink" title="äºŒã€è‡ªå®šä¹‰é˜Ÿåˆ—"></a>äºŒã€è‡ªå®šä¹‰é˜Ÿåˆ—</h4><p>â€‹    //ä¸²è¡Œé˜Ÿåˆ—</p>
<p>â€‹    <code>dispatch_queue_create(&quot;com.starming.serialqueue&quot;, DISPATCH_QUEUE_SERIAL)</code></p>
<p>â€‹    //å¹¶è¡Œé˜Ÿåˆ—</p>
<p>â€‹    <code>dispatch_queue_create(&quot;com.starming.concurrentqueue&quot;, DISPATCH_QUEUE_CONCURRENT)</code></p>
<h4 id="ä¸‰ã€åŒæ­¥å¼‚æ­¥çº¿ç¨‹åˆ›å»º"><a href="#ä¸‰ã€åŒæ­¥å¼‚æ­¥çº¿ç¨‹åˆ›å»º" class="headerlink" title="ä¸‰ã€åŒæ­¥å¼‚æ­¥çº¿ç¨‹åˆ›å»º"></a>ä¸‰ã€åŒæ­¥å¼‚æ­¥çº¿ç¨‹åˆ›å»º</h4><p>â€‹    //åŒæ­¥çº¿ç¨‹</p>
<p>â€‹    <code>dispatch_sync(..., ^(block))</code></p>
<p>â€‹    //å¼‚æ­¥çº¿ç¨‹</p>
<p>â€‹    <code>dispatch_async(..., ^(block))</code></p>
<h2 id="é˜Ÿåˆ—ï¼ˆdispatch-queueï¼‰"><a href="#é˜Ÿåˆ—ï¼ˆdispatch-queueï¼‰" class="headerlink" title="é˜Ÿåˆ—ï¼ˆdispatch queueï¼‰"></a>é˜Ÿåˆ—ï¼ˆdispatch queueï¼‰</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><h4 id="ä¸€ã€dispatch-get-global-queue"><a href="#ä¸€ã€dispatch-get-global-queue" class="headerlink" title="ä¸€ã€dispatch_get_global_queue"></a>ä¸€ã€dispatch_get_global_queue</h4><ol>
<li>Serialï¼šåˆå«private dispatch queuesï¼ŒåŒæ—¶åªæ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚Serial queueå¸¸ç”¨äºåŒæ­¥è®¿é—®ç‰¹å®šçš„èµ„æºæˆ–æ•°æ®ã€‚ å½“ä½ åˆ›å»ºå¤šä¸ªSerial queueæ—¶ï¼Œè™½ç„¶å„è‡ªæ˜¯åŒæ­¥ï¼Œä½†serial queueä¹‹é—´æ˜¯å¹¶å‘æ‰§è¡Œã€‚ </li>
<li>Main dispatch queueï¼š<strong>å…¨å±€å¯ç”¨çš„serial queue</strong>ï¼Œåœ¨åº”ç”¨ç¨‹åº<strong>ä¸»çº¿ç¨‹ä¸Š</strong>æ‰§è¡Œä»»åŠ¡ã€‚</li>
<li>Concurrentï¼šåˆå«global dispatch queueï¼Œå¯ä»¥å¹¶å‘çš„æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œ<strong>ä½†æ‰§è¡Œå®Œæˆé¡ºåºæ˜¯éšæœºçš„</strong>ã€‚ç³»ç»Ÿæä¾›å››ä¸ªå…¨å±€å¹¶å‘é˜Ÿåˆ—ï¼Œè¿™å››ä¸ªé˜Ÿåˆ—æœ‰è¿™å¯¹åº”çš„ä¼˜å…ˆçº§ï¼Œ<strong>ç”¨æˆ·æ˜¯ä¸èƒ½å¤Ÿåˆ›å»ºå…¨å±€é˜Ÿåˆ—çš„ï¼Œåªèƒ½è·å–</strong>ã€‚ </li>
</ol>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">dipatch_queue_t queue;</span><br><span class="line">queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH,<span class="number">0</span>);</span><br></pre></td></tr></table></figure>



<h4 id="äºŒã€dispatch-queue-create"><a href="#äºŒã€dispatch-queue-create" class="headerlink" title="äºŒã€dispatch_queue_create"></a>äºŒã€dispatch_queue_create</h4><ol>
<li>user create queueï¼šåˆ›å»ºè‡ªå·±å®šä¹‰çš„é˜Ÿåˆ—ï¼Œå¯ä»¥ç”¨dispatch_queue_createå‡½æ•°ã€‚</li>
<li>å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè‡ªå®šä¹‰çš„é˜Ÿåˆ—åï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯é˜Ÿåˆ—ç±»å‹ï¼Œé»˜è®¤NULLæˆ–è€… DISPATCH_QUEUE_SERIAL çš„æ˜¯ä¸²è¡Œï¼Œå‚æ•°ä¸º DISPATCH_QUEUE_CONCURRENT ä¸ºå¹¶è¡Œé˜Ÿåˆ—ã€‚</li>
</ol>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">dispatch_queue_t</span> queue;</span><br><span class="line">queue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.concurrentqueue"</span>, DISPATCH_QUEUE_CONCURRENT);</span><br></pre></td></tr></table></figure>



<h4 id="ä¸‰ã€é˜Ÿåˆ—ä¼˜å…ˆçº§"><a href="#ä¸‰ã€é˜Ÿåˆ—ä¼˜å…ˆçº§" class="headerlink" title="ä¸‰ã€é˜Ÿåˆ—ä¼˜å…ˆçº§"></a>ä¸‰ã€é˜Ÿåˆ—ä¼˜å…ˆçº§</h4><ol>
<li>è‡ªå®šä¹‰é˜Ÿåˆ—çš„ä¼˜å…ˆçº§ï¼šå¯ä»¥é€šè¿‡dipatch_queue_attr_make_with_qos_classæˆ–dispatch_set_target_queueæ–¹æ³•è®¾ç½®é˜Ÿåˆ—çš„ä¼˜å…ˆçº§</li>
</ol>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//dipatch_queue_attr_make_with_qos_class</span></span><br><span class="line">dispatch_queue_attr_t attr = dispatch_queue_attr_make_with_qos_class(DISPATCH_QUEUE_SERIAL, </span><br><span class="line">                                                                     QOS_CLASS_UTILITY, <span class="number">-1</span>);</span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.qosqueue"</span>, attr);</span><br><span class="line"></span><br><span class="line"><span class="comment">//dispatch_set_target_queue</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> queue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.settargetqueue"</span>,</span><br><span class="line">                                               <span class="literal">NULL</span>); <span class="comment">//éœ€è¦è®¾ç½®ä¼˜å…ˆçº§çš„queue</span></span><br><span class="line"><span class="built_in">dispatch_queue_t</span> referQueue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, </span><br><span class="line">                                                        <span class="number">0</span>); <span class="comment">//å‚è€ƒä¼˜å…ˆçº§</span></span><br><span class="line">dispatch_set_target_queue(queue, referQueue); <span class="comment">//è®¾ç½®queueå’ŒreferQueueçš„ä¼˜å…ˆçº§ä¸€æ ·</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>dispatch_set_target_queueï¼šå¯ä»¥è®¾ç½®ä¼˜å…ˆçº§ï¼Œä¹Ÿå¯ä»¥è®¾ç½®é˜Ÿåˆ—å±‚çº§ä½“ç³»ï¼Œæ¯”å¦‚è®©å¤šä¸ªä¸²è¡Œå’Œå¹¶è¡Œé˜Ÿåˆ—åœ¨ç»Ÿä¸€ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—é‡Œä¸²è¡Œæ‰§è¡Œï¼Œå¦‚ä¸‹</li>
</ol>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">dispatch_queue_t</span> serialQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.serialqueue"</span>, </span><br><span class="line">                                                     DISPATCH_QUEUE_SERIAL);</span><br><span class="line"><span class="built_in">dispatch_queue_t</span> firstQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.firstqueue"</span>, </span><br><span class="line">                                                    DISPATCH_QUEUE_SERIAL);</span><br><span class="line"><span class="built_in">dispatch_queue_t</span> secondQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.secondqueue"</span>, </span><br><span class="line">                                                     DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line"></span><br><span class="line">dispatch_set_target_queue(firstQueue, serialQueue);</span><br><span class="line">dispatch_set_target_queue(secondQueue, serialQueue);</span><br><span class="line"></span><br><span class="line"><span class="built_in">dispatch_async</span>(firstQueue, ^&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">  [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">3.</span>f];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">dispatch_async</span>(secondQueue, ^&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">  [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">2.</span>f];</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">dispatch_async</span>(secondQueue, ^&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"3"</span>);</span><br><span class="line">  [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1.</span>f];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h3 id="é˜Ÿåˆ—ç±»å‹"><a href="#é˜Ÿåˆ—ç±»å‹" class="headerlink" title="é˜Ÿåˆ—ç±»å‹"></a>é˜Ÿåˆ—ç±»å‹</h3><p><strong>é˜Ÿåˆ—é»˜è®¤æ˜¯ä¸²è¡Œçš„ï¼Œå¦‚æœè®¾ç½®è¯¥å‚æ•°ä¸ºNULLä¼šæŒ‰ä¸²è¡Œå¤„ç†ï¼Œåªèƒ½æ‰§è¡Œä¸€ä¸ªå•ç‹¬çš„blockï¼Œé˜Ÿåˆ—ä¹Ÿå¯ä»¥æ˜¯å¹¶è¡Œçš„ï¼ŒåŒä¸€æ—¶é—´æ‰§è¡Œå¤šä¸ªblock</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)init &#123;</span><br><span class="line">  <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">self</span> != <span class="literal">nil</span>) &#123;</span><br><span class="line">    <span class="built_in">NSString</span> *label = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@.isolation.%p"</span>, [<span class="keyword">self</span> <span class="keyword">class</span>], <span class="keyword">self</span>];</span><br><span class="line">    <span class="keyword">self</span>.isolationQueue = dispatch_queue_create([label UTF8String], <span class="number">0</span>);</span><br><span class="line">    label = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%@.work.%p"</span>, [<span class="keyword">self</span> <span class="keyword">class</span>], <span class="keyword">self</span>];</span><br><span class="line">    <span class="keyword">self</span>.workQueue = dispatch_queue_create([label UTF8String], <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="ä¸€ã€5ç§é˜Ÿåˆ—"><a href="#ä¸€ã€5ç§é˜Ÿåˆ—" class="headerlink" title="ä¸€ã€5ç§é˜Ÿåˆ—"></a>ä¸€ã€5ç§é˜Ÿåˆ—</h4><p>ä¸»é˜Ÿåˆ—ï¼ˆmain queueï¼‰, å››ç§é€šç”¨è°ƒåº¦é˜Ÿåˆ—ï¼Œè‡ªå·±å®šåˆ¶çš„é˜Ÿåˆ—ã€‚å››ç§é€šç”¨è°ƒåº¦é˜Ÿåˆ—ä¸º ï¼š</p>
<ol>
<li><p><strong>QOS_CLASS_USER_INTERACTIVE</strong>ï¼šuser interactiveç­‰çº§è¡¨ç¤ºä»»åŠ¡éœ€è¦è¢«ç«‹å³æ‰§è¡Œæä¾›å¥½çš„ä½“éªŒï¼Œç”¨æ¥æ›´æ–°UIï¼Œå“åº”äº‹ä»¶ç­‰ã€‚è¿™ä¸ªç­‰çº§æœ€å¥½ä¿æŒå°è§„æ¨¡ã€‚ </p>
</li>
<li><p><strong>QOS_CLASS_USER_INITIATED</strong>ï¼šuser initiatedç­‰çº§è¡¨ç¤ºä»»åŠ¡ç”±UIå‘èµ·å¼‚æ­¥æ‰§è¡Œã€‚é€‚ç”¨åœºæ™¯æ˜¯éœ€è¦åŠæ—¶ç»“æœåŒæ—¶åˆå¯ä»¥ç»§ç»­äº¤äº’çš„æ—¶å€™ã€‚</p>
</li>
<li><p><strong>QOS_CLASS_UTILITY</strong>ï¼šutilityç­‰çº§è¡¨ç¤ºéœ€è¦é•¿æ—¶é—´è¿è¡Œçš„ä»»åŠ¡ï¼Œä¼´æœ‰ç”¨æˆ·å¯è§è¿›åº¦æŒ‡ç¤ºå™¨ã€‚ç»å¸¸ä¼šç”¨æ¥åšè®¡ç®—ï¼ŒI/Oï¼Œç½‘ç»œï¼ŒæŒç»­çš„æ•°æ®å¡«å……ç­‰ä»»åŠ¡ã€‚è¿™ä¸ªä»»åŠ¡èŠ‚èƒ½ã€‚ </p>
</li>
<li><p><strong>QOS_CLASS_BACKGROUND</strong>ï¼šbackgroundç­‰çº§è¡¨ç¤ºç”¨æˆ·ä¸ä¼šå¯Ÿè§‰çš„ä»»åŠ¡ï¼Œä½¿ç”¨å®ƒæ¥å¤„ç†é¢„åŠ è½½ï¼Œ æˆ–è€…ä¸éœ€è¦ç”¨æˆ·äº¤äº’å’Œå¯¹æ—¶é—´ä¸æ•æ„Ÿçš„ä»»åŠ¡ã€‚ </p>
</li>
</ol>
<p><strong>ç¤ºä¾‹ï¼šåå°åŠ è½½æ˜¾ç¤ºå›¾ç‰‡</strong></p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">  dispatch_async(dispatch_get_global_queue(<span class="type">Int</span>(<span class="type">QOS_CLASS_USER_INITIATED</span>.value), <span class="number">0</span>)) &#123;</span><br><span class="line">	<span class="comment">// å°†å·¥ä½œä»ä¸»çº¿ç¨‹è½¬ç§»åˆ°å…¨å±€é˜Ÿåˆ—ä¸­ï¼Œè¿™æ˜¯dispatch_asyncè°ƒç”¨ï¼Œå¼‚æ­¥æäº¤ä¿è¯è°ƒç”¨çº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œä¸‹å»ï¼Œè¿™æ ·viewDidLoadåœ¨ä¸»çº¿ç¨‹ä¸Šèƒ½å¤Ÿæ›´æ—©å®Œæˆï¼Œ</span></span><br><span class="line">    <span class="keyword">let</span> overlayImage = <span class="keyword">self</span>.faceOverlayImageFromImage(<span class="keyword">self</span>.image)</span><br><span class="line">		dispatch_async(dispatch_get_main_queue()) &#123;</span><br><span class="line">      <span class="comment">// æ–°å›¾å®Œæˆï¼ŒæŠŠä¸€ä¸ªé—­åŒ…åŠ å…¥ä¸»çº¿ç¨‹ç”¨æ¥æ›´æ–°UIImageViewï¼Œåªæœ‰åœ¨ä¸»çº¿ç¨‹èƒ½æ“ä½œUIKitã€‚</span></span><br><span class="line">      <span class="keyword">self</span>.fadeInNewImage(overlayImage) <span class="comment">// æ›´æ–°UI</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="äºŒã€ä½•æ—¶ä½¿ç”¨ä½•ç§é˜Ÿåˆ—ç±»å‹"><a href="#äºŒã€ä½•æ—¶ä½¿ç”¨ä½•ç§é˜Ÿåˆ—ç±»å‹" class="headerlink" title="äºŒã€ä½•æ—¶ä½¿ç”¨ä½•ç§é˜Ÿåˆ—ç±»å‹"></a>äºŒã€ä½•æ—¶ä½¿ç”¨ä½•ç§é˜Ÿåˆ—ç±»å‹</h4><ol>
<li>ä¸»é˜Ÿåˆ—ï¼ˆé¡ºåºï¼‰ï¼š<strong>é˜Ÿåˆ—ä¸­æœ‰ä»»åŠ¡å®Œæˆéœ€è¦æ›´æ–°UIæ—¶ï¼Œdispatch_afteråœ¨è¿™ç§ç±»å‹ä¸­ä½¿ç”¨</strong>ã€‚</li>
<li>å¹¶å‘é˜Ÿåˆ—ï¼š<strong>ç”¨æ¥æ‰§è¡Œä¸UIæ— å…³çš„åå°ä»»åŠ¡</strong>ï¼Œdispatch_syncæ”¾åœ¨è¿™é‡Œï¼Œæ–¹ä¾¿ç­‰å¾…ä»»åŠ¡ï¼Œå®Œæˆè¿›è¡Œåç»­å¤„ç†æˆ–å’Œdispatch barrieråŒæ­¥ã€‚dispatch groupsæ”¾åœ¨è¿™é‡Œä¹Ÿä¸é”™ã€‚</li>
<li>è‡ªå®šä¹‰é¡ºåºé˜Ÿåˆ—ï¼šé¡ºåºæ‰§è¡Œåå°ä»»åŠ¡å¹¶è¿½è¸ªå®ƒæ—¶ã€‚è¿™æ ·åšåŒæ—¶åªæœ‰ä¸€ä¸ªä»»åŠ¡åœ¨æ‰§è¡Œå¯ä»¥é˜²æ­¢èµ„æºç«äº‰ã€‚dipatch barriersè§£å†³è¯»å†™é”é—®é¢˜çš„æ”¾åœ¨è¿™é‡Œå¤„ç†ã€‚dispatch groupsä¹Ÿæ˜¯æ”¾åœ¨è¿™é‡Œã€‚ </li>
</ol>
<h4 id="ä¸‰ã€QoSç­‰çº§å‚æ•°çš„å†™æ³•"><a href="#ä¸‰ã€QoSç­‰çº§å‚æ•°çš„å†™æ³•" class="headerlink" title="ä¸‰ã€QoSç­‰çº§å‚æ•°çš„å†™æ³•"></a>ä¸‰ã€QoSç­‰çº§å‚æ•°çš„å†™æ³•</h4><p>å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•ç®€åŒ–QoSç­‰çº§å‚æ•°çš„å†™æ³• </p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="type">GlobalMainQueue</span>: dispatch_queue_t &#123;</span><br><span class="line">  <span class="keyword">return</span> dispatch_get_main_queue()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="type">GlobalUserInteractiveQueue</span>: dispatch_queue_t &#123;</span><br><span class="line">  <span class="keyword">return</span> dispatch_get_global_queue(<span class="type">Int</span>(<span class="type">QOS_CLASS_USER_INTERACTIVE</span>.value), <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="type">GlobalUserInitiatedQueue</span>: dispatch_queue_t &#123;</span><br><span class="line">  <span class="keyword">return</span> dispatch_get_global_queue(<span class="type">Int</span>(<span class="type">QOS_CLASS_USER_INITIATED</span>.value), <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="type">GlobalUtilityQueue</span>: dispatch_queue_t &#123;</span><br><span class="line">  <span class="keyword">return</span> dispatch_get_global_queue(<span class="type">Int</span>(<span class="type">QOS_CLASS_UTILITY</span>.value), <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="type">GlobalBackgroundQueue</span>: dispatch_queue_t &#123;</span><br><span class="line">  <span class="keyword">return</span> dispatch_get_global_queue(<span class="type">Int</span>(<span class="type">QOS_CLASS_BACKGROUND</span>.value), <span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨èµ·æ¥å°±æ˜¯è¿™æ ·ï¼Œæ˜“è¯»è€Œä¸”å®¹æ˜“çœ‹å‡ºåœ¨ä½¿ç”¨å“ªä¸ªé˜Ÿåˆ—</span></span><br><span class="line">dispatch_async(<span class="type">GlobalUserInitiatedQueue</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> overlayImage = <span class="keyword">self</span>.faceOverlayImageFromImage(<span class="keyword">self</span>.image)</span><br><span class="line">  dispatch_async(<span class="type">GlobalMainQueue</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.fadeInNewImage(overlayImage)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><h3 id="ç®€å•ä½¿ç”¨å’Œä»‹ç»"><a href="#ç®€å•ä½¿ç”¨å’Œä»‹ç»" class="headerlink" title="ç®€å•ä½¿ç”¨å’Œä»‹ç»"></a>ç®€å•ä½¿ç”¨å’Œä»‹ç»</h3><h4 id="ä¸€ã€dispatch-onceç”¨æ³•"><a href="#ä¸€ã€dispatch-onceç”¨æ³•" class="headerlink" title="ä¸€ã€dispatch_onceç”¨æ³•"></a>ä¸€ã€dispatch_onceç”¨æ³•</h4><p>â€‹    <strong>dispatch_once_t è¦æ˜¯å…¨å±€æˆ–staticå˜é‡ï¼Œä¿è¯dispatch_once_tåªæœ‰ä¸€ä»½å®ä¾‹</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="built_in">UIColor</span> *)boringColor &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="built_in">UIColor</span> *color;</span><br><span class="line">  <span class="comment">//åªè¿è¡Œä¸€æ¬¡</span></span><br><span class="line">  <span class="keyword">static</span> <span class="built_in">dispatch_once_t</span> onceToken;</span><br><span class="line">  <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">    color = [<span class="built_in">UIColor</span> colorWithRed:<span class="number">0.380</span>f green:<span class="number">0.376</span>f blue:<span class="number">0.376</span>f alpha:<span class="number">1.000</span>f];</span><br><span class="line">	&#125;);</span><br><span class="line">  <span class="keyword">return</span> color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="äºŒã€dispatch-async"><a href="#äºŒã€dispatch-async" class="headerlink" title="äºŒã€dispatch_async"></a>äºŒã€dispatch_async</h4><p>â€‹    è®¾è®¡ä¸€ä¸ªå¼‚æ­¥çš„APIè°ƒç”¨dispatch_async()ï¼Œè¿™ä¸ªè°ƒç”¨æ”¾åœ¨APIçš„æ–¹æ³•æˆ–å‡½æ•°ä¸­åšã€‚è®©APIçš„ä½¿ç”¨è€…è®¾ç½®ä¸€ä¸ªå›è°ƒå¤„ç†é˜Ÿåˆ—ã€‚</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)processImage:(<span class="built_in">UIImage</span> \*)image completionHandler:(<span class="keyword">void</span>(^)(<span class="built_in">BOOL</span> success))handler &#123;</span><br><span class="line">  <span class="built_in">dispatch_async</span>(<span class="keyword">self</span>.isolationQueue, ^(<span class="keyword">void</span>)&#123;</span><br><span class="line">    <span class="comment">// do actual processing here</span></span><br><span class="line">    <span class="built_in">dispatch_async</span>(<span class="keyword">self</span>.resultQueue, ^(<span class="keyword">void</span>)&#123;</span><br><span class="line">      handler(<span class="literal">YES</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è±†ç“£ä¸­æ•°æ®åŠ è½½çš„æ—¶å€™ç”¨åˆ°çš„å°±æ˜¯è¿™ç§æ–¹æ³•ï¼Œæ•°æ®å¤„ç†ä¸­ä½¿ç”¨</p>
<p><strong>å¯ä»¥é¿å…ç•Œé¢ä¼šè¢«ä¸€äº›è€—æ—¶çš„æ“ä½œå¡æ­»ï¼Œæ¯”å¦‚è¯»å–ç½‘ç»œæ•°æ®ï¼Œå¤§æ•°æ®IOï¼Œè¿˜æœ‰å¤§é‡æ•°æ®çš„æ•°æ®åº“è¯»å†™ï¼Œè¿™æ—¶éœ€è¦åœ¨å¦ä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†ï¼Œç„¶åé€šçŸ¥ä¸»çº¿ç¨‹æ›´æ–°ç•Œé¢ï¼ŒGCDä½¿ç”¨èµ·æ¥æ¯”NSThreadå’ŒNSOperationæ–¹æ³•è¦ç®€å•æ–¹ä¾¿ã€‚</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä»£ç æ¡†æ¶</span></span><br><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</span><br><span class="line">  <span class="comment">// è€—æ—¶çš„æ“ä½œ</span></span><br><span class="line">  <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">    <span class="comment">// æ›´æ–°ç•Œé¢</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸‹è½½å›¾ç‰‡çš„ç¤ºä¾‹</span></span><br><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</span><br><span class="line">  <span class="built_in">NSURL</span> * url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"&lt;http://avatar.csdn.net/2/C/D/1_totogo2010.jpg&gt;"</span>];</span><br><span class="line">  <span class="built_in">NSData</span> * data = [[<span class="built_in">NSData</span> alloc]initWithContentsOfURL:url];</span><br><span class="line">  <span class="built_in">UIImage</span> *image = [[<span class="built_in">UIImage</span> alloc]initWithData:data];</span><br><span class="line">  <span class="keyword">if</span> (data != <span class="literal">nil</span>) &#123;</span><br><span class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">      <span class="keyword">self</span>.imageView.image = image;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="ä¸‰ã€dispatch-afterå»¶åæ‰§è¡Œ"><a href="#ä¸‰ã€dispatch-afterå»¶åæ‰§è¡Œ" class="headerlink" title="ä¸‰ã€dispatch_afterå»¶åæ‰§è¡Œ"></a>ä¸‰ã€dispatch_afterå»¶åæ‰§è¡Œ</h4><p><strong>dispatch_afteråªæ˜¯å»¶æ—¶æäº¤blockï¼Œä¸æ˜¯å»¶æ—¶ç«‹åˆ»æ‰§è¡Œã€‚</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)foo &#123;</span><br><span class="line">  <span class="keyword">double</span> delayInSeconds = <span class="number">2.0</span>;</span><br><span class="line">  dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, </span><br><span class="line">                                          (int64_t) (delayInSeconds * <span class="built_in">NSEC_PER_SEC</span>));</span><br><span class="line">  dispatch_after(popTime, dispatch_get_main_queue(), ^(<span class="keyword">void</span>)&#123;</span><br><span class="line">    [<span class="keyword">self</span> bar];</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>èŒƒä¾‹ï¼Œå®ç°ä¸€ä¸ªæ¨è¿Ÿå‡ºç°å¼¹å‡ºæ¡†æç¤ºï¼Œæ¯”å¦‚è¯´æç¤ºç”¨æˆ·è¯„ä»·ç­‰åŠŸèƒ½ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">showOrHideNavPrompt</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">let</span> delayInSeconds = <span class="number">1.0</span></span><br><span class="line">  <span class="keyword">let</span> popTime = dispatch_time(<span class="type">DISPATCH_TIME_NOW</span>,</span><br><span class="line">                              <span class="type">Int64</span>(delayInSeconds \* <span class="type">Double</span>(<span class="type">NSEC_PER_SEC</span>))) <span class="comment">// åœ¨è¿™é‡Œå£°æ˜æ¨è¿Ÿçš„æ—¶é—´</span></span><br><span class="line">  dispatch_after(popTime, <span class="type">GlobalMainQueue</span>) &#123; <span class="comment">// ç­‰å¾…delayInSecondså°†é—­åŒ…å¼‚æ­¥åˆ°ä¸»é˜Ÿåˆ—</span></span><br><span class="line">    <span class="keyword">let</span> <span class="built_in">count</span> = <span class="type">PhotoManager</span>.sharedManager.photos.<span class="built_in">count</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">count</span> &gt; <span class="number">0</span> &#123;</span><br><span class="line">      <span class="keyword">self</span>.navigationItem.prompt = <span class="literal">nil</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">self</span>.navigationItem.prompt = <span class="string">"Add photos with faces to Googlyify them!"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å­ä¸­çš„dispatch timeçš„å‚æ•°ï¼Œå¯ä»¥å…ˆçœ‹çœ‹å‡½æ•°åŸå‹ </p>
<p><code>dispatch_time_t dispatch_time ( dispatch_time_t when, int64_t delta );</code></p>
<p>ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºDISPATCH_TIME_NOWè¡¨ç¤ºå½“å‰ã€‚ç¬¬äºŒä¸ªå‚æ•°çš„deltaè¡¨ç¤ºçº³ç§’ï¼Œä¸€ç§’å¯¹åº”çš„çº³ç§’ä¸º1000000000ï¼Œç³»ç»Ÿæä¾›äº†ä¸€äº›å®æ¥ç®€åŒ– </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSEC_PER_SEC 1000000000ull <span class="comment">//æ¯ç§’æœ‰å¤šå°‘çº³ç§’</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> USEC_PER_SEC 1000000ull <span class="comment">//æ¯ç§’æœ‰å¤šå°‘æ¯«ç§’</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> NSEC_PER_USEC 1000ull <span class="comment">//æ¯æ¯«ç§’æœ‰å¤šå°‘çº³ç§’</span></span></span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å¦‚æœè¦è¡¨ç¤ºä¸€ç§’å°±å¯ä»¥è¿™æ ·å†™ </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">dispatch_time(DISPATCH_TIME_NOW, <span class="number">1</span> * <span class="built_in">NSEC_PER_SEC</span>);</span><br><span class="line">dispatch_time(DISPATCH_TIME_NOW, <span class="number">1000</span> * USEC_PER_SEC);</span><br><span class="line">dispatch_time(DISPATCH_TIME_NOW, USEC_PER_SEC * <span class="built_in">NSEC_PER_USEC</span>);</span><br></pre></td></tr></table></figure>



<h4 id="å››ã€dispatch-barrier-asyncä½¿ç”¨Barrier-Taskæ–¹æ³•"><a href="#å››ã€dispatch-barrier-asyncä½¿ç”¨Barrier-Taskæ–¹æ³•" class="headerlink" title="å››ã€dispatch_barrier_asyncä½¿ç”¨Barrier Taskæ–¹æ³•"></a>å››ã€dispatch_barrier_asyncä½¿ç”¨Barrier Taskæ–¹æ³•</h4><ol>
<li>Dispatch Barrierè§£å†³å¤šçº¿ç¨‹å¹¶å‘è¯»å†™åŒä¸€ä¸ªèµ„æºå‘ç”Ÿæ­»é”</li>
<li>Dispatch Barrierç¡®ä¿æäº¤çš„é—­åŒ…æ˜¯æŒ‡å®šé˜Ÿåˆ—ä¸­åœ¨ç‰¹å®šæ—¶æ®µå”¯ä¸€åœ¨æ‰§è¡Œçš„ä¸€ä¸ªã€‚ </li>
<li>åœ¨æ‰€æœ‰å…ˆäºDispatch Barrierçš„ä»»åŠ¡éƒ½å®Œæˆçš„æƒ…å†µä¸‹è¿™ä¸ªé—­åŒ…æ‰å¼€å§‹æ‰§è¡Œã€‚ </li>
<li>è½®åˆ°è¿™ä¸ªé—­åŒ…æ—¶barrierä¼šæ‰§è¡Œè¿™ä¸ªé—­åŒ…å¹¶ä¸”ç¡®ä¿é˜Ÿåˆ—åœ¨æ­¤è¿‡ç¨‹ä¸ä¼šæ‰§è¡Œå…¶å®ƒä»»åŠ¡ã€‚ </li>
<li>é—­åŒ…å®Œæˆå é˜Ÿåˆ—æ¢å¤ã€‚ </li>
<li><strong>éœ€è¦æ³¨æ„dispatch_barrier_asyncåªåœ¨è‡ªå·±åˆ›å»ºçš„é˜Ÿåˆ—ä¸Šæœ‰è¿™ç§ä½œç”¨ï¼Œåœ¨å…¨å±€å¹¶å‘é˜Ÿåˆ—å’Œä¸²è¡Œé˜Ÿåˆ—ä¸Šï¼Œæ•ˆæœå’Œ dispatch_syncä¸€æ ·</strong></li>
</ol>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºé˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">self</span>.isolationQueue = dispatch_queue_create([label UTF8String], DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line"><span class="comment">//æ”¹å˜setter</span></span><br><span class="line">- (<span class="keyword">void</span>)setCount:(<span class="built_in">NSUInteger</span>)count forKey:(<span class="built_in">NSString</span> \*)key &#123;</span><br><span class="line">  key = [key <span class="keyword">copy</span>];</span><br><span class="line">  <span class="comment">//ç¡®ä¿æ‰€æœ‰barrieréƒ½æ˜¯asyncå¼‚æ­¥çš„</span></span><br><span class="line">  dispatch_barrier_async(<span class="keyword">self</span>.isolationQueue, ^()&#123;</span><br><span class="line">    <span class="keyword">if</span> (count == <span class="number">0</span>) &#123;</span><br><span class="line">      [<span class="keyword">self</span>.counts removeObjectForKey:key];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">self</span>.counts[key] = @(count);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)dispatchBarrierAsyncDemo &#123;</span><br><span class="line">    <span class="comment">//é˜²æ­¢æ–‡ä»¶è¯»å†™å†²çªï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—ï¼Œæ“ä½œéƒ½åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸­è¿›è¡Œï¼Œæ²¡æœ‰æ›´æ–°æ•°æ®è¯»ç”¨å¹¶è¡Œï¼Œå†™ç”¨ä¸²è¡Œã€‚</span></span><br><span class="line">    <span class="built_in">dispatch_queue_t</span> dataQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.dataqueue"</span>,</span><br><span class="line">                                                       DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">    <span class="built_in">dispatch_async</span>(dataQueue, ^&#123;</span><br><span class="line">      [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">2.</span>f];</span><br><span class="line">      <span class="built_in">NSLog</span>(<span class="string">@"read data 1"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  </span><br><span class="line">    <span class="built_in">dispatch_async</span>(dataQueue, ^&#123;</span><br><span class="line">      <span class="built_in">NSLog</span>(<span class="string">@"read data 2"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//ç­‰å¾…å‰é¢çš„éƒ½å®Œæˆï¼Œåœ¨æ‰§è¡Œbarrieråé¢çš„</span></span><br><span class="line">    dispatch_barrier_async(dataQueue, ^&#123;</span><br><span class="line">      <span class="built_in">NSLog</span>(<span class="string">@"write data 1"</span>);</span><br><span class="line">      [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1</span>];</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">dispatch_async</span>(dataQueue, ^&#123;</span><br><span class="line">      [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1.</span>f];</span><br><span class="line">      <span class="built_in">NSLog</span>(<span class="string">@"read data 3"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">dispatch_async</span>(dataQueue, ^&#123;</span><br><span class="line">      <span class="built_in">NSLog</span>(<span class="string">@"read data 4"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>swiftç¤ºä¾‹</strong></p>
<p>ä½¿ç”¨dispatch_queue_createåˆå§‹åŒ–ä¸€ä¸ªå¹¶å‘é˜Ÿåˆ—ã€‚ç¬¬ä¸€ä¸ªå‚æ•°éµå¾ª<strong>åå‘DNSå‘½åä¹ æƒ¯</strong>ï¼Œæ–¹ä¾¿æè¿°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŒ‡å‡ºæ˜¯å¹¶å‘è¿˜æ˜¯é¡ºåºã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">let</span> concurrentPhotoQueue = dispatch_queue_create(<span class="string">"com.raywenderlich.GooglyPuff.photoQueue"</span>, <span class="type">DISPATCH_QUEUE_CONCURRENT</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addPhoto</span><span class="params">(photo: Photo)</span></span> &#123;</span><br><span class="line">  dispatch_barrier_async(concurrentPhotoQueue) &#123;</span><br><span class="line">    <span class="comment">// å°†å†™æ“ä½œåŠ å…¥åˆ°è‡ªå®šä¹‰çš„é˜Ÿåˆ—ã€‚å¼€å§‹æ‰§è¡Œæ—¶è¿™ä¸ªå°±æ˜¯é˜Ÿåˆ—ä¸­å”¯ä¸€çš„ä¸€ä¸ªåœ¨æ‰§è¡Œçš„ä»»åŠ¡ã€‚</span></span><br><span class="line">    <span class="keyword">self</span>._photos.append(photo) </span><br><span class="line">    <span class="comment">// barrierèƒ½å¤Ÿä¿éšœä¸ä¼šå’Œå…¶ä»–ä»»åŠ¡åŒæ—¶è¿›è¡Œã€‚</span></span><br><span class="line">    dispatch_async(<span class="type">GlobalMainQueue</span>) &#123; </span><br><span class="line">      <span class="comment">// æ¶‰åŠåˆ°UIæ‰€ä»¥è¿™ä¸ªé€šçŸ¥åº”è¯¥åœ¨ä¸»çº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥åˆ†æ´¾å¦ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡åˆ°ä¸»é˜Ÿåˆ—ä¸­ã€‚</span></span><br><span class="line">      <span class="keyword">self</span>.postContentAddedNotification()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æ˜¯è§£å†³äº†å†™å¯èƒ½å‘ç”Ÿæ­»é”ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨dispatch_syncè§£å†³è¯»æ—¶å¯èƒ½ä¼šå‘ç”Ÿçš„æ­»é”ã€‚</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> photos: [<span class="type">Photo</span>] &#123;</span><br><span class="line">  <span class="keyword">var</span> photosCopy: [<span class="type">Photo</span>]!</span><br><span class="line">  dispatch_sync(concurrentPhotoQueue) &#123; <span class="comment">// åŒæ­¥è°ƒåº¦åˆ°concurrentPhotoQueueé˜Ÿåˆ—æ‰§è¡Œè¯»æ“ä½œ</span></span><br><span class="line">    photosCopy = <span class="keyword">self</span>._photos <span class="comment">// ä¿å­˜</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> photosCopy</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·è¯»å†™é—®é¢˜éƒ½è§£å†³äº†ã€‚éƒ½ç”¨å¼‚æ­¥å¤„ç†é¿å…æ­»é”ï¼Œå¼‚æ­¥çš„ç¼ºç‚¹åœ¨äºè°ƒè¯•ä¸æ–¹ä¾¿ï¼Œä½†æ˜¯æ¯”èµ·åŒæ­¥å®¹æ˜“äº§ç”Ÿæ­»é”è¿™ä¸ªå‰¯ä½œç”¨è¿˜ç®—å°çš„ã€‚</p>
<h4 id="äº”ã€dispatch-applyè¿›è¡Œå¿«é€Ÿè¿­ä»£"><a href="#äº”ã€dispatch-applyè¿›è¡Œå¿«é€Ÿè¿­ä»£" class="headerlink" title="äº”ã€dispatch_applyè¿›è¡Œå¿«é€Ÿè¿­ä»£"></a>äº”ã€dispatch_applyè¿›è¡Œå¿«é€Ÿè¿­ä»£</h4><p>ç±»ä¼¼forå¾ªç¯ï¼Œä½†æ˜¯åœ¨å¹¶å‘é˜Ÿåˆ—çš„æƒ…å†µä¸‹dispatch_applyä¼šå¹¶å‘æ‰§è¡Œblockä»»åŠ¡ã€‚ </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (size_t y = <span class="number">0</span>; y &lt; height; ++y) &#123;</span><br><span class="line">  <span class="keyword">for</span> (size_t x = <span class="number">0</span>; x &lt; width; ++x) &#123;</span><br><span class="line">    <span class="comment">// Do something with x and y here</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œæ‰€ä»¥ä½¿ç”¨dispatch_applyå¯ä»¥è¿è¡Œçš„æ›´å¿« </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)dispatchApplyDemo &#123;</span><br><span class="line">    <span class="built_in">dispatch_queue_t</span> concurrentQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.concurre</span></span><br><span class="line"><span class="string">    dispatch_apply(10, concurrentQueue, ^(size_t i) &#123;</span></span><br><span class="line"><span class="string">        NSLog(@"</span>%zu<span class="string">",i);</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">    NSLog(@"</span>The end<span class="string">");**</span></span><br><span class="line"><span class="string">    //è¿™é‡Œæœ‰ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œdispatch_applyè¿™ä¸ªæ˜¯ä¼šé˜»å¡ä¸»çº¿ç¨‹çš„ã€‚è¿™ä¸ªlogæ‰“å°ä¼šåœ¨dispatch_applyéƒ½ç»“æŸåæ‰å¼€å§‹æ‰§è¡Œ</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>dispatch_applyèƒ½é¿å…çº¿ç¨‹çˆ†ç‚¸ï¼Œå› ä¸ºGCDä¼šç®¡ç†å¹¶å‘</strong></p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)dealWiththreadWithMaybeExplode:(<span class="built_in">BOOL</span>)explode &#123;</span><br><span class="line">  <span class="built_in">dispatch_queue_t</span> concurrentQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.concurrentqueue"</span>,DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">  <span class="keyword">if</span> (explode) &#123;</span><br><span class="line">    <span class="comment">//æœ‰é—®é¢˜çš„æƒ…å†µï¼Œå¯èƒ½ä¼šæ­»é”</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">999</span> ; i++) &#123;</span><br><span class="line">      <span class="built_in">dispatch_async</span>(concurrentQueue, ^&#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"wrong %d"</span>,i);</span><br><span class="line">        <span class="comment">//do something hard</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//ä¼šä¼˜åŒ–å¾ˆå¤šï¼Œèƒ½å¤Ÿåˆ©ç”¨GCDç®¡ç†</span></span><br><span class="line">    dispatch_apply(<span class="number">999</span>, concurrentQueue, ^(size_t i)&#123;</span><br><span class="line">      <span class="built_in">NSLog</span>(<span class="string">@"correct %zu"</span>,i);</span><br><span class="line">      <span class="comment">//do something hard</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>swiftç¤ºä¾‹ï¼š </p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadPhotosWithCompletion</span><span class="params">(completion: BatchPhotoDownloadingCompletionClosure?)</span></span> &#123;</span><br><span class="line">  <span class="keyword">var</span> storedError: <span class="type">NSError!</span></span><br><span class="line">  <span class="keyword">var</span> downloadGroup = dispatch_group_create()</span><br><span class="line">  <span class="keyword">let</span> addresses = [<span class="type">OverlyAttachedGirlfriendURLString</span>, </span><br><span class="line">                   <span class="type">SuccessKidURLString</span>,</span><br><span class="line">                   <span class="type">LotsOfFacesURLString</span>]</span><br><span class="line">  dispatch_apply(<span class="type">UInt</span>(addresses.<span class="built_in">count</span>), <span class="type">GlobalUserInitiatedQueue</span>) &#123;</span><br><span class="line">    i <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> index = <span class="type">Int</span>(i)</span><br><span class="line">    <span class="keyword">let</span> address = addresses[index]</span><br><span class="line">    <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: address)</span><br><span class="line">    dispatch_group_enter(downloadGroup)</span><br><span class="line">    <span class="keyword">let</span> photo = <span class="type">DownloadPhoto</span>(url: url!) &#123;</span><br><span class="line">      image, error <span class="keyword">in</span> </span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">        storedError = error</span><br><span class="line">      &#125;</span><br><span class="line">      dispatch_group_leave(downloadGroup)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">PhotoManager</span>.sharedManager.addPhoto(photo)</span><br><span class="line">  &#125;</span><br><span class="line">  dispatch_group_notify(downloadGroup, <span class="type">GlobalMainQueue</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> completion = completion &#123;</span><br><span class="line">      completion(error: storedError)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="å…­ã€Blockç»„åˆDispatch-groups"><a href="#å…­ã€Blockç»„åˆDispatch-groups" class="headerlink" title="å…­ã€Blockç»„åˆDispatch_groups"></a>å…­ã€Blockç»„åˆDispatch_groups</h4><p>dispatch groupsæ˜¯ä¸“é—¨ç”¨æ¥ç›‘è§†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ã€‚dispatch_group_tå®ä¾‹ç”¨æ¥è¿½è¸ªä¸åŒé˜Ÿåˆ—ä¸­çš„ä¸åŒä»»åŠ¡ã€‚</p>
<p>å½“groupé‡Œæ‰€æœ‰äº‹ä»¶éƒ½å®ŒæˆGCD APIæœ‰ä¸¤ç§æ–¹å¼å‘é€é€šçŸ¥: </p>
<ul>
<li>ç¬¬ä¸€ç§æ˜¯dispatch_group_waitï¼Œä¼šé˜»å¡å½“å‰è¿›ç¨‹ï¼Œç­‰æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆæˆ–ç­‰å¾…è¶…æ—¶ã€‚ </li>
<li>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨dispatch_group_notifyï¼Œå¼‚æ­¥æ‰§è¡Œé—­åŒ…ï¼Œä¸ä¼šé˜»å¡ã€‚ </li>
</ul>
<ol>
<li>ç¬¬ä¸€ç§ä½¿ç”¨dispatch_group_waitçš„swiftçš„ä¾‹å­ï¼š </li>
</ol>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadPhotosWithCompletion</span><span class="params">(completion: BatchPhotoDownloadingCompletionClosure?)</span></span> &#123;</span><br><span class="line">  dispatch_async(<span class="type">GlobalUserInitiatedQueue</span>) &#123;</span><br><span class="line">    <span class="comment">// å› ä¸ºdispatch_group_waitä¼šç§Ÿå¡å½“å‰è¿›ç¨‹ï¼Œæ‰€ä»¥è¦ä½¿ç”¨dispatch_asyncå°†æ•´ä¸ªæ–¹æ³•è¦æ”¾åˆ°åå°é˜Ÿåˆ—æ‰èƒ½å¤Ÿä¿è¯ä¸»çº¿ç¨‹ä¸è¢«é˜»å¡</span></span><br><span class="line">    <span class="keyword">var</span> storedError: <span class="type">NSError!</span></span><br><span class="line">    <span class="keyword">var</span> downloadGroup = dispatch_group_create() <span class="comment">// åˆ›å»ºä¸€ä¸ªdispatch group</span></span><br><span class="line">    <span class="keyword">let</span> addresses = [<span class="type">OverlyAttachedGirlfriendURLString</span>,</span><br><span class="line">                     <span class="type">SuccessKidURLString</span>,</span><br><span class="line">                     <span class="type">LotsOfFacesURLString</span>]</span><br><span class="line">    <span class="keyword">for</span> address <span class="keyword">in</span> addresses &#123;</span><br><span class="line">      <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: address)</span><br><span class="line">      dispatch_group_enter(downloadGroup)</span><br><span class="line">        <span class="comment">// dispatch_group_enteræ˜¯é€šçŸ¥dispatch groupä»»åŠ¡å¼€å§‹äº†ï¼Œdispatch_group_enterå’Œdispatch_group_leaveæ˜¯æˆå¯¹è°ƒç”¨ï¼Œä¸ç„¶ç¨‹åºå°±å´©æºƒäº†ã€‚</span></span><br><span class="line">      <span class="keyword">let</span> photo = <span class="type">DownloadPhoto</span>(url: url!) &#123;</span><br><span class="line">        image, error <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">          storedError = error</span><br><span class="line">        &#125;</span><br><span class="line">        dispatch_group_leave(downloadGroup) </span><br><span class="line">        <span class="comment">// ä¿æŒå’Œdispatch_group_enteré…å¯¹ã€‚é€šçŸ¥ä»»åŠ¡å·²ç»å®Œæˆ</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">PhotoManager</span>.sharedManager.addPhoto(photo)</span><br><span class="line">    &#125;</span><br><span class="line">    dispatch_group_wait(downloadGroup, <span class="type">DISPATCH_TIME_FOREVER</span>)</span><br><span class="line">    <span class="comment">// dispatch_group_waitç­‰å¾…æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆç›´åˆ°è¶…æ—¶ã€‚å¦‚æœä»»åŠ¡å®Œæˆå‰å°±è¶…æ—¶äº†ï¼Œå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéé›¶å€¼ï¼Œå¯ä»¥é€šè¿‡è¿”å›å€¼åˆ¤æ–­æ˜¯å¦è¶…æ—¶ã€‚ä¹Ÿå¯ä»¥ç”¨DISPATCH_TIME_FOREVERè¡¨ç¤ºä¸€ç›´ç­‰ã€‚</span></span><br><span class="line">    dispatch_async(<span class="type">GlobalMainQueue</span>) &#123;</span><br><span class="line">      <span class="comment">// è¿™é‡Œå¯ä»¥ä¿è¯æ‰€æœ‰å›¾ç‰‡ä»»åŠ¡éƒ½å®Œæˆï¼Œç„¶ååœ¨main queueé‡ŒåŠ å…¥å®Œæˆåè¦å¤„ç†çš„é—­åŒ…ï¼Œä¼šåœ¨main queueé‡Œæ‰§è¡Œã€‚</span></span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">let</span> completion = completion &#123; <span class="comment">// æ‰§è¡Œé—­åŒ…å†…å®¹</span></span><br><span class="line">        completion(error: storedError)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>  ocä¾‹å­</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)dispatchGroupWaitDemo &#123;</span><br><span class="line">  <span class="built_in">dispatch_queue_t</span> concurrentQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.concurrentqueue"</span>,DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">  dispatch_group_t group = dispatch_group_create();</span><br><span class="line">  <span class="comment">//åœ¨groupä¸­æ·»åŠ é˜Ÿåˆ—çš„block</span></span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">    [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">2.</span>f];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  dispatch_group_wait(group, DISPATCH_TIME_FOREVER);</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"go on"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>ç¬¬äºŒç§ä½¿ç”¨dispatch_group_notifyçš„<strong>swift</strong>çš„ä¾‹å­ï¼š </li>
</ol>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">downloadPhotosWithCompletion</span><span class="params">(completion: BatchPhotoDownloadingCompletionClosure?)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¸ç”¨åŠ dispatch_asyncï¼Œå› ä¸ºæ²¡æœ‰é˜»å¡ä¸»è¿›ç¨‹</span></span><br><span class="line">  <span class="keyword">var</span> storedError: <span class="type">NSError!</span></span><br><span class="line">  <span class="keyword">var</span> downloadGroup = dispatch_group_create()</span><br><span class="line">  <span class="keyword">for</span> address <span class="keyword">in</span> [<span class="type">OverlyAttachedGirlfriendURLString</span>,</span><br><span class="line">                  <span class="type">SuccessKidURLString</span>,</span><br><span class="line">                  <span class="type">LotsOfFacesURLString</span>] &#123;</span><br><span class="line">    <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: address)</span><br><span class="line">    dispatch_group_enter(downloadGroup)</span><br><span class="line">    <span class="keyword">let</span> photo = <span class="type">DownloadPhoto</span>(url: url!) &#123;</span><br><span class="line">      image, error <span class="keyword">in</span></span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">        storedError = error</span><br><span class="line">      &#125;</span><br><span class="line">      dispatch_group_leave(downloadGroup)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">PhotoManager</span>.sharedManager.addPhoto(photo)</span><br><span class="line">  &#125;</span><br><span class="line">  dispatch_group_notify(downloadGroup, <span class="type">GlobalMainQueue</span>) &#123;</span><br><span class="line">    <span class="comment">// dispatch_group_notifyå’Œdispatch_group_waitçš„åŒºåˆ«å°±æ˜¯æ˜¯å¼‚æ­¥æ‰§è¡Œé—­åŒ…çš„ï¼Œå½“dispatch groupsä¸­æ²¡æœ‰å‰©ä½™çš„ä»»åŠ¡æ—¶é—­åŒ…æ‰æ‰§è¡Œã€‚è¿™é‡Œæ˜¯æŒ‡æ˜åœ¨ä¸»é˜Ÿåˆ—ä¸­æ‰§è¡Œã€‚</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> completion = completion &#123;</span><br><span class="line">      completion(error: storedError)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ocä¾‹å­ï¼š</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//dispatch_group_notify</span></span><br><span class="line">- (<span class="keyword">void</span>)dispatchGroupNotifyDemo &#123;</span><br><span class="line">  <span class="built_in">dispatch_queue_t</span> concurrentQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.concurrentqueue"</span>,DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line"></span><br><span class="line">  dispatch_group_t group = dispatch_group_create();</span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"end"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"can continue"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//dispatch_group_wait</span></span><br><span class="line">- (<span class="keyword">void</span>)dispatchGroupWaitDemo &#123;</span><br><span class="line">  <span class="built_in">dispatch_queue_t</span> concurrentQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.concurrentqueue"</span>,DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">  dispatch_group_t group = dispatch_group_create();</span><br><span class="line">  <span class="comment">//åœ¨groupä¸­æ·»åŠ é˜Ÿåˆ—çš„block</span></span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">    [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">2.</span>f];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  dispatch_group_async(group, concurrentQueue, ^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  dispatch_group_wait(group, DISPATCH_TIME_FOREVER);</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"can continue"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>å¦‚ä½•å¯¹ç°æœ‰APIä½¿ç”¨dispatch_group_t </li>
</ol>
<p>ç»™Core Dataçš„-performBlock:æ·»åŠ groupsã€‚ç»„åˆå®Œæˆä»»åŠ¡åä½¿ç”¨dispatch_group_notifyæ¥è¿è¡Œä¸€ä¸ªblockå³å¯ã€‚ </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)withGroup:(dispatch_group_t)group performBlock:(dispatch_block_t)block &#123;</span><br><span class="line">  <span class="keyword">if</span> (group == <span class="literal">NULL</span>) &#123;</span><br><span class="line">    [<span class="keyword">self</span> performBlock:block];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    dispatch_group_enter(group);</span><br><span class="line">    [<span class="keyword">self</span> performBlock:^()&#123;</span><br><span class="line">      block();</span><br><span class="line">      dispatch_group_leave(group);</span><br><span class="line">    &#125;];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>NSURLConnectionä¹Ÿå¯ä»¥è¿™æ ·åš</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)withGroup:(dispatch_group_t)group sendAsynchronousRequest:(<span class="built_in">NSURLRequest</span> *)request</span><br><span class="line">            queue:(<span class="built_in">NSOperationQueue</span> *)queue completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLResponse</span>*, <span class="built_in">NSData</span>*, <span class="built_in">NSError</span>*))handler &#123;</span><br><span class="line">    <span class="keyword">if</span> (group == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span> sendAsynchronousRequest:request queue:queue completionHandler:handler];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        dispatch_group_enter(group);</span><br><span class="line">        [<span class="keyword">self</span> sendAsynchronousRequest:request</span><br><span class="line">                                queue:queue</span><br><span class="line">                    completionHandler:^(<span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSData</span> *data, <span class="built_in">NSError</span> *error)&#123;</span><br><span class="line">            handler(response, data, error);</span><br><span class="line">            dispatch_group_leave(group);</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>æ³¨æ„äº‹é¡¹ï¼š</code> </p>
<ul>
<li>dispatch_group_async ç­‰ä»·äº dispatch_group_enter() å’Œ dispatch_group_leave() çš„ç»„åˆã€‚ </li>
<li>dispatch_group_enter() å¿…é¡»è¿è¡Œåœ¨ dispatch_group_leave() ä¹‹å‰ã€‚ </li>
<li>dispatch_group_enter() å’Œ dispatch_group_leave() éœ€è¦æˆå¯¹å‡ºç°çš„ </li>
</ul>
<h4 id="ä¸ƒã€Dispatch-Block"><a href="#ä¸ƒã€Dispatch-Block" class="headerlink" title="ä¸ƒã€Dispatch Block"></a>ä¸ƒã€Dispatch Block</h4><p>â€‹    é˜Ÿåˆ—æ‰§è¡Œä»»åŠ¡éƒ½æ˜¯blockçš„æ–¹å¼</p>
<ol>
<li><h5 id="dispatch-block-t-åˆ›å»ºblock"><a href="#dispatch-block-t-åˆ›å»ºblock" class="headerlink" title="dispatch_block_t åˆ›å»ºblock"></a>dispatch_block_t åˆ›å»ºblock</h5></li>
</ol>
<ul>
<li><pre><code class="objc">- (<span class="keyword">void</span>)createDispatchBlock {
  <span class="comment">//normal way</span>
  <span class="built_in">dispatch_queue_t</span> concurrentQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.concurrentqueue"</span>,DISPATCH_QUEUE_CONCURRENT);

  dispatch_block_t block = dispatch_block_create(<span class="number">0</span>, ^{
    <span class="built_in">NSLog</span>(<span class="string">@"run block"</span>);
  });
  <span class="built_in">dispatch_async</span>(concurrentQueue, block);
  <span class="comment">//QOS way</span>
  dispatch_block_t qosBlock = dispatch_block_create_with_qos_class(<span class="number">0</span>, QOS_CLASS_USER_INITIATED, <span class="number">-1</span>, ^{
    <span class="built_in">NSLog</span>(<span class="string">@"run qos block"</span>);
  });
  <span class="built_in">dispatch_async</span>(concurrentQueue, qosBlock);
}
&lt;!--ï¿¼<span class="number">27</span>--&gt;


</code></pre>
</li>
</ul>
<ol start="3">
<li><h5 id="dispatch-block-notify"><a href="#dispatch-block-notify" class="headerlink" title="dispatch_block_notify"></a>dispatch_block_notify</h5><p>å¯ä»¥ç›‘è§†æŒ‡å®šdispatch blockç»“æŸï¼Œç„¶åå†åŠ å…¥ä¸€ä¸ªblockåˆ°é˜Ÿåˆ—ä¸­ã€‚ </p>
<p>ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºï¼Œç¬¬ä¸€ä¸ªæ˜¯éœ€è¦ç›‘è§†çš„blockï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯éœ€è¦æäº¤æ‰§è¡Œçš„é˜Ÿåˆ—ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å¾…åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­çš„block </p>
</li>
</ol>
<ul>
<li><pre><code class="objc">- (<span class="keyword">void</span>)dispatchBlockNotifyDemo {
  <span class="built_in">dispatch_queue_t</span> serialQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.serialqueue"</span>, DISPATCH_QUEUE_SERIAL);
  dispatch_block_t firstBlock = dispatch_block_create(<span class="number">0</span>, ^{
    <span class="built_in">NSLog</span>(<span class="string">@"first block start"</span>);
    [<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">2.</span>f];
    <span class="built_in">NSLog</span>(<span class="string">@"first block end"</span>);
  });
  <span class="built_in">dispatch_async</span>(serialQueue, firstBlock);
  dispatch_block_t secondBlock = dispatch_block_create(<span class="number">0</span>, ^{
    <span class="built_in">NSLog</span>(<span class="string">@"second block run"</span>);
  });
  <span class="comment">//first blockæ‰§è¡Œå®Œæ‰åœ¨serial queueä¸­æ‰§è¡Œsecond block</span>
  dispatch_block_notify(firstBlock, serialQueue, secondBlock);
}
&lt;!--ï¿¼<span class="number">28</span>--&gt;


</code></pre>
</li>
</ul>
<ol start="5">
<li><h5 id="ä½¿ç”¨dispatch-block-objectï¼ˆè°ƒåº¦å—ï¼‰åœ¨ä»»åŠ¡æ‰§è¡Œå‰è¿›è¡Œå–æ¶ˆ"><a href="#ä½¿ç”¨dispatch-block-objectï¼ˆè°ƒåº¦å—ï¼‰åœ¨ä»»åŠ¡æ‰§è¡Œå‰è¿›è¡Œå–æ¶ˆ" class="headerlink" title="ä½¿ç”¨dispatch block objectï¼ˆè°ƒåº¦å—ï¼‰åœ¨ä»»åŠ¡æ‰§è¡Œå‰è¿›è¡Œå–æ¶ˆ"></a>ä½¿ç”¨dispatch block objectï¼ˆè°ƒåº¦å—ï¼‰åœ¨ä»»åŠ¡æ‰§è¡Œå‰è¿›è¡Œå–æ¶ˆ</h5><p>dispatch block objectå¯ä»¥ä¸ºé˜Ÿåˆ—ä¸­çš„å¯¹è±¡è®¾ç½® </p>
<p>ç¤ºä¾‹ï¼Œä¸‹è½½å›¾ç‰‡ä¸­é€”è¿›è¡Œå–æ¶ˆ </p>
</li>
</ol>
<ul>
<li><pre><code class="swift"><span class="function"><span class="keyword">func</span> <span class="title">downloadPhotosWithCompletion</span><span class="params">(completion: BatchPhotoDownloadingCompletionClosure?)</span></span> {

  <span class="keyword">var</span> storedError: <span class="type">NSError!</span>
  <span class="keyword">let</span> downloadGroup = dispatch_group_create()
  <span class="keyword">var</span> addresses = [<span class="type">OverlyAttachedGirlfriendURLString</span>,
                   <span class="type">SuccessKidURLString</span>,
                   <span class="type">LotsOfFacesURLString</span>]
  addresses += addresses + addresses <span class="comment">// æ‰©å±•addressæ•°ç»„ï¼Œå¤åˆ¶3ä»½</span>
  <span class="keyword">var</span> blocks: [dispatch_block_t] = [] <span class="comment">// ä¸€ä¸ªä¿å­˜blockçš„æ•°ç»„</span>
     <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span> ..&lt; addresses.<span class="built_in">count</span> {
    dispatch_group_enter(downloadGroup)
    <span class="keyword">let</span> block = dispatch_block_create(<span class="type">DISPATCH_BLOCK_INHERIT_QOS_CLASS</span>) {
      <span class="comment">// åˆ›å»ºä¸€ä¸ªblockï¼Œblockçš„æ ‡å¿—æ˜¯DISPATCH_BLOCK_INHERIT_QOS_CLASS</span>
      <span class="keyword">let</span> index = <span class="type">Int</span>(i)
      <span class="keyword">let</span> address = addresses[index]
      <span class="keyword">let</span> url = <span class="type">NSURL</span>(string: address)
      <span class="keyword">let</span> photo = <span class="type">DownloadPhoto</span>(url: url!) {
        image, error <span class="keyword">in</span>
        <span class="keyword">if</span> <span class="keyword">let</span> error = error {
          storedError = error
        }
        dispatch_group_leave(downloadGroup)
      }
      <span class="type">PhotoManager</span>.sharedManager.addPhoto(photo)
    }
    blocks.append(block)
    dispatch_async(<span class="type">GlobalMainQueue</span>, block)
    <span class="comment">// æŠŠè¿™ä¸ªblockæ”¾åˆ°GlobalMainQueueä¸Šå¼‚æ­¥è°ƒç”¨ã€‚å› ä¸ºå…¨å±€é˜Ÿåˆ—æ˜¯ä¸€ä¸ªé¡ºåºé˜Ÿåˆ—æ‰€ä»¥æ–¹ä¾¿å–æ¶ˆå¯¹è±¡blockï¼ŒåŒæ—¶å¯ä»¥ä¿è¯ä¸‹è½½ä»»åŠ¡åœ¨downloadPhotosWithCompletionè¿”å›åæ‰å¼€å§‹æ‰§è¡Œã€‚</span>
  }
  <span class="keyword">for</span> block <span class="keyword">in</span> blocks[<span class="number">3</span> ..&lt; blocks.<span class="built_in">count</span>] {
    <span class="keyword">let</span> cancel = arc4random_uniform(<span class="number">2</span>) <span class="comment">// éšæœºè¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œä¼šè¿”å›0æˆ–1</span>
    <span class="keyword">if</span> cancel == <span class="number">1</span> {
      dispatch_block_cancel(block)
      <span class="comment">// å¦‚æœæ˜¯1å°±å–æ¶ˆblockï¼Œè¿™ä¸ªåªèƒ½å‘ç”Ÿåœ¨blockè¿˜åœ¨é˜Ÿåˆ—ä¸­å¹¶æ²¡æœ‰å¼€å§‹çš„æƒ…å†µä¸‹ã€‚å› ä¸ºæŠŠblockå·²ç»æ”¾åˆ°äº†GlobalMainQueueä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹ä¼šå…ˆæ‰§è¡Œï¼Œæ‰§è¡Œå®Œäº†æ‰ä¼šæ‰§è¡Œblockã€‚</span>
      <span class="comment">// å› ä¸ºå·²ç»dispatch_group_enteräº†ï¼Œæ‰€ä»¥å–æ¶ˆæ—¶ä¹Ÿè¦å°†å…¶éƒ½leaveæ‰ã€‚</span>
      dispatch_group_leave(downloadGroup)       
    }
  }
  dispatch_group_notify(downloadGroup, <span class="type">GlobalMainQueue</span>) {
    <span class="keyword">if</span> <span class="keyword">let</span> completion = completion {
      completion(error: storedError)
    }
  }
}
&lt;!--ï¿¼<span class="number">29</span>--&gt;</code></pre>
</li>
</ul>
<ul>
<li>dispatch_io_createï¼šåˆ›å»ºdispatch io ã€‚</li>
<li>dispatch_io_set_low_waterï¼šæŒ‡å®šåˆ‡å‰²æ–‡ä»¶å¤§å° ã€‚</li>
<li>dispatch_io_readï¼šè¯»å–åˆ‡å‰²çš„æ–‡ä»¶ç„¶ååˆå¹¶ã€‚ </li>
</ul>
<blockquote>
<p>è‹¹æœç³»ç»Ÿæ—¥å¿—APIé‡Œç”¨åˆ°äº†è¿™ä¸ªæŠ€æœ¯ï¼Œå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ï¼š </p>
<p><a href="https://github.com/Apple-FOSS-Mirror/Libc/blob/2ca2ae74647714acfc18674c3114b1a5d3325d7d/gen/asl.c" target="_blank" rel="noopener">https://github.com/Apple-FOSS-Mirror/Libc/blob/2ca2ae74647714acfc18674c3114b1a5d3325d7d/gen/asl.c</a></p>
</blockquote>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">pipe_q = dispatch_queue_create(<span class="string">"PipeQ"</span>, <span class="literal">NULL</span>);</span><br><span class="line"><span class="comment">//åˆ›å»º</span></span><br><span class="line">pipe_channel = dispatch_io_create(DISPATCH_IO_STREAM, fd, pipe_q, ^(<span class="keyword">int</span> err)&#123;</span><br><span class="line">  close(fd);</span><br><span class="line">&#125;);</span><br><span class="line">*out_fd = fdpair[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®åˆ‡å‰²å¤§å°</span></span><br><span class="line">dispatch_io_set_low_water(pipe_channel, SIZE_MAX);</span><br><span class="line">dispatch_io_read(pipe_channel, <span class="number">0</span>, SIZE_MAX, pipe_q, ^(<span class="keyword">bool</span> done, dispatch_data_t pipedata, <span class="keyword">int</span> err) &#123;</span><br><span class="line">  <span class="keyword">if</span> (err == <span class="number">0</span>) &#123;</span><br><span class="line">    size_t len = dispatch_data_get_size(pipedata);</span><br><span class="line">    <span class="keyword">if</span> (len &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">//å¯¹æ¯æ¬¡åˆ‡å—æ•°æ®çš„å¤„ç†</span></span><br><span class="line">      <span class="keyword">const</span> <span class="keyword">char</span> *bytes = <span class="literal">NULL</span>;</span><br><span class="line">      <span class="keyword">char</span> *encoded;</span><br><span class="line">      uint32_t eval;</span><br><span class="line">      dispatch_data_t md = dispatch_data_create_map(pipedata, </span><br><span class="line">                                                    (<span class="keyword">const</span> <span class="keyword">void</span> **)&amp;bytes, </span><br><span class="line">                                                    &amp;len);</span><br><span class="line">      encoded = asl_core_encode_buffer(bytes, len);</span><br><span class="line">      asl_msg_set_key_val(aux, ASL_KEY_AUX_DATA, encoded);</span><br><span class="line">      free(encoded);</span><br><span class="line">      eval = _asl_evaluate_send(<span class="literal">NULL</span>, (aslmsg)aux, <span class="number">-1</span>);</span><br><span class="line">      _asl_send_message(<span class="literal">NULL</span>, eval, aux, <span class="literal">NULL</span>);</span><br><span class="line">      asl_msg_release(aux);</span><br><span class="line">      dispatch_release(md);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (done) &#123;</span><br><span class="line">    <span class="comment">//semaphore +1ä½¿å¾—ä¸éœ€è¦å†ç­‰å¾…ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚</span></span><br><span class="line">    dispatch_semaphore_signal(sem);</span><br><span class="line">    dispatch_release(pipe_channel);</span><br><span class="line">    dispatch_release(pipe_q);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>



<h4 id="ä¹ã€Dispatch-Source-ç”¨GCDç›‘è§†è¿›ç¨‹"><a href="#ä¹ã€Dispatch-Source-ç”¨GCDç›‘è§†è¿›ç¨‹" class="headerlink" title="ä¹ã€Dispatch Source ç”¨GCDç›‘è§†è¿›ç¨‹"></a>ä¹ã€Dispatch Source ç”¨GCDç›‘è§†è¿›ç¨‹</h4><p>Dispatch Sourceç”¨äºç›‘å¬ç³»ç»Ÿçš„åº•å±‚å¯¹è±¡ï¼Œæ¯”å¦‚æ–‡ä»¶æè¿°ç¬¦ï¼ŒMachç«¯å£ï¼Œä¿¡å·é‡ç­‰ã€‚ä¸»è¦å¤„ç†çš„äº‹ä»¶å¦‚ä¸‹è¡¨ </p>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">DISPATCH_SOURCE_TYPE_DATA_ADD</td>
<td align="center">æ•°æ®å¢åŠ </td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_DATA_OR</td>
<td align="center">æ•°æ®OR</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_MACH_SEND</td>
<td align="center">Machç«¯å£å‘é€</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_MACH_RECV</td>
<td align="center">Machç«¯å£æ¥æ”¶</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_MEMORYPRESSURE</td>
<td align="center">å†…å­˜æƒ…å†µ</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_PROC</td>
<td align="center">è¿›ç¨‹äº‹ä»¶</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_READ</td>
<td align="center">è¯»æ•°æ®</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_SIGNAL</td>
<td align="center">ä¿¡å·</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_TIMER</td>
<td align="center">å®šæ—¶å™¨</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_VNODE</td>
<td align="center">æ–‡ä»¶ç³»ç»Ÿå˜åŒ–</td>
</tr>
<tr>
<td align="center">DISPATCH_SOURCE_TYPE_WRITE</td>
<td align="center">æ–‡ä»¶å†™å…¥</td>
</tr>
</tbody></table>
<p>æ–¹æ³• </p>
<ul>
<li>dispatch_source_createï¼šåˆ›å»º dispatch source ï¼Œåˆ›å»ºåä¼šå¤„äºæŒ‚èµ·çŠ¶æ€è¿›è¡Œäº‹ä»¶æ¥æ”¶ï¼Œéœ€è¦è®¾ç½®äº‹ä»¶å¤„ç†handlerè¿›è¡Œäº‹ä»¶å¤„ç†ã€‚ </li>
<li>dispatch_source_set_event_handlerï¼šè®¾ç½®äº‹ä»¶å¤„ç† handler </li>
<li>dispatch_source_set_cancel_handlerï¼šäº‹ä»¶å–æ¶ˆhandlerï¼Œå°±æ˜¯åœ¨ dispatch source é‡Šæ”¾å‰åšäº›æ¸…ç†çš„äº‹ã€‚ </li>
<li>dispatch_source_cancelï¼šå…³é—­ dispatch sourceï¼Œè®¾ç½®çš„äº‹ä»¶å¤„ç† handler ä¸ä¼šè¢«æ‰§è¡Œï¼Œå·²ç»æ‰§è¡Œçš„äº‹ä»¶handlerä¸ä¼šå–æ¶ˆã€‚ </li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSRunningApplication</span> *mail = [<span class="built_in">NSRunningApplication</span> runningApplicationsWithBundleIdentifier:<span class="string">@"com.apple.mail"</span>];</span><br><span class="line"><span class="keyword">if</span> (mail == <span class="literal">nil</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pid_t <span class="keyword">const</span> pid = mail.processIdentifier;</span><br><span class="line"><span class="keyword">self</span>.source = dispatch_source_create(DISPATCH_SOURCE_TYPE_PROC, pid, </span><br><span class="line">                                     DISPATCH_PROC_EXIT, </span><br><span class="line">                                     DISPATCH_TARGET_QUEUE_DEFAULT);</span><br><span class="line">dispatch_source_set_event_handler(<span class="keyword">self</span>.source, ^()&#123;</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"Mail quit."</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//åœ¨äº‹ä»¶æºä¼ åˆ°ä½ çš„äº‹ä»¶å¤„ç†å‰éœ€è¦è°ƒç”¨dispatch_resume()è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line">dispatch_resume(<span class="keyword">self</span>.source);</span><br></pre></td></tr></table></figure>



<p>ç›‘è§†æ–‡ä»¶å¤¹å†…æ–‡ä»¶å˜åŒ– </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="built_in">NSURL</span> *directoryURL; <span class="comment">// assume this is set to a directory</span></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> fd = open([[directoryURL path] fileSystemRepresentation], O_EVTONLY);</span><br><span class="line"><span class="keyword">if</span> (fd &lt; <span class="number">0</span>) &#123;</span><br><span class="line">  <span class="keyword">char</span> buffer[<span class="number">80</span>];</span><br><span class="line">	strerror_r(errno, buffer, <span class="keyword">sizeof</span>(buffer));</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"Unable to open "</span>%<span class="string">@": %s (%d)"</span>, [directoryURL path], buffer, errno);</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dispatch_source_t source = dispatch_source_create(DISPATCH_SOURCE_TYPE_VNODE, </span><br><span class="line">                                                  fd,</span><br><span class="line">                                                  DISPATCH_VNODE_WRITE | </span><br><span class="line">                                                  DISPATCH_VNODE_DELETE, </span><br><span class="line">                                                  DISPATCH_TARGET_QUEUE_DEFAULT);</span><br><span class="line"></span><br><span class="line">dispatch_source_set_event_handler(source, ^()&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">const</span> data = dispatch_source_get_data(source);</span><br><span class="line">	<span class="keyword">if</span> (data &amp; DISPATCH_VNODE_WRITE) &#123;</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"The directory changed."</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (data &amp; DISPATCH_VNODE_DELETE) &#123;</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"The directory has been deleted."</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line">dispatch_source_set_cancel_handler(source, ^()&#123;</span><br><span class="line">	close(fd);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.source = source;</span><br><span class="line">dispatch_resume(<span class="keyword">self</span>.source);</span><br></pre></td></tr></table></figure>

<p><strong>è¿˜è¦æ³¨æ„éœ€è¦ç”¨DISPATCH_VNODE_DELETE å»æ£€æŸ¥ç›‘è§†çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯å¦è¢«åˆ é™¤ï¼Œå¦‚æœåˆ é™¤äº†å°±åœæ­¢ç›‘å¬</strong></p>
<p>NSTimeråœ¨ä¸»çº¿ç¨‹çš„runloopé‡Œä¼šåœ¨runloopåˆ‡æ¢å…¶å®ƒæ¨¡å¼æ—¶åœæ­¢ï¼Œè¿™æ—¶å°±éœ€è¦æ‰‹åŠ¨åœ¨å­çº¿ç¨‹å¼€å¯ä¸€ä¸ªæ¨¡å¼ä¸º NSRunLoopCommonModesçš„runloopï¼Œ å¦‚æœä¸æƒ³å¼€å¯ä¸€ä¸ªæ–°çš„runloopå¯ä»¥ç”¨ä¸è·Ÿrunloopå…³è”çš„dispatch source timerï¼Œå¦‚ä¸‹ã€‚ </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">dispatch_source_t source = dispatch_source_create(DISPATCH_SOURCE_TYPE_TIMER,</span><br><span class="line">                                                  <span class="number">0</span>, </span><br><span class="line">                                                  <span class="number">0</span>, </span><br><span class="line">                                                  DISPATCH_TARGET_QUEUE_DEFAULT);</span><br><span class="line"></span><br><span class="line">dispatch_source_set_event_handler(source, ^()&#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"Time flies."</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">dispatch_time_t start</span><br><span class="line">dispatch_source_set_timer(source, </span><br><span class="line">                          DISPATCH_TIME_NOW, </span><br><span class="line">                          <span class="number">5</span>ull * <span class="built_in">NSEC_PER_SEC</span>,</span><br><span class="line">                          <span class="number">100</span>ull * <span class="built_in">NSEC_PER_MSEC</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.source = source;</span><br><span class="line">dispatch_resume(<span class="keyword">self</span>.source);</span><br></pre></td></tr></table></figure>



<h4 id="åã€Dispatch-Semaphoreå’Œçš„ä»‹ç»"><a href="#åã€Dispatch-Semaphoreå’Œçš„ä»‹ç»" class="headerlink" title="åã€Dispatch Semaphoreå’Œçš„ä»‹ç»"></a>åã€Dispatch Semaphoreå’Œçš„ä»‹ç»</h4><p>å¦å¤–ä¸€ç§ä¿è¯åŒæ­¥çš„æ–¹æ³•ã€‚ä½¿ç”¨ dispatch_semaphore_signal åŠ 1 dispatch_semaphore_wait å‡1ï¼Œä¸º0æ—¶ç­‰å¾…çš„è®¾ç½®æ–¹å¼æ¥è¾¾åˆ°çº¿ç¨‹åŒæ­¥çš„ç›®çš„å’Œ åŒæ­¥é”ä¸€æ ·èƒ½å¤Ÿè§£å†³èµ„æºæŠ¢å çš„é—®é¢˜ã€‚ </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="comment">//dispatch semaphore</span></span><br><span class="line">- (<span class="keyword">void</span>)dispatchSemaphoreDemo &#123;</span><br><span class="line">  <span class="comment">//åˆ›å»ºsemaphore</span></span><br><span class="line">	dispatch_semaphore_t semaphore = dispatch_semaphore_create(<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"start"</span>);</span><br><span class="line">	[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1.</span>f];</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"semaphore +1"</span>);</span><br><span class="line">	dispatch_semaphore_signal(semaphore); <span class="comment">//+1 semaphore</span></span><br><span class="line">    </span><br><span class="line">	&#125;);</span><br><span class="line">	dispatch_semaphore_wait(semaphore, DISPATCH_TIME_FOREVER);</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"continue"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="åä¸€ã€é”"><a href="#åä¸€ã€é”" class="headerlink" title="åä¸€ã€é”"></a>åä¸€ã€é”</h4><p>è¿™é‡Œç®€å•ä»‹ç»ä¸‹iOSä¸­å¸¸ç”¨çš„å„ç§é”å’Œä»–ä»¬çš„æ€§èƒ½ã€‚ </p>
<ul>
<li>NSRecursiveLockï¼šé€’å½’é”ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­åå¤è·å–é”ä¸ä¼šé€ æˆæ­»é”ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šè®°å½•è·å–é”å’Œé‡Šæ”¾é”çš„æ¬¡æ•°æ¥è¾¾åˆ°ä½•æ—¶é‡Šæ”¾çš„ä½œç”¨ã€‚ </li>
<li>NSDistributedLockï¼šåˆ†å¸ƒé”ï¼ŒåŸºäºæ–‡ä»¶æ–¹å¼çš„é”æœºåˆ¶ï¼Œå¯ä»¥è·¨è¿›ç¨‹è®¿é—®ã€‚ </li>
<li>NSConditionLockï¼šæ¡ä»¶é”ï¼Œç”¨æˆ·å®šä¹‰æ¡ä»¶ï¼Œç¡®ä¿ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–æ»¡è¶³ä¸€å®šæ¡ä»¶çš„é”ã€‚ å› ä¸ºçº¿ç¨‹é—´ç«äº‰ä¼šæ¶‰åŠåˆ°æ¡ä»¶é”æ£€æµ‹ï¼Œç³»ç»Ÿè°ƒç”¨ä¸Šä¸‹åˆ‡æ¢é¢‘ç¹å¯¼è‡´è€—æ—¶æ˜¯å‡ ä¸ªé”é‡Œæœ€é•¿çš„ã€‚ </li>
<li>OSSpinLockï¼šè‡ªæ—‹é”ï¼Œä¸è¿›å…¥å†…æ ¸ï¼Œå‡å°‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ€§èƒ½æœ€é«˜ï¼Œä½†æŠ¢å å¤šæ—¶ä¼šå ç”¨è¾ƒå¤šcpuï¼Œå¥½ç‚¹å¤šï¼Œè¿™æ—¶ä½¿ç”¨pthread_mutexè¾ƒå¥½ã€‚ </li>
<li>pthread_mutex_tï¼šåŒæ­¥é”åŸºäºCè¯­è¨€ï¼Œåº•å±‚apiæ€§èƒ½é«˜ï¼Œä½¿ç”¨æ–¹æ³•å’Œå…¶å®ƒçš„ç±»ä¼¼ã€‚ </li>
<li>@synchronizedï¼šæ›´åŠ ç®€å•ã€‚ </li>
</ul>
<h4 id="åäºŒã€dispatch-suspendå’Œdispatch-resumeæŒ‚èµ·å’Œæ¢å¤é˜Ÿåˆ—"><a href="#åäºŒã€dispatch-suspendå’Œdispatch-resumeæŒ‚èµ·å’Œæ¢å¤é˜Ÿåˆ—" class="headerlink" title="åäºŒã€dispatch_suspendå’Œdispatch_resumeæŒ‚èµ·å’Œæ¢å¤é˜Ÿåˆ—"></a>åäºŒã€dispatch_suspendå’Œdispatch_resumeæŒ‚èµ·å’Œæ¢å¤é˜Ÿåˆ—</h4><p>dispatch_suspendè¿™é‡ŒæŒ‚èµ·ä¸ä¼šæš‚åœæ­£åœ¨æ‰§è¡Œçš„blockï¼Œåªæ˜¯èƒ½å¤Ÿæš‚åœè¿˜æ²¡æ‰§è¡Œçš„blockã€‚ </p>
<h4 id="åä¸‰ã€dispatch-set-contextå’Œdispatch-get-context"><a href="#åä¸‰ã€dispatch-set-contextå’Œdispatch-get-context" class="headerlink" title="åä¸‰ã€dispatch_set_contextå’Œdispatch_get_context"></a>åä¸‰ã€dispatch_set_contextå’Œdispatch_get_context</h4><p>?</p>
<h2 id="GCDæ·±å…¥æ“ä½œ"><a href="#GCDæ·±å…¥æ“ä½œ" class="headerlink" title="GCDæ·±å…¥æ“ä½œ"></a>GCDæ·±å…¥æ“ä½œ</h2><ul>
<li>ç¼“å†²åŒºï¼šdispatch_data_t åŸºäºé›¶ç¢çš„å†…å­˜åŒºåŸŸï¼Œä½¿ç”¨ dispatch_data_apply æ¥éå†ï¼Œè¿˜å¯ä»¥ç”¨ dispatch_data_create_subrange æ¥åˆ›å»ºä¸€ä¸ªä¸åšä»»ä½•æ‹·è´çš„å­åŒºåŸŸ </li>
<li>I/Oè°ƒåº¦ï¼šä½¿ç”¨GCDæä¾›çš„dispatch_io_readï¼Œdispatch_io_writeå’Œdispatch_io_close </li>
<li>æµ‹è¯•ï¼šä½¿ç”¨ dispatch_benchmark å°å·¥å…· </li>
<li>åŸå­æ“ä½œï¼š libkern/OSAtomic.h é‡Œå¯ä»¥æŸ¥çœ‹é‚£äº›å‡½æ•°ï¼Œç”¨äºåº•å±‚å¤šçº¿ç¨‹ç¼–ç¨‹ã€‚ </li>
</ul>
<h3 id="GCDæ­»é”"><a href="#GCDæ­»é”" class="headerlink" title="GCDæ­»é”"></a>GCDæ­»é”</h3><p>ä¸²è¡Œé˜Ÿåˆ—é‡Œé¢åŒæ­¥ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—å°±ä¼šæ­»é”ï¼Œè§£å†³çš„æ–¹æ³•å°±æ˜¯å°†åŒæ­¥çš„ä¸²è¡Œé˜Ÿåˆ—æ”¾åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±èƒ½å¤Ÿè§£å†³ã€‚ </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)deadLockCase1 &#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">	<span class="comment">//ä¸»é˜Ÿåˆ—çš„åŒæ­¥çº¿ç¨‹ï¼ŒæŒ‰ç…§FIFOçš„åŸåˆ™ï¼ˆå…ˆå…¥å…ˆå‡ºï¼‰ï¼Œ2æ’åœ¨3åé¢ä¼šç­‰3æ‰§è¡Œå®Œï¼Œä½†å› ä¸ºåŒæ­¥çº¿ç¨‹ï¼Œ3åˆè¦ç­‰2æ‰§è¡Œå®Œï¼Œç›¸äº’ç­‰å¾…æˆä¸ºæ­»é”ã€‚</span></span><br><span class="line">	<span class="built_in">dispatch_sync</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"3"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)deadLockCase2 &#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">	<span class="comment">//3ä¼šç­‰2ï¼Œå› ä¸º2åœ¨å…¨å±€å¹¶è¡Œé˜Ÿåˆ—é‡Œï¼Œä¸éœ€è¦ç­‰å¾…3ï¼Œè¿™æ ·2æ‰§è¡Œå®Œå›åˆ°ä¸»é˜Ÿåˆ—ï¼Œ3å°±å¼€å§‹æ‰§è¡Œ</span></span><br><span class="line">	<span class="built_in">dispatch_sync</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_HIGH, <span class="number">0</span>), ^&#123;</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"3"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)deadLockCase3 &#123;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">dispatch_queue_t</span> serialQueue = dispatch_queue_create(<span class="string">"com.starming.gcddemo.serialqueue"</span>, DISPATCH_QUEUE_SERIAL);</span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">	<span class="built_in">dispatch_async</span>(serialQueue, ^&#123;</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">			<span class="comment">//ä¸²è¡Œé˜Ÿåˆ—é‡Œé¢åŒæ­¥ä¸€ä¸ªä¸²è¡Œé˜Ÿåˆ—å°±ä¼šæ­»é”</span></span><br><span class="line">		<span class="built_in">dispatch_sync</span>(serialQueue, ^&#123;</span><br><span class="line">			<span class="built_in">NSLog</span>(<span class="string">@"3"</span>);</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"4"</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"5"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)deadLockCase4 &#123;</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">	<span class="built_in">dispatch_async</span>(dispatch_get_global_queue(<span class="number">0</span>, <span class="number">0</span>), ^&#123;</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">		<span class="comment">//å°†åŒæ­¥çš„ä¸²è¡Œé˜Ÿåˆ—æ”¾åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹å°±èƒ½å¤Ÿè§£å†³</span></span><br><span class="line">		<span class="built_in">dispatch_sync</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">			<span class="built_in">NSLog</span>(<span class="string">@"3"</span>);</span><br><span class="line">		&#125;);</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"4"</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"5"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)deadLockCase5 &#123;</span><br><span class="line">	<span class="built_in">dispatch_async</span>(dispatch_get_global_queue(<span class="number">0</span>, <span class="number">0</span>), ^&#123;</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"1"</span>);</span><br><span class="line">		<span class="comment">//å›åˆ°ä¸»çº¿ç¨‹å‘ç°æ­»å¾ªç¯åé¢å°±æ²¡æ³•æ‰§è¡Œäº†</span></span><br><span class="line">		<span class="built_in">dispatch_sync</span>(dispatch_get_main_queue(), ^&#123;</span><br><span class="line">			<span class="built_in">NSLog</span>(<span class="string">@"2"</span>);</span><br><span class="line">		&#125;);</span><br><span class="line">		<span class="built_in">NSLog</span>(<span class="string">@"3"</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="built_in">NSLog</span>(<span class="string">@"4"</span>);</span><br><span class="line">	<span class="comment">//æ­»å¾ªç¯</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="comment">//</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="GCDå®é™…ä½¿ç”¨"><a href="#GCDå®é™…ä½¿ç”¨" class="headerlink" title="GCDå®é™…ä½¿ç”¨"></a>GCDå®é™…ä½¿ç”¨</h3><p>FMDBå¦‚ä½•ä½¿ç”¨ <strong>dispatch_queue_set_specific</strong> å’Œ <strong>dispatch_get_specific</strong> æ¥é˜²æ­¢æ­»é”ï¼Œä½œç”¨ç±»ä¼¼objc_setAssociatedObjectè·Ÿobjc_getAssociatedObject </p>
<figure class="highlight objc"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">void</span> * <span class="keyword">const</span> kDispatchQueueSpecificKey = &amp;kDispatchQueueSpecificKey;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ›å»ºä¸²è¡Œé˜Ÿåˆ—ï¼Œæ‰€æœ‰æ•°æ®åº“çš„æ“ä½œéƒ½åœ¨è¿™ä¸ªé˜Ÿåˆ—é‡Œ</span></span><br><span class="line">_queue = dispatch_queue_create([[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"fmdb.%@"</span>, <span class="keyword">self</span>] UTF8String],</span><br><span class="line">                               <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ ‡è®°é˜Ÿåˆ—</span></span><br><span class="line">dispatch_queue_set_specific(_queue, kDispatchQueueSpecificKey, (__bridge <span class="keyword">void</span> *)<span class="keyword">self</span>, <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ£€æŸ¥æ˜¯å¦æ˜¯åŒä¸€ä¸ªé˜Ÿåˆ—æ¥é¿å…æ­»é”çš„æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">void</span>)inDatabase:(<span class="keyword">void</span> (^)(FMDatabase *db))block &#123;</span><br><span class="line">	 FMDatabaseQueue *currentSyncQueue = (__bridge <span class="keyword">id</span>)dispatch_get_specific(kDispatchQueueSpecificKey);</span><br><span class="line">	assert(currentSyncQueue != <span class="keyword">self</span> &amp;&amp; <span class="string">"inDatabase: was called reentrantly on the same queue,which would lead to a deadlock"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="iOSç³»ç»Ÿç‰ˆæœ¬æ–°ç‰¹æ€§"><a href="#iOSç³»ç»Ÿç‰ˆæœ¬æ–°ç‰¹æ€§" class="headerlink" title="iOSç³»ç»Ÿç‰ˆæœ¬æ–°ç‰¹æ€§"></a>iOSç³»ç»Ÿç‰ˆæœ¬æ–°ç‰¹æ€§</h2><h3 id="iOS8"><a href="#iOS8" class="headerlink" title="iOS8"></a>iOS8</h3><p>iOS8 æ–°åŠ äº†ä¸€ä¸ªåŠŸèƒ½å« Quality of Service(QoS)ï¼Œé‡Œé¢æä¾›äº†ä¸€ä¸‹å‡ ä¸ªæ›´å®¹æ˜“ç†è§£çš„æšä¸¾åæ¥ä½¿ç”¨user interactiveï¼Œuser initiatedï¼Œutilityå’Œbackgroundã€‚ä¸‹é¢çš„è¡¨åšäº†å¯¹æ¯” </p>
<table>
<thead>
<tr>
<th align="center">Global queue</th>
<th align="center">Corresponding QoS class</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Main thread</td>
<td align="center">NSQualityOfServiceUserInteractive</td>
<td align="center">UIç›¸å…³ï¼Œäº¤äº’ç­‰</td>
</tr>
<tr>
<td align="center">DISPATCH_QUEUE_PRIORITY_HIGH</td>
<td align="center">NSQualityOfServiceUserInitiated</td>
<td align="center">ç”¨æˆ·å‘èµ·éœ€è¦é©¬ä¸Šå¾—åˆ°ç»“æœè¿›è¡Œåç»­ä»»åŠ¡</td>
</tr>
<tr>
<td align="center">DISPATCH_QUEUE_PRIORITY_DEFAULT</td>
<td align="center">NSQualityOfServiceDefault</td>
<td align="center">é»˜è®¤çš„ä¸åº”è¯¥ä½¿ç”¨è¿™ä¸ªè®¾ç½®ä»»åŠ¡</td>
</tr>
<tr>
<td align="center">DISPATCH_QUEUE_PRIORITY_LOW</td>
<td align="center">NSQualityOfServiceUtility</td>
<td align="center">èŠ±è´¹æ—¶é—´ç¨å¤šæ¯”å¦‚ä¸‹è½½ï¼Œéœ€è¦å‡ ç§’æˆ–å‡ åˆ†é’Ÿçš„</td>
</tr>
<tr>
<td align="center">DISPATCH_QUEUE_PRIORITY_BACKGROUND</td>
<td align="center">NSQualityOfServiceBackground</td>
<td align="center">ä¸å¯è§åœ¨åå°çš„æ“ä½œå¯èƒ½éœ€è¦å¥½å‡ åˆ†é’Ÿç”šè‡³å‡ å°æ—¶çš„</td>
</tr>
</tbody></table>
]]></content>
      <tags>
        <tag>iOS</tag>
      </tags>
  </entry>
</search>
